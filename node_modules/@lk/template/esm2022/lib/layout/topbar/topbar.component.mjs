import { Component, EventEmitter, Output } from '@angular/core';
import { CommonModule } from '@angular/common';
import { MatMenuModule } from '@angular/material/menu';
import { MatButtonModule } from '@angular/material/button';
import { AppInputComponent, IconComponent } from '@lk/core';
import * as i0 from "@angular/core";
import * as i1 from "../notification/notification.service";
import * as i2 from "@angular/router";
import * as i3 from "@lk/core";
import * as i4 from "@angular/common";
import * as i5 from "@angular/material/menu";
import * as i6 from "@angular/material/button";
export class TopbarComponent {
    constructor(notificationService, router, authService, eventService) {
        this.notificationService = notificationService;
        this.router = router;
        this.authService = authService;
        this.eventService = eventService;
        this.searchText = '';
        this.openPatientQueue = new EventEmitter();
        this.breadcrum = [];
    }
    onNotificationClick(event) {
        const targetElement = event.currentTarget;
        const notifications = this.notificationService.getSampleNotifications();
        this.notificationService.openNotificationPanel(notifications, targetElement);
    }
    ngOnInit() {
        // Use signal-based breadcrumb from CoreEventService
        // Use the service's onBreadcrumbChange method which handles injection context properly
        this.breadcrumbUnsubscribe = this.eventService.onBreadcrumbChange((breadcrumb) => {
            if (breadcrumb && Array.isArray(breadcrumb) && breadcrumb.length > 0) {
                // Convert BreadcrumbItem[] to the format expected by the template
                this.breadcrum = breadcrumb.map((item) => ({
                    title: item.label,
                    url: item.route,
                    icon: item.icon
                }));
            }
            else {
                // Clear breadcrumb if null or empty
                this.breadcrum = [];
            }
        });
    }
    ngOnDestroy() {
        // Clean up the breadcrumb subscription
        if (this.breadcrumbUnsubscribe) {
            this.breadcrumbUnsubscribe();
        }
    }
    showPatientQueue(event) {
        this.openPatientQueue.emit(event);
    }
    onProfileClick(event) {
        // This method is now handled by the mat-menu trigger
        console.log('Profile menu opened');
    }
    onProfileMenuClick() {
        this.router.navigate(['/profile']);
    }
    onSettingsMenuClick() {
        this.router.navigate(['/settings']);
    }
    onLogoutClick() {
        this.authService.logout();
    }
    onBreadcrumbClick(item) {
        if (item.url) {
            this.router.navigate([item.url]);
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: TopbarComponent, deps: [{ token: i1.NotificationService }, { token: i2.Router }, { token: i3.AuthService }, { token: i3.CoreEventService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.12", type: TopbarComponent, isStandalone: true, selector: "app-topbar", outputs: { openPatientQueue: "openPatientQueue" }, ngImport: i0, template: "<header class=\"topbar\">\n  <div class=\"topbar-left\">\n    @if(breadcrum.length > 0){\n      <div class=\"breadcrums\">\n        <span *ngFor=\"let item of breadcrum; let i = index\" (click)=\"onBreadcrumbClick(item)\" class=\"breadcrumb-item\">\n          <span [class.clickable]=\"item.url\">{{ item.title }}</span>\n          @if(i < breadcrum.length - 1){\n            <span class=\"separator\">\n              <app-icon [fontIcon]=\"'chevron_right'\"></app-icon>\n            </span>\n          }\n        </span>\n      </div>\n    }\n    @else{\n      <div class=\"greeting\">\n        Good Morning, <b>Dr.Umesh!</b>\n      </div>\n    }\n  </div>\n  <div class=\"topbar-center\">\n    <div class=\"search-box\">\n      <app-input\n        [search]=\"true\"\n        type=\"text\"\n        placeholder=\"Search type of Keywords\"\n        prefixIconName=\"search\"\n        [(value)]=\"searchText\"\n      ></app-input>\n    </div>\n    <app-icon \n      fontIcon=\"notifications\" \n      [isCovered]=\"true\"\n      (iconClick)=\"onNotificationClick($event)\"\n    ></app-icon>\n\n    <app-icon  \n    [isCovered]=\"true\"\n    [counter]=\"1\"\n    [isBlink]=\"true\"\n    [color]=\"'#10b3b3'\"\n    [fontBold]=\"true\"\n    (iconClick)=\"showPatientQueue($event)\"\n  ></app-icon>\n  </div>\n  <div class=\"topbar-right\">\n    <button \n      type=\"button\"\n      appearance=\"flat\"\n      mat-icon-button \n      [matMenuTriggerFor]=\"profileMenu\" \n      class=\"profile-menu-trigger\"\n      (click)=\"onProfileClick($event)\">\n      <div class=\"profile\">\n        <img class=\"avatar\" src=\"https://randomuser.me/api/portraits/men/32.jpg\" alt=\"\" />\n        <div class=\"profile-info\">\n          <div class=\"profile-name\">Dr.Umesh</div>\n          <div class=\"profile-role\">Cardiologist</div>\n        </div>\n        <app-icon [fontIcon]=\"'arrow_drop_down'\"></app-icon>\n      </div>\n    </button>\n\n    <mat-menu #profileMenu=\"matMenu\" class=\"profile-menu\">\n      <button mat-menu-item (click)=\"onProfileMenuClick()\">\n        <app-icon [fontIcon]=\"'person'\" class=\"menu-icon\"></app-icon>\n        <span>Profile</span>\n      </button>\n      <button mat-menu-item (click)=\"onSettingsMenuClick()\">\n        <app-icon [fontIcon]=\"'settings'\" class=\"menu-icon\"></app-icon>\n        <span>Settings</span>\n      </button>\n      <button mat-menu-item (click)=\"onLogoutClick()\">\n        <app-icon [fontIcon]=\"'logout'\" class=\"menu-icon\"></app-icon>\n        <span>Logout</span>\n      </button>\n    </mat-menu>\n  </div>\n</header>\n", styles: [".topbar{display:flex;align-items:center;justify-content:space-between;padding:0 .2em 0 1em;height:72px;background:#fff;border-bottom:1px solid #f0f0f0;box-sizing:border-box;position:relative;z-index:10;height:4em}.topbar-left{flex:1 1 0;min-width:180px}.breadcrums{display:flex;flex-direction:row;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.breadcrums .breadcrumb-item{display:flex;align-items:center;gap:4px;cursor:default}.breadcrums .breadcrumb-item .breadcrumb-icon{font-size:16px;width:16px;height:16px;color:#666}.breadcrums .breadcrumb-item .clickable{cursor:pointer;color:#1976d2;transition:color .2s}.breadcrums .breadcrumb-item .clickable:hover{color:#1565c0;text-decoration:underline}.breadcrums .breadcrumb-item .separator{margin:0 8px;color:#9e9e9e;cursor:default}.topbar-center{flex:2 1 0;display:flex;align-items:center;justify-content:center;gap:16px}.search-box{display:flex;align-items:center;width:45%}.search-box ::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}.search-box app-input{width:100%}.search-icon{color:#1976d2;font-size:1.1rem;margin-right:8px}.search-box input{border:none;background:transparent;outline:none;font-size:1rem;width:100%;color:#222}.notification-btn{background:#f8fafc;border:1px solid #e0e0e0;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;margin-left:12px;cursor:pointer;transition:background .2s}.notification-btn:hover{background:#e6f0fa}.notification-icon{font-size:1.2rem;color:#1976d2}.topbar-right{flex:1 1 0;display:flex;align-items:center;justify-content:flex-end;max-width:11em;min-width:10em}::ng-deep .topbar-right .mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple:before{opacity:0!important}.profile-menu-trigger{width:100%;background:none;border:none;padding:0;cursor:pointer;border-radius:24px;transition:box-shadow .2s}.profile-menu-trigger:hover{box-shadow:0 2px 8px #0000001a}.profile-menu-trigger .profile{display:flex;align-items:center;gap:12px;border-radius:24px;padding:4px 16px 4px 4px;transition:box-shadow .2s;box-shadow:0 1px 2px #00000005}.profile-menu-trigger .avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid #fff;box-shadow:0 1px 2px #0000000a}.profile-menu-trigger .profile-info{display:flex;flex-direction:column;align-items:flex-start;line-height:1.1}.profile-menu-trigger .profile-name{font-size:1rem;font-weight:600;color:#222}.profile-menu-trigger .profile-role{font-size:.85rem;color:#888}.profile-menu .mat-mdc-menu-content{padding:8px 0}.profile-menu .mat-mdc-menu-item{display:flex;align-items:center;gap:12px;padding:12px 16px;min-height:48px}.profile-menu .mat-mdc-menu-item .menu-icon{font-size:20px;color:var(--text-secondary)}.profile-menu .mat-mdc-menu-item span{font-size:14px;font-weight:500;color:var(--text-primary)}.profile-menu .mat-mdc-menu-item:hover{background-color:var(--surface-hover)}.profile-menu .mat-mdc-menu-item:hover .menu-icon{color:var(--primary-color)}@media (max-width: 900px){.topbar{padding:0 12px;height:56px}.search-box{min-width:120px;padding:0 8px}.profile-menu-trigger .profile{padding:2px 8px 2px 2px}}@media (max-width: 600px){.topbar{flex-direction:column;height:auto;gap:8px;padding:8px 4px}.topbar-center{width:100%;justify-content:flex-start}.search-box{min-width:0;width:100%}.profile-menu-trigger .profile-info{display:none}}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "ngmodule", type: MatMenuModule }, { kind: "component", type: i5.MatMenu, selector: "mat-menu", inputs: ["backdropClass", "aria-label", "aria-labelledby", "aria-describedby", "xPosition", "yPosition", "overlapTrigger", "hasBackdrop", "class", "classList"], outputs: ["closed", "close"], exportAs: ["matMenu"] }, { kind: "component", type: i5.MatMenuItem, selector: "[mat-menu-item]", inputs: ["role", "disabled", "disableRipple"], exportAs: ["matMenuItem"] }, { kind: "directive", type: i5.MatMenuTrigger, selector: "[mat-menu-trigger-for], [matMenuTriggerFor]", inputs: ["mat-menu-trigger-for", "matMenuTriggerFor", "matMenuTriggerData", "matMenuTriggerRestoreFocus"], outputs: ["menuOpened", "onMenuOpen", "menuClosed", "onMenuClose"], exportAs: ["matMenuTrigger"] }, { kind: "ngmodule", type: MatButtonModule }, { kind: "component", type: i6.MatIconButton, selector: "button[mat-icon-button]", exportAs: ["matButton"] }, { kind: "component", type: AppInputComponent, selector: "app-input", inputs: ["type", "placeholder", "value", "disabled", "required", "appearance", "label", "errorMessage", "multiline", "rows", "prefixIconName", "prefixIconSize", "suffixIconName", "suffixIconSize", "search", "searchUrl"], outputs: ["valueChange", "searchResults"] }, { kind: "component", type: IconComponent, selector: "app-icon", inputs: ["fontSet", "fontIcon", "iconType", "icomoonClass", "size", "isBlink", "fontBold", "color", "class", "counter", "isCovered"], outputs: ["iconClick"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: TopbarComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-topbar', standalone: true, imports: [
                        CommonModule,
                        MatMenuModule,
                        MatButtonModule,
                        AppInputComponent,
                        IconComponent
                    ], template: "<header class=\"topbar\">\n  <div class=\"topbar-left\">\n    @if(breadcrum.length > 0){\n      <div class=\"breadcrums\">\n        <span *ngFor=\"let item of breadcrum; let i = index\" (click)=\"onBreadcrumbClick(item)\" class=\"breadcrumb-item\">\n          <span [class.clickable]=\"item.url\">{{ item.title }}</span>\n          @if(i < breadcrum.length - 1){\n            <span class=\"separator\">\n              <app-icon [fontIcon]=\"'chevron_right'\"></app-icon>\n            </span>\n          }\n        </span>\n      </div>\n    }\n    @else{\n      <div class=\"greeting\">\n        Good Morning, <b>Dr.Umesh!</b>\n      </div>\n    }\n  </div>\n  <div class=\"topbar-center\">\n    <div class=\"search-box\">\n      <app-input\n        [search]=\"true\"\n        type=\"text\"\n        placeholder=\"Search type of Keywords\"\n        prefixIconName=\"search\"\n        [(value)]=\"searchText\"\n      ></app-input>\n    </div>\n    <app-icon \n      fontIcon=\"notifications\" \n      [isCovered]=\"true\"\n      (iconClick)=\"onNotificationClick($event)\"\n    ></app-icon>\n\n    <app-icon  \n    [isCovered]=\"true\"\n    [counter]=\"1\"\n    [isBlink]=\"true\"\n    [color]=\"'#10b3b3'\"\n    [fontBold]=\"true\"\n    (iconClick)=\"showPatientQueue($event)\"\n  ></app-icon>\n  </div>\n  <div class=\"topbar-right\">\n    <button \n      type=\"button\"\n      appearance=\"flat\"\n      mat-icon-button \n      [matMenuTriggerFor]=\"profileMenu\" \n      class=\"profile-menu-trigger\"\n      (click)=\"onProfileClick($event)\">\n      <div class=\"profile\">\n        <img class=\"avatar\" src=\"https://randomuser.me/api/portraits/men/32.jpg\" alt=\"\" />\n        <div class=\"profile-info\">\n          <div class=\"profile-name\">Dr.Umesh</div>\n          <div class=\"profile-role\">Cardiologist</div>\n        </div>\n        <app-icon [fontIcon]=\"'arrow_drop_down'\"></app-icon>\n      </div>\n    </button>\n\n    <mat-menu #profileMenu=\"matMenu\" class=\"profile-menu\">\n      <button mat-menu-item (click)=\"onProfileMenuClick()\">\n        <app-icon [fontIcon]=\"'person'\" class=\"menu-icon\"></app-icon>\n        <span>Profile</span>\n      </button>\n      <button mat-menu-item (click)=\"onSettingsMenuClick()\">\n        <app-icon [fontIcon]=\"'settings'\" class=\"menu-icon\"></app-icon>\n        <span>Settings</span>\n      </button>\n      <button mat-menu-item (click)=\"onLogoutClick()\">\n        <app-icon [fontIcon]=\"'logout'\" class=\"menu-icon\"></app-icon>\n        <span>Logout</span>\n      </button>\n    </mat-menu>\n  </div>\n</header>\n", styles: [".topbar{display:flex;align-items:center;justify-content:space-between;padding:0 .2em 0 1em;height:72px;background:#fff;border-bottom:1px solid #f0f0f0;box-sizing:border-box;position:relative;z-index:10;height:4em}.topbar-left{flex:1 1 0;min-width:180px}.breadcrums{display:flex;flex-direction:row;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.breadcrums .breadcrumb-item{display:flex;align-items:center;gap:4px;cursor:default}.breadcrums .breadcrumb-item .breadcrumb-icon{font-size:16px;width:16px;height:16px;color:#666}.breadcrums .breadcrumb-item .clickable{cursor:pointer;color:#1976d2;transition:color .2s}.breadcrums .breadcrumb-item .clickable:hover{color:#1565c0;text-decoration:underline}.breadcrums .breadcrumb-item .separator{margin:0 8px;color:#9e9e9e;cursor:default}.topbar-center{flex:2 1 0;display:flex;align-items:center;justify-content:center;gap:16px}.search-box{display:flex;align-items:center;width:45%}.search-box ::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}.search-box app-input{width:100%}.search-icon{color:#1976d2;font-size:1.1rem;margin-right:8px}.search-box input{border:none;background:transparent;outline:none;font-size:1rem;width:100%;color:#222}.notification-btn{background:#f8fafc;border:1px solid #e0e0e0;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;margin-left:12px;cursor:pointer;transition:background .2s}.notification-btn:hover{background:#e6f0fa}.notification-icon{font-size:1.2rem;color:#1976d2}.topbar-right{flex:1 1 0;display:flex;align-items:center;justify-content:flex-end;max-width:11em;min-width:10em}::ng-deep .topbar-right .mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple:before{opacity:0!important}.profile-menu-trigger{width:100%;background:none;border:none;padding:0;cursor:pointer;border-radius:24px;transition:box-shadow .2s}.profile-menu-trigger:hover{box-shadow:0 2px 8px #0000001a}.profile-menu-trigger .profile{display:flex;align-items:center;gap:12px;border-radius:24px;padding:4px 16px 4px 4px;transition:box-shadow .2s;box-shadow:0 1px 2px #00000005}.profile-menu-trigger .avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid #fff;box-shadow:0 1px 2px #0000000a}.profile-menu-trigger .profile-info{display:flex;flex-direction:column;align-items:flex-start;line-height:1.1}.profile-menu-trigger .profile-name{font-size:1rem;font-weight:600;color:#222}.profile-menu-trigger .profile-role{font-size:.85rem;color:#888}.profile-menu .mat-mdc-menu-content{padding:8px 0}.profile-menu .mat-mdc-menu-item{display:flex;align-items:center;gap:12px;padding:12px 16px;min-height:48px}.profile-menu .mat-mdc-menu-item .menu-icon{font-size:20px;color:var(--text-secondary)}.profile-menu .mat-mdc-menu-item span{font-size:14px;font-weight:500;color:var(--text-primary)}.profile-menu .mat-mdc-menu-item:hover{background-color:var(--surface-hover)}.profile-menu .mat-mdc-menu-item:hover .menu-icon{color:var(--primary-color)}@media (max-width: 900px){.topbar{padding:0 12px;height:56px}.search-box{min-width:120px;padding:0 8px}.profile-menu-trigger .profile{padding:2px 8px 2px 2px}}@media (max-width: 600px){.topbar{flex-direction:column;height:auto;gap:8px;padding:8px 4px}.topbar-center{width:100%;justify-content:flex-start}.search-box{min-width:0;width:100%}.profile-menu-trigger .profile-info{display:none}}\n"] }]
        }], ctorParameters: () => [{ type: i1.NotificationService }, { type: i2.Router }, { type: i3.AuthService }, { type: i3.CoreEventService }], propDecorators: { openPatientQueue: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9wYmFyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbW1vbi1saWJzL3RlbXBsYXRlL3NyYy9saWIvbGF5b3V0L3RvcGJhci90b3BiYXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY29tbW9uLWxpYnMvdGVtcGxhdGUvc3JjL2xpYi9sYXlvdXQvdG9wYmFyL3RvcGJhci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBcUIsTUFBTSxFQUFZLE1BQU0sZUFBZSxDQUFDO0FBQzdGLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUvQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzNELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxhQUFhLEVBQWlDLE1BQU0sVUFBVSxDQUFDOzs7Ozs7OztBQXVCM0YsTUFBTSxPQUFPLGVBQWU7SUFRMUIsWUFDVSxtQkFBd0MsRUFDeEMsTUFBYyxFQUNkLFdBQXdCLEVBQ3hCLFlBQThCO1FBSDlCLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ3hCLGlCQUFZLEdBQVosWUFBWSxDQUFrQjtRQVh4QyxlQUFVLEdBQVcsRUFBRSxDQUFDO1FBQ2QscUJBQWdCLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUVyRCxjQUFTLEdBQTBELEVBQUUsQ0FBQztJQVNuRSxDQUFDO0lBRUosbUJBQW1CLENBQUMsS0FBWTtRQUM5QixNQUFNLGFBQWEsR0FBRyxLQUFLLENBQUMsYUFBNEIsQ0FBQztRQUN6RCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUN4RSxJQUFJLENBQUMsbUJBQW1CLENBQUMscUJBQXFCLENBQUMsYUFBYSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQy9FLENBQUM7SUFFRCxRQUFRO1FBQ04sb0RBQW9EO1FBQ3BELHVGQUF1RjtRQUN2RixJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFO1lBQy9FLElBQUksVUFBVSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLElBQUksVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztnQkFDckUsa0VBQWtFO2dCQUNsRSxJQUFJLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7b0JBQ3pDLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztvQkFDakIsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLO29CQUNmLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtpQkFDaEIsQ0FBQyxDQUFDLENBQUM7WUFDTixDQUFDO2lCQUFNLENBQUM7Z0JBQ04sb0NBQW9DO2dCQUNwQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztZQUN0QixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsV0FBVztRQUNULHVDQUF1QztRQUN2QyxJQUFJLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBQy9CLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1FBQy9CLENBQUM7SUFDSCxDQUFDO0lBRUQsZ0JBQWdCLENBQUMsS0FBWTtRQUMzQixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxjQUFjLENBQUMsS0FBWTtRQUN6QixxREFBcUQ7UUFDckQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFRCxtQkFBbUI7UUFDakIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFRCxhQUFhO1FBQ1gsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBRUQsaUJBQWlCLENBQUMsSUFBb0Q7UUFDcEUsSUFBSSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDYixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ25DLENBQUM7SUFDSCxDQUFDOytHQXZFVSxlQUFlO21HQUFmLGVBQWUseUhDNUI1QixxaUZBK0VBLHUzR0Q1REksWUFBWSwySkFDWixhQUFhLDZ2QkFDYixlQUFlLDRJQUNmLGlCQUFpQiw4VEFDakIsYUFBYTs7NEZBS0osZUFBZTtrQkFiM0IsU0FBUzsrQkFDRSxZQUFZLGNBQ1YsSUFBSSxXQUNQO3dCQUNQLFlBQVk7d0JBQ1osYUFBYTt3QkFDYixlQUFlO3dCQUNmLGlCQUFpQjt3QkFDakIsYUFBYTtxQkFDZDtzS0FNUyxnQkFBZ0I7c0JBQXpCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgT25Jbml0LCBPbkRlc3Ryb3ksIE91dHB1dCwgY29tcHV0ZWQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgTWF0TWVudU1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL21lbnUnO1xuaW1wb3J0IHsgTWF0QnV0dG9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvYnV0dG9uJztcbmltcG9ydCB7IEFwcElucHV0Q29tcG9uZW50LCBJY29uQ29tcG9uZW50LCBDb3JlRXZlbnRTZXJ2aWNlLCBBdXRoU2VydmljZSB9IGZyb20gJ0Bsay9jb3JlJztcblxuLy8gRGVmaW5lIGxvY2FsIHR5cGUgZm9yIGJyZWFkY3J1bWIgaXRlbXMgKG1hdGNoZXMgQnJlYWRjcnVtYkl0ZW0gZnJvbSBAbGsvY29yZSlcbnR5cGUgQnJlYWRjcnVtYkl0ZW0gPSB7XG4gIGxhYmVsOiBzdHJpbmc7XG4gIHJvdXRlPzogc3RyaW5nO1xuICBpY29uPzogc3RyaW5nO1xufTtcbmltcG9ydCB7IE5vdGlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICcuLi9ub3RpZmljYXRpb24vbm90aWZpY2F0aW9uLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhcHAtdG9wYmFyJyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIENvbW1vbk1vZHVsZSxcbiAgICBNYXRNZW51TW9kdWxlLFxuICAgIE1hdEJ1dHRvbk1vZHVsZSxcbiAgICBBcHBJbnB1dENvbXBvbmVudCxcbiAgICBJY29uQ29tcG9uZW50XG4gIF0sXG4gIHRlbXBsYXRlVXJsOiAnLi90b3BiYXIuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybDogJy4vdG9wYmFyLmNvbXBvbmVudC5zY3NzJ1xufSlcbmV4cG9ydCBjbGFzcyBUb3BiYXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gIHNlYXJjaFRleHQ6IHN0cmluZyA9ICcnO1xuICBAT3V0cHV0KCkgb3BlblBhdGllbnRRdWV1ZSA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIGJyZWFkY3J1bTogQXJyYXk8eyB0aXRsZTogc3RyaW5nOyB1cmw/OiBzdHJpbmc7IGljb24/OiBzdHJpbmcgfT4gPSBbXTtcblxuICBwcml2YXRlIGJyZWFkY3J1bWJVbnN1YnNjcmliZT86ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBub3RpZmljYXRpb25TZXJ2aWNlOiBOb3RpZmljYXRpb25TZXJ2aWNlLFxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXG4gICAgcHJpdmF0ZSBhdXRoU2VydmljZTogQXV0aFNlcnZpY2UsXG4gICAgcHJpdmF0ZSBldmVudFNlcnZpY2U6IENvcmVFdmVudFNlcnZpY2VcbiAgKSB7fVxuXG4gIG9uTm90aWZpY2F0aW9uQ2xpY2soZXZlbnQ6IEV2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IHRoaXMubm90aWZpY2F0aW9uU2VydmljZS5nZXRTYW1wbGVOb3RpZmljYXRpb25zKCk7XG4gICAgdGhpcy5ub3RpZmljYXRpb25TZXJ2aWNlLm9wZW5Ob3RpZmljYXRpb25QYW5lbChub3RpZmljYXRpb25zLCB0YXJnZXRFbGVtZW50KTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIC8vIFVzZSBzaWduYWwtYmFzZWQgYnJlYWRjcnVtYiBmcm9tIENvcmVFdmVudFNlcnZpY2VcbiAgICAvLyBVc2UgdGhlIHNlcnZpY2UncyBvbkJyZWFkY3J1bWJDaGFuZ2UgbWV0aG9kIHdoaWNoIGhhbmRsZXMgaW5qZWN0aW9uIGNvbnRleHQgcHJvcGVybHlcbiAgICB0aGlzLmJyZWFkY3J1bWJVbnN1YnNjcmliZSA9IHRoaXMuZXZlbnRTZXJ2aWNlLm9uQnJlYWRjcnVtYkNoYW5nZSgoYnJlYWRjcnVtYikgPT4ge1xuICAgICAgaWYgKGJyZWFkY3J1bWIgJiYgQXJyYXkuaXNBcnJheShicmVhZGNydW1iKSAmJiBicmVhZGNydW1iLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQ29udmVydCBCcmVhZGNydW1iSXRlbVtdIHRvIHRoZSBmb3JtYXQgZXhwZWN0ZWQgYnkgdGhlIHRlbXBsYXRlXG4gICAgICAgIHRoaXMuYnJlYWRjcnVtID0gYnJlYWRjcnVtYi5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgICAgdGl0bGU6IGl0ZW0ubGFiZWwsXG4gICAgICAgICAgdXJsOiBpdGVtLnJvdXRlLFxuICAgICAgICAgIGljb246IGl0ZW0uaWNvblxuICAgICAgICB9KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDbGVhciBicmVhZGNydW1iIGlmIG51bGwgb3IgZW1wdHlcbiAgICAgICAgdGhpcy5icmVhZGNydW0gPSBbXTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIC8vIENsZWFuIHVwIHRoZSBicmVhZGNydW1iIHN1YnNjcmlwdGlvblxuICAgIGlmICh0aGlzLmJyZWFkY3J1bWJVbnN1YnNjcmliZSkge1xuICAgICAgdGhpcy5icmVhZGNydW1iVW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBzaG93UGF0aWVudFF1ZXVlKGV2ZW50OiBFdmVudCkge1xuICAgIHRoaXMub3BlblBhdGllbnRRdWV1ZS5lbWl0KGV2ZW50KTtcbiAgfVxuXG4gIG9uUHJvZmlsZUNsaWNrKGV2ZW50OiBFdmVudCkge1xuICAgIC8vIFRoaXMgbWV0aG9kIGlzIG5vdyBoYW5kbGVkIGJ5IHRoZSBtYXQtbWVudSB0cmlnZ2VyXG4gICAgY29uc29sZS5sb2coJ1Byb2ZpbGUgbWVudSBvcGVuZWQnKTtcbiAgfVxuXG4gIG9uUHJvZmlsZU1lbnVDbGljaygpIHtcbiAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy9wcm9maWxlJ10pO1xuICB9XG5cbiAgb25TZXR0aW5nc01lbnVDbGljaygpIHtcbiAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy9zZXR0aW5ncyddKTtcbiAgfVxuXG4gIG9uTG9nb3V0Q2xpY2soKSB7XG4gICAgdGhpcy5hdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgfVxuXG4gIG9uQnJlYWRjcnVtYkNsaWNrKGl0ZW06IHsgdGl0bGU6IHN0cmluZzsgdXJsPzogc3RyaW5nOyBpY29uPzogc3RyaW5nIH0pIHtcbiAgICBpZiAoaXRlbS51cmwpIHtcbiAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtpdGVtLnVybF0pO1xuICAgIH1cbiAgfVxufVxuIiwiPGhlYWRlciBjbGFzcz1cInRvcGJhclwiPlxuICA8ZGl2IGNsYXNzPVwidG9wYmFyLWxlZnRcIj5cbiAgICBAaWYoYnJlYWRjcnVtLmxlbmd0aCA+IDApe1xuICAgICAgPGRpdiBjbGFzcz1cImJyZWFkY3J1bXNcIj5cbiAgICAgICAgPHNwYW4gKm5nRm9yPVwibGV0IGl0ZW0gb2YgYnJlYWRjcnVtOyBsZXQgaSA9IGluZGV4XCIgKGNsaWNrKT1cIm9uQnJlYWRjcnVtYkNsaWNrKGl0ZW0pXCIgY2xhc3M9XCJicmVhZGNydW1iLWl0ZW1cIj5cbiAgICAgICAgICA8c3BhbiBbY2xhc3MuY2xpY2thYmxlXT1cIml0ZW0udXJsXCI+e3sgaXRlbS50aXRsZSB9fTwvc3Bhbj5cbiAgICAgICAgICBAaWYoaSA8IGJyZWFkY3J1bS5sZW5ndGggLSAxKXtcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwic2VwYXJhdG9yXCI+XG4gICAgICAgICAgICAgIDxhcHAtaWNvbiBbZm9udEljb25dPVwiJ2NoZXZyb25fcmlnaHQnXCI+PC9hcHAtaWNvbj5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgICBAZWxzZXtcbiAgICAgIDxkaXYgY2xhc3M9XCJncmVldGluZ1wiPlxuICAgICAgICBHb29kIE1vcm5pbmcsIDxiPkRyLlVtZXNoITwvYj5cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJ0b3BiYXItY2VudGVyXCI+XG4gICAgPGRpdiBjbGFzcz1cInNlYXJjaC1ib3hcIj5cbiAgICAgIDxhcHAtaW5wdXRcbiAgICAgICAgW3NlYXJjaF09XCJ0cnVlXCJcbiAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICBwbGFjZWhvbGRlcj1cIlNlYXJjaCB0eXBlIG9mIEtleXdvcmRzXCJcbiAgICAgICAgcHJlZml4SWNvbk5hbWU9XCJzZWFyY2hcIlxuICAgICAgICBbKHZhbHVlKV09XCJzZWFyY2hUZXh0XCJcbiAgICAgID48L2FwcC1pbnB1dD5cbiAgICA8L2Rpdj5cbiAgICA8YXBwLWljb24gXG4gICAgICBmb250SWNvbj1cIm5vdGlmaWNhdGlvbnNcIiBcbiAgICAgIFtpc0NvdmVyZWRdPVwidHJ1ZVwiXG4gICAgICAoaWNvbkNsaWNrKT1cIm9uTm90aWZpY2F0aW9uQ2xpY2soJGV2ZW50KVwiXG4gICAgPjwvYXBwLWljb24+XG5cbiAgICA8YXBwLWljb24gIFxuICAgIFtpc0NvdmVyZWRdPVwidHJ1ZVwiXG4gICAgW2NvdW50ZXJdPVwiMVwiXG4gICAgW2lzQmxpbmtdPVwidHJ1ZVwiXG4gICAgW2NvbG9yXT1cIicjMTBiM2IzJ1wiXG4gICAgW2ZvbnRCb2xkXT1cInRydWVcIlxuICAgIChpY29uQ2xpY2spPVwic2hvd1BhdGllbnRRdWV1ZSgkZXZlbnQpXCJcbiAgPjwvYXBwLWljb24+XG4gIDwvZGl2PlxuICA8ZGl2IGNsYXNzPVwidG9wYmFyLXJpZ2h0XCI+XG4gICAgPGJ1dHRvbiBcbiAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgYXBwZWFyYW5jZT1cImZsYXRcIlxuICAgICAgbWF0LWljb24tYnV0dG9uIFxuICAgICAgW21hdE1lbnVUcmlnZ2VyRm9yXT1cInByb2ZpbGVNZW51XCIgXG4gICAgICBjbGFzcz1cInByb2ZpbGUtbWVudS10cmlnZ2VyXCJcbiAgICAgIChjbGljayk9XCJvblByb2ZpbGVDbGljaygkZXZlbnQpXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwicHJvZmlsZVwiPlxuICAgICAgICA8aW1nIGNsYXNzPVwiYXZhdGFyXCIgc3JjPVwiaHR0cHM6Ly9yYW5kb211c2VyLm1lL2FwaS9wb3J0cmFpdHMvbWVuLzMyLmpwZ1wiIGFsdD1cIlwiIC8+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJwcm9maWxlLWluZm9cIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZmlsZS1uYW1lXCI+RHIuVW1lc2g8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZmlsZS1yb2xlXCI+Q2FyZGlvbG9naXN0PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8YXBwLWljb24gW2ZvbnRJY29uXT1cIidhcnJvd19kcm9wX2Rvd24nXCI+PC9hcHAtaWNvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvYnV0dG9uPlxuXG4gICAgPG1hdC1tZW51ICNwcm9maWxlTWVudT1cIm1hdE1lbnVcIiBjbGFzcz1cInByb2ZpbGUtbWVudVwiPlxuICAgICAgPGJ1dHRvbiBtYXQtbWVudS1pdGVtIChjbGljayk9XCJvblByb2ZpbGVNZW51Q2xpY2soKVwiPlxuICAgICAgICA8YXBwLWljb24gW2ZvbnRJY29uXT1cIidwZXJzb24nXCIgY2xhc3M9XCJtZW51LWljb25cIj48L2FwcC1pY29uPlxuICAgICAgICA8c3Bhbj5Qcm9maWxlPC9zcGFuPlxuICAgICAgPC9idXR0b24+XG4gICAgICA8YnV0dG9uIG1hdC1tZW51LWl0ZW0gKGNsaWNrKT1cIm9uU2V0dGluZ3NNZW51Q2xpY2soKVwiPlxuICAgICAgICA8YXBwLWljb24gW2ZvbnRJY29uXT1cIidzZXR0aW5ncydcIiBjbGFzcz1cIm1lbnUtaWNvblwiPjwvYXBwLWljb24+XG4gICAgICAgIDxzcGFuPlNldHRpbmdzPC9zcGFuPlxuICAgICAgPC9idXR0b24+XG4gICAgICA8YnV0dG9uIG1hdC1tZW51LWl0ZW0gKGNsaWNrKT1cIm9uTG9nb3V0Q2xpY2soKVwiPlxuICAgICAgICA8YXBwLWljb24gW2ZvbnRJY29uXT1cIidsb2dvdXQnXCIgY2xhc3M9XCJtZW51LWljb25cIj48L2FwcC1pY29uPlxuICAgICAgICA8c3Bhbj5Mb2dvdXQ8L3NwYW4+XG4gICAgICA8L2J1dHRvbj5cbiAgICA8L21hdC1tZW51PlxuICA8L2Rpdj5cbjwvaGVhZGVyPlxuIl19