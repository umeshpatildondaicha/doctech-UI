import { Pipe } from '@angular/core';
import * as i0 from "@angular/core";
export class TooltipPipe {
    transform(value, config) {
        if (!value) {
            return '';
        }
        // If config is a string, treat it as tooltip text
        if (typeof config === 'string') {
            return this.formatTooltip(value, { text: config });
        }
        // If config is an object, use it directly
        if (config && typeof config === 'object') {
            return this.formatTooltip(value, config);
        }
        // Default tooltip formatting
        return this.formatTooltip(value, {});
    }
    formatTooltip(value, config) {
        let tooltipText = config.text || this.generateDefaultTooltip(value);
        // Apply formatting based on value type
        if (typeof value === 'object') {
            tooltipText = this.formatObjectTooltip(value, tooltipText);
        }
        else if (typeof value === 'string') {
            tooltipText = this.formatStringTooltip(value, tooltipText);
        }
        else if (typeof value === 'number') {
            tooltipText = this.formatNumberTooltip(value, tooltipText);
        }
        else if (typeof value === 'boolean') {
            tooltipText = this.formatBooleanTooltip(value, tooltipText);
        }
        // Add HTML attributes for tooltip configuration
        const attributes = this.generateTooltipAttributes(config);
        return `${tooltipText}${attributes}`;
    }
    generateDefaultTooltip(value) {
        if (typeof value === 'string') {
            return value.length > 50 ? `${value.substring(0, 50)}...` : value;
        }
        if (typeof value === 'object') {
            return JSON.stringify(value);
        }
        return String(value);
    }
    formatObjectTooltip(obj, baseText) {
        if (obj.name) {
            return `${obj.name}${obj.description ? ` - ${obj.description}` : ''}`;
        }
        if (obj.title) {
            return `${obj.title}${obj.subtitle ? ` - ${obj.subtitle}` : ''}`;
        }
        if (obj.label) {
            return `${obj.label}${obj.value ? `: ${obj.value}` : ''}`;
        }
        return baseText;
    }
    formatStringTooltip(str, baseText) {
        // If string is too long, truncate it
        if (str.length > 100) {
            return `${str.substring(0, 100)}...`;
        }
        return str;
    }
    formatNumberTooltip(num, baseText) {
        // Format numbers with appropriate units or formatting
        if (num >= 1000000) {
            return `${(num / 1000000).toFixed(1)}M`;
        }
        if (num >= 1000) {
            return `${(num / 1000).toFixed(1)}K`;
        }
        return num.toString();
    }
    formatBooleanTooltip(bool, baseText) {
        return bool ? 'Yes' : 'No';
    }
    generateTooltipAttributes(config) {
        const attributes = [];
        if (config.position) {
            attributes.push(`data-position="${config.position}"`);
        }
        if (config.delay) {
            attributes.push(`data-delay="${config.delay}"`);
        }
        if (config.showArrow !== undefined) {
            attributes.push(`data-arrow="${config.showArrow}"`);
        }
        if (config.customClass) {
            attributes.push(`data-class="${config.customClass}"`);
        }
        if (config.maxWidth) {
            attributes.push(`data-max-width="${config.maxWidth}"`);
        }
        if (config.html) {
            attributes.push('data-html="true"');
        }
        return attributes.length > 0 ? ` ${attributes.join(' ')}` : '';
    }
    // Utility methods for common tooltip patterns
    static createStatusTooltip(status, additionalInfo) {
        const statusMap = {
            'active': 'Active - Currently in use',
            'inactive': 'Inactive - Not currently in use',
            'pending': 'Pending - Awaiting approval',
            'completed': 'Completed - Finished successfully',
            'cancelled': 'Cancelled - No longer active',
            'draft': 'Draft - Not yet finalized'
        };
        const baseText = statusMap[status.toLowerCase()] || `Status: ${status}`;
        return additionalInfo ? `${baseText}\n${additionalInfo}` : baseText;
    }
    static createDateTooltip(date, format) {
        const dateObj = typeof date === 'string' ? new Date(date) : date;
        const now = new Date();
        const diffTime = Math.abs(now.getTime() - dateObj.getTime());
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        let relativeText = '';
        if (diffDays === 0) {
            relativeText = 'Today';
        }
        else if (diffDays === 1) {
            relativeText = 'Yesterday';
        }
        else if (diffDays < 7) {
            relativeText = `${diffDays} days ago`;
        }
        else if (diffDays < 30) {
            const weeks = Math.floor(diffDays / 7);
            relativeText = `${weeks} week${weeks > 1 ? 's' : ''} ago`;
        }
        else {
            const months = Math.floor(diffDays / 30);
            relativeText = `${months} month${months > 1 ? 's' : ''} ago`;
        }
        const formattedDate = dateObj.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
        return `${formattedDate}\n(${relativeText})`;
    }
    static createProgressTooltip(current, total, unit) {
        const percentage = Math.round((current / total) * 100);
        const unitText = unit || '';
        return `${current}${unitText} of ${total}${unitText}\n${percentage}% complete`;
    }
    static createUserTooltip(user) {
        if (!user)
            return 'Unknown user';
        const parts = [];
        if (user.name) {
            parts.push(user.name);
        }
        if (user.email) {
            parts.push(user.email);
        }
        if (user.role) {
            parts.push(`Role: ${user.role}`);
        }
        if (user.department) {
            parts.push(`Dept: ${user.department}`);
        }
        return parts.join('\n');
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: TooltipPipe, deps: [], target: i0.ɵɵFactoryTarget.Pipe }); }
    static { this.ɵpipe = i0.ɵɵngDeclarePipe({ minVersion: "14.0.0", version: "17.3.12", ngImport: i0, type: TooltipPipe, isStandalone: true, name: "tooltip" }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: TooltipPipe, decorators: [{
            type: Pipe,
            args: [{
                    name: 'tooltip',
                    standalone: true
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5waXBlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY29tbW9uLWxpYnMvY29yZS9zcmMvbGliL3BpcGVzL3Rvb2x0aXAucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFpQixNQUFNLGVBQWUsQ0FBQzs7QUFnQnBELE1BQU0sT0FBTyxXQUFXO0lBRXRCLFNBQVMsQ0FBQyxLQUFVLEVBQUUsTUFBK0I7UUFDbkQsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ1gsT0FBTyxFQUFFLENBQUM7UUFDWixDQUFDO1FBRUQsa0RBQWtEO1FBQ2xELElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFLENBQUM7WUFDL0IsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ3JELENBQUM7UUFFRCwwQ0FBMEM7UUFDMUMsSUFBSSxNQUFNLElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFLENBQUM7WUFDekMsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztRQUMzQyxDQUFDO1FBRUQsNkJBQTZCO1FBQzdCLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVPLGFBQWEsQ0FBQyxLQUFVLEVBQUUsTUFBcUI7UUFDckQsSUFBSSxXQUFXLEdBQUcsTUFBTSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsc0JBQXNCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFcEUsdUNBQXVDO1FBQ3ZDLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFLENBQUM7WUFDOUIsV0FBVyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFD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QUNmLFVBQVUsRUFBRSxJQUFJO2lCQUNqQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuZXhwb3J0IGludGVyZmFjZSBUb29sdGlwQ29uZmlnIHtcbiAgdGV4dD86IHN0cmluZztcbiAgcG9zaXRpb24/OiAndG9wJyB8ICdib3R0b20nIHwgJ2xlZnQnIHwgJ3JpZ2h0JztcbiAgZGVsYXk/OiBudW1iZXI7XG4gIHNob3dBcnJvdz86IGJvb2xlYW47XG4gIGN1c3RvbUNsYXNzPzogc3RyaW5nO1xuICBtYXhXaWR0aD86IG51bWJlcjtcbiAgaHRtbD86IGJvb2xlYW47XG59XG5cbkBQaXBlKHtcbiAgbmFtZTogJ3Rvb2x0aXAnLFxuICBzdGFuZGFsb25lOiB0cnVlXG59KVxuZXhwb3J0IGNsYXNzIFRvb2x0aXBQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XG4gIFxuICB0cmFuc2Zvcm0odmFsdWU6IGFueSwgY29uZmlnPzogVG9vbHRpcENvbmZpZyB8IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIC8vIElmIGNvbmZpZyBpcyBhIHN0cmluZywgdHJlYXQgaXQgYXMgdG9vbHRpcCB0ZXh0XG4gICAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRUb29sdGlwKHZhbHVlLCB7IHRleHQ6IGNvbmZpZyB9KTtcbiAgICB9XG5cbiAgICAvLyBJZiBjb25maWcgaXMgYW4gb2JqZWN0LCB1c2UgaXQgZGlyZWN0bHlcbiAgICBpZiAoY29uZmlnICYmIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4gdGhpcy5mb3JtYXRUb29sdGlwKHZhbHVlLCBjb25maWcpO1xuICAgIH1cblxuICAgIC8vIERlZmF1bHQgdG9vbHRpcCBmb3JtYXR0aW5nXG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0VG9vbHRpcCh2YWx1ZSwge30pO1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXRUb29sdGlwKHZhbHVlOiBhbnksIGNvbmZpZzogVG9vbHRpcENvbmZpZyk6IHN0cmluZyB7XG4gICAgbGV0IHRvb2x0aXBUZXh0ID0gY29uZmlnLnRleHQgfHwgdGhpcy5nZW5lcmF0ZURlZmF1bHRUb29sdGlwKHZhbHVlKTtcbiAgICBcbiAgICAvLyBBcHBseSBmb3JtYXR0aW5nIGJhc2VkIG9uIHZhbHVlIHR5cGVcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgdG9vbHRpcFRleHQgPSB0aGlzLmZvcm1hdE9iamVjdFRvb2x0aXAodmFsdWUsIHRvb2x0aXBUZXh0KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRvb2x0aXBUZXh0ID0gdGhpcy5mb3JtYXRTdHJpbmdUb29sdGlwKHZhbHVlLCB0b29sdGlwVGV4dCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICB0b29sdGlwVGV4dCA9IHRoaXMuZm9ybWF0TnVtYmVyVG9vbHRpcCh2YWx1ZSwgdG9vbHRpcFRleHQpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgIHRvb2x0aXBUZXh0ID0gdGhpcy5mb3JtYXRCb29sZWFuVG9vbHRpcCh2YWx1ZSwgdG9vbHRpcFRleHQpO1xuICAgIH1cblxuICAgIC8vIEFkZCBIVE1MIGF0dHJpYnV0ZXMgZm9yIHRvb2x0aXAgY29uZmlndXJhdGlvblxuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLmdlbmVyYXRlVG9vbHRpcEF0dHJpYnV0ZXMoY29uZmlnKTtcbiAgICBcbiAgICByZXR1cm4gYCR7dG9vbHRpcFRleHR9JHthdHRyaWJ1dGVzfWA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRGVmYXVsdFRvb2x0aXAodmFsdWU6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPiA1MCA/IGAke3ZhbHVlLnN1YnN0cmluZygwLCA1MCl9Li4uYCA6IHZhbHVlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdE9iamVjdFRvb2x0aXAob2JqOiBhbnksIGJhc2VUZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmIChvYmoubmFtZSkge1xuICAgICAgcmV0dXJuIGAke29iai5uYW1lfSR7b2JqLmRlc2NyaXB0aW9uID8gYCAtICR7b2JqLmRlc2NyaXB0aW9ufWAgOiAnJ31gO1xuICAgIH1cbiAgICBpZiAob2JqLnRpdGxlKSB7XG4gICAgICByZXR1cm4gYCR7b2JqLnRpdGxlfSR7b2JqLnN1YnRpdGxlID8gYCAtICR7b2JqLnN1YnRpdGxlfWAgOiAnJ31gO1xuICAgIH1cbiAgICBpZiAob2JqLmxhYmVsKSB7XG4gICAgICByZXR1cm4gYCR7b2JqLmxhYmVsfSR7b2JqLnZhbHVlID8gYDogJHtvYmoudmFsdWV9YCA6ICcnfWA7XG4gICAgfVxuICAgIHJldHVybiBiYXNlVGV4dDtcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0U3RyaW5nVG9vbHRpcChzdHI6IHN0cmluZywgYmFzZVRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gSWYgc3RyaW5nIGlzIHRvbyBsb25nLCB0cnVuY2F0ZSBpdFxuICAgIGlmIChzdHIubGVuZ3RoID4gMTAwKSB7XG4gICAgICByZXR1cm4gYCR7c3RyLnN1YnN0cmluZygwLCAxMDApfS4uLmA7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG4gIH1cblxuICBwcml2YXRlIGZvcm1hdE51bWJlclRvb2x0aXAobnVtOiBudW1iZXIsIGJhc2VUZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIEZvcm1hdCBudW1iZXJzIHdpdGggYXBwcm9wcmlhdGUgdW5pdHMgb3IgZm9ybWF0dGluZ1xuICAgIGlmIChudW0gPj0gMTAwMDAwMCkge1xuICAgICAgcmV0dXJuIGAkeyhudW0gLyAxMDAwMDAwKS50b0ZpeGVkKDEpfU1gO1xuICAgIH1cbiAgICBpZiAobnVtID49IDEwMDApIHtcbiAgICAgIHJldHVybiBgJHsobnVtIC8gMTAwMCkudG9GaXhlZCgxKX1LYDtcbiAgICB9XG4gICAgcmV0dXJuIG51bS50b1N0cmluZygpO1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXRCb29sZWFuVG9vbHRpcChib29sOiBib29sZWFuLCBiYXNlVGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYm9vbCA/ICdZZXMnIDogJ05vJztcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUb29sdGlwQXR0cmlidXRlcyhjb25maWc6IFRvb2x0aXBDb25maWcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoY29uZmlnLnBvc2l0aW9uKSB7XG4gICAgICBhdHRyaWJ1dGVzLnB1c2goYGRhdGEtcG9zaXRpb249XCIke2NvbmZpZy5wb3NpdGlvbn1cImApO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuZGVsYXkpIHtcbiAgICAgIGF0dHJpYnV0ZXMucHVzaChgZGF0YS1kZWxheT1cIiR7Y29uZmlnLmRlbGF5fVwiYCk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5zaG93QXJyb3cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXR0cmlidXRlcy5wdXNoKGBkYXRhLWFycm93PVwiJHtjb25maWcuc2hvd0Fycm93fVwiYCk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jdXN0b21DbGFzcykge1xuICAgICAgYXR0cmlidXRlcy5wdXNoKGBkYXRhLWNsYXNzPVwiJHtjb25maWcuY3VzdG9tQ2xhc3N9XCJgKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLm1heFdpZHRoKSB7XG4gICAgICBhdHRyaWJ1dGVzLnB1c2goYGRhdGEtbWF4LXdpZHRoPVwiJHtjb25maWcubWF4V2lkdGh9XCJgKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmh0bWwpIHtcbiAgICAgIGF0dHJpYnV0ZXMucHVzaCgnZGF0YS1odG1sPVwidHJ1ZVwiJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGF0dHJpYnV0ZXMubGVuZ3RoID4gMCA/IGAgJHthdHRyaWJ1dGVzLmpvaW4oJyAnKX1gIDogJyc7XG4gIH1cblxuICAvLyBVdGlsaXR5IG1ldGhvZHMgZm9yIGNvbW1vbiB0b29sdGlwIHBhdHRlcm5zXG4gIHN0YXRpYyBjcmVhdGVTdGF0dXNUb29sdGlwKHN0YXR1czogc3RyaW5nLCBhZGRpdGlvbmFsSW5mbz86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3Qgc3RhdHVzTWFwOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICAgICAgJ2FjdGl2ZSc6ICdBY3RpdmUgLSBDdXJyZW50bHkgaW4gdXNlJyxcbiAgICAgICdpbmFjdGl2ZSc6ICdJbmFjdGl2ZSAtIE5vdCBjdXJyZW50bHkgaW4gdXNlJyxcbiAgICAgICdwZW5kaW5nJzogJ1BlbmRpbmcgLSBBd2FpdGluZyBhcHByb3ZhbCcsXG4gICAgICAnY29tcGxldGVkJzogJ0NvbXBsZXRlZCAtIEZpbmlzaGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAnY2FuY2VsbGVkJzogJ0NhbmNlbGxlZCAtIE5vIGxvbmdlciBhY3RpdmUnLFxuICAgICAgJ2RyYWZ0JzogJ0RyYWZ0IC0gTm90IHlldCBmaW5hbGl6ZWQnXG4gICAgfTtcblxuICAgIGNvbnN0IGJhc2VUZXh0ID0gc3RhdHVzTWFwW3N0YXR1cy50b0xvd2VyQ2FzZSgpXSB8fCBgU3RhdHVzOiAke3N0YXR1c31gO1xuICAgIHJldHVybiBhZGRpdGlvbmFsSW5mbyA/IGAke2Jhc2VUZXh0fVxcbiR7YWRkaXRpb25hbEluZm99YCA6IGJhc2VUZXh0O1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZURhdGVUb29sdGlwKGRhdGU6IERhdGUgfCBzdHJpbmcsIGZvcm1hdD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZGF0ZU9iaiA9IHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJyA/IG5ldyBEYXRlKGRhdGUpIDogZGF0ZTtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRpZmZUaW1lID0gTWF0aC5hYnMobm93LmdldFRpbWUoKSAtIGRhdGVPYmouZ2V0VGltZSgpKTtcbiAgICBjb25zdCBkaWZmRGF5cyA9IE1hdGguY2VpbChkaWZmVGltZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG5cbiAgICBsZXQgcmVsYXRpdmVUZXh0ID0gJyc7XG4gICAgaWYgKGRpZmZEYXlzID09PSAwKSB7XG4gICAgICByZWxhdGl2ZVRleHQgPSAnVG9kYXknO1xuICAgIH0gZWxzZSBpZiAoZGlmZkRheXMgPT09IDEpIHtcbiAgICAgIHJlbGF0aXZlVGV4dCA9ICdZZXN0ZXJkYXknO1xuICAgIH0gZWxzZSBpZiAoZGlmZkRheXMgPCA3KSB7XG4gICAgICByZWxhdGl2ZVRleHQgPSBgJHtkaWZmRGF5c30gZGF5cyBhZ29gO1xuICAgIH0gZWxzZSBpZiAoZGlmZkRheXMgPCAzMCkge1xuICAgICAgY29uc3Qgd2Vla3MgPSBNYXRoLmZsb29yKGRpZmZEYXlzIC8gNyk7XG4gICAgICByZWxhdGl2ZVRleHQgPSBgJHt3ZWVrc30gd2VlayR7d2Vla3MgPiAxID8gJ3MnIDogJyd9IGFnb2A7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG1vbnRocyA9IE1hdGguZmxvb3IoZGlmZkRheXMgLyAzMCk7XG4gICAgICByZWxhdGl2ZVRleHQgPSBgJHttb250aHN9IG1vbnRoJHttb250aHMgPiAxID8gJ3MnIDogJyd9IGFnb2A7XG4gICAgfVxuXG4gICAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGRhdGVPYmoudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi1VUycsIHtcbiAgICAgIHllYXI6ICdudW1lcmljJyxcbiAgICAgIG1vbnRoOiAnbG9uZycsXG4gICAgICBkYXk6ICdudW1lcmljJyxcbiAgICAgIGhvdXI6ICcyLWRpZ2l0JyxcbiAgICAgIG1pbnV0ZTogJzItZGlnaXQnXG4gICAgfSk7XG5cbiAgICByZXR1cm4gYCR7Zm9ybWF0dGVkRGF0ZX1cXG4oJHtyZWxhdGl2ZVRleHR9KWA7XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlUHJvZ3Jlc3NUb29sdGlwKGN1cnJlbnQ6IG51bWJlciwgdG90YWw6IG51bWJlciwgdW5pdD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGN1cnJlbnQgLyB0b3RhbCkgKiAxMDApO1xuICAgIGNvbnN0IHVuaXRUZXh0ID0gdW5pdCB8fCAnJztcbiAgICBcbiAgICByZXR1cm4gYCR7Y3VycmVudH0ke3VuaXRUZXh0fSBvZiAke3RvdGFsfSR7dW5pdFRleHR9XFxuJHtwZXJjZW50YWdlfSUgY29tcGxldGVgO1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZVVzZXJUb29sdGlwKHVzZXI6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKCF1c2VyKSByZXR1cm4gJ1Vua25vd24gdXNlcic7XG4gICAgXG4gICAgY29uc3QgcGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgaWYgKHVzZXIubmFtZSkge1xuICAgICAgcGFydHMucHVzaCh1c2VyLm5hbWUpO1xuICAgIH1cbiAgICBcbiAgICBpZiAodXNlci5lbWFpbCkge1xuICAgICAgcGFydHMucHVzaCh1c2VyLmVtYWlsKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHVzZXIucm9sZSkge1xuICAgICAgcGFydHMucHVzaChgUm9sZTogJHt1c2VyLnJvbGV9YCk7XG4gICAgfVxuICAgIFxuICAgIGlmICh1c2VyLmRlcGFydG1lbnQpIHtcbiAgICAgIHBhcnRzLnB1c2goYERlcHQ6ICR7dXNlci5kZXBhcnRtZW50fWApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcGFydHMuam9pbignXFxuJyk7XG4gIH1cbn0gXG4iXX0=