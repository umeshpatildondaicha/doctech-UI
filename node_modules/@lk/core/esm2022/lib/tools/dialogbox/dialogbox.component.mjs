import { Injectable, Component, Input, Output, EventEmitter, Injector, inject, ChangeDetectorRef } from '@angular/core';
import { MatDialog, MatDialogRef, MatDialogModule, MAT_DIALOG_DATA } from '@angular/material/dialog';
import { CommonModule } from '@angular/common';
import { IconComponent } from '../app-icon/icon.component';
import { AppButtonComponent } from '../app-button/app-button.component';
import { DIALOG_DATA_TOKEN } from '../index';
import { ConfirmationDialogWrapperComponent } from '../confirmation-dialog/confirmation-dialog-wrapper.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class DialogboxService {
    constructor() {
        this.dialog = inject(MatDialog);
    }
    openDialog(component, config = {}) {
        const dialogRef = this.dialog.open(DialogboxContentComponent, {
            data: {
                title: config.title,
                component,
                componentData: config.data,
                hideHeader: config.hideHeader,
                footerActions: config.footerActions
            },
            panelClass: 'custom-dialog-panel',
            width: config.width || '80%',
            height: config.height || '60%',
            minWidth: config.minWidth,
            minHeight: config.minHeight,
            maxWidth: config.maxWidth,
            maxHeight: config.maxHeight,
            autoFocus: false,
            hasBackdrop: true,
            disableClose: false
        });
        return dialogRef;
    }
    openConfirmationDialog(config) {
        const dialogRef = this.dialog.open(ConfirmationDialogWrapperComponent, {
            data: {
                message: config.message,
                title: config.title || 'Confirm',
                cancelText: config.cancelText,
                confirmText: config.confirmText,
                icon: config.icon || 'info',
                showCancel: config.showCancel !== false,
                showConfirm: config.showConfirm !== false
            },
            panelClass: 'confirmation-dialog-panel',
            width: config.width || '450px',
            minWidth: config.minWidth || '400px',
            maxWidth: config.maxWidth || '600px',
            autoFocus: false,
            hasBackdrop: true,
            disableClose: false
        });
        return dialogRef;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxService, decorators: [{
            type: Injectable,
            args: [{ providedIn: 'root' }]
        }] });
export class DialogboxComponent {
    constructor() {
        this.title = '';
        this.closed = new EventEmitter();
        this.dialog = inject(MatDialog);
    }
    openDialog() {
        const dialogRef = this.dialog.open(DialogboxContentComponent, {
            data: { title: this.title, content: this.data },
            panelClass: 'custom-dialog-panel',
            autoFocus: false
        });
        dialogRef.afterClosed().subscribe((result) => {
            this.closed.emit(result);
        });
        return dialogRef;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.12", type: DialogboxComponent, isStandalone: true, selector: "app-dialogbox", inputs: { title: "title", data: "data" }, outputs: { closed: "closed" }, ngImport: i0, template: "", styles: ["::ng-deep .custom-dialog-panel .mat-dialog-container{border-radius:16px;padding:0;min-width:400px;max-width:90vw;box-shadow:0 8px 32px #0000002e;background:#fff;position:relative;margin:auto}::ng-deep .cdk-overlay-pane.custom-dialog-panel{display:flex!important;align-items:center!important;justify-content:center!important}.dialogbox-header{display:flex;align-items:center;justify-content:space-between;padding:.8em .7em .7em;height:3em;border-bottom:1px solid #f0f0f0;font-size:1.2rem;font-weight:600;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-header.confirmation-header{justify-content:center;padding:20px 24px}.dialogbox-title{flex:1;color:#222;font-size:1.15rem;font-weight:600}.dialogbox-title.centered-title{flex:none;text-align:center;color:#1f2937}.close-icon{cursor:pointer;color:#888;transition:color .2s;margin-left:16px}.close-icon:hover{color:#18b6b2}.dialogbox-content{padding:1em;height:calc(100% - 6.5em);background:var(--surface-color);border-bottom-left-radius:16px;border-bottom-right-radius:16px;max-height:75vh;overflow:scroll}.dialogbox-content.no-header{padding-top:16px;padding-bottom:16px;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-content.has-footer{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid #f0f0f0}.dialogbox-content app-filter{display:block;width:100%;height:600px;max-height:70vh}.dialogbox-content app-filter .filter-container{height:100%;max-height:100%}.dialogbox-footer{display:flex;align-items:center;justify-content:flex-end;padding:1em 1.2em;height:3.5em;background:#fff;border-bottom-left-radius:16px;border-bottom-right-radius:16px;border-top:1px solid #f0f0f0;gap:0}.dialogbox-footer:has(+.dialogbox-content.no-header),.no-header~.dialogbox-footer{padding-top:12px;padding-bottom:12px}.dialogbox-footer .footer-actions{display:flex;align-items:center;justify-content:flex-end;gap:0;width:100%}.dialogbox-footer .footer-actions app-button{position:relative;margin:0}.dialogbox-footer .footer-actions app-button:not(:last-child){margin-right:0;padding-right:12px}.dialogbox-footer .footer-actions app-button:not(:first-child){padding-left:12px;border-left:1px solid #e5e7eb}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "ngmodule", type: MatDialogModule }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-dialogbox', standalone: true, imports: [CommonModule, MatDialogModule], template: "", styles: ["::ng-deep .custom-dialog-panel .mat-dialog-container{border-radius:16px;padding:0;min-width:400px;max-width:90vw;box-shadow:0 8px 32px #0000002e;background:#fff;position:relative;margin:auto}::ng-deep .cdk-overlay-pane.custom-dialog-panel{display:flex!important;align-items:center!important;justify-content:center!important}.dialogbox-header{display:flex;align-items:center;justify-content:space-between;padding:.8em .7em .7em;height:3em;border-bottom:1px solid #f0f0f0;font-size:1.2rem;font-weight:600;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-header.confirmation-header{justify-content:center;padding:20px 24px}.dialogbox-title{flex:1;color:#222;font-size:1.15rem;font-weight:600}.dialogbox-title.centered-title{flex:none;text-align:center;color:#1f2937}.close-icon{cursor:pointer;color:#888;transition:color .2s;margin-left:16px}.close-icon:hover{color:#18b6b2}.dialogbox-content{padding:1em;height:calc(100% - 6.5em);background:var(--surface-color);border-bottom-left-radius:16px;border-bottom-right-radius:16px;max-height:75vh;overflow:scroll}.dialogbox-content.no-header{padding-top:16px;padding-bottom:16px;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-content.has-footer{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid #f0f0f0}.dialogbox-content app-filter{display:block;width:100%;height:600px;max-height:70vh}.dialogbox-content app-filter .filter-container{height:100%;max-height:100%}.dialogbox-footer{display:flex;align-items:center;justify-content:flex-end;padding:1em 1.2em;height:3.5em;background:#fff;border-bottom-left-radius:16px;border-bottom-right-radius:16px;border-top:1px solid #f0f0f0;gap:0}.dialogbox-footer:has(+.dialogbox-content.no-header),.no-header~.dialogbox-footer{padding-top:12px;padding-bottom:12px}.dialogbox-footer .footer-actions{display:flex;align-items:center;justify-content:flex-end;gap:0;width:100%}.dialogbox-footer .footer-actions app-button{position:relative;margin:0}.dialogbox-footer .footer-actions app-button:not(:last-child){margin-right:0;padding-right:12px}.dialogbox-footer .footer-actions app-button:not(:first-child){padding-left:12px;border-left:1px solid #e5e7eb}\n"] }]
        }], propDecorators: { title: [{
                type: Input
            }], data: [{
                type: Input
            }], closed: [{
                type: Output
            }] } });
export class DialogboxContentComponent {
    constructor() {
        this.dialogRef = inject((MatDialogRef));
        this.data = inject(MAT_DIALOG_DATA);
        this.injector = inject(Injector);
        this.changeDetectorRef = inject(ChangeDetectorRef);
        // Store original footer actions for dynamic updates
        this.originalFooterActions = [];
        // Create injector once in constructor to prevent recreation on every change detection
        this.componentInjector = Injector.create({
            providers: [
                { provide: DIALOG_DATA_TOKEN, useValue: this.data.componentData }
            ],
            parent: this.injector
        });
        // Store original footer actions
        if (this.data?.footerActions) {
            this.originalFooterActions = [...this.data.footerActions];
        }
    }
    close() {
        this.dialogRef.close();
    }
    isConfirmationDialog() {
        return this.data?.componentData?.isConfirmationDialog === true;
    }
    onFooterActionClick(actionId, event) {
        // Emit action data through dialog close
        // This can be caught in afterClosed() subscription
        // For confirmation dialogs, add confirmed flag
        const result = { action: actionId, actionId, event };
        if (actionId === 'confirm') {
            result.confirmed = true;
        }
        else if (actionId === 'cancel') {
            result.confirmed = false;
        }
        this.dialogRef.close(result);
    }
    /**
     * Update footer actions dynamically
     * @param actions - New array of footer actions, or a function to filter/update existing actions
     */
    updateFooterActions(actions) {
        if (!this.data)
            return;
        if (typeof actions === 'function') {
            // If a function is provided, use it to filter/update actions
            const allActions = this.originalFooterActions.length > 0
                ? this.originalFooterActions
                : (this.data.footerActions || []);
            // Store original if not already stored
            if (this.originalFooterActions.length === 0 && allActions.length > 0) {
                this.originalFooterActions = [...allActions];
            }
            // Create a new array reference to trigger change detection
            const updatedActions = actions(allActions);
            // Create a completely new array with new object references
            this.data.footerActions = updatedActions.map(action => ({ ...action }));
        }
        else if (actions) {
            // If an array is provided, use it directly
            this.data.footerActions = actions.map(action => ({ ...action }));
        }
        // Trigger change detection - use both markForCheck and detectChanges
        this.changeDetectorRef.markForCheck();
        this.changeDetectorRef.detectChanges();
    }
    /**
     * Update disabled state of a specific footer action
     * @param actionId - ID of the action to update
     * @param disabled - New disabled state
     */
    setFooterActionDisabled(actionId, disabled) {
        if (!this.data?.footerActions)
            return;
        const action = this.data.footerActions.find((a) => a.id === actionId);
        if (action) {
            action.disabled = disabled;
            this.changeDetectorRef.detectChanges();
        }
    }
    /**
     * Get current footer actions
     */
    getFooterActions() {
        return this.data?.footerActions || [];
    }
    /**
     * Get original footer actions
     */
    getOriginalFooterActions() {
        return this.originalFooterActions.length > 0 ? this.originalFooterActions : (this.data?.footerActions || []);
    }
    /**
     * Track by function for ngFor to improve change detection
     */
    trackByActionId(index, action) {
        return action.id;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxContentComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.12", type: DialogboxContentComponent, isStandalone: true, selector: "app-dialogbox-content", ngImport: i0, template: "<div class=\"dialogbox-header\" *ngIf=\"!data?.hideHeader\" [class.confirmation-header]=\"isConfirmationDialog()\">\n  <div class=\"dialogbox-title\" [class.centered-title]=\"isConfirmationDialog()\">{{ data?.title }}</div>\n  <app-icon *ngIf=\"!isConfirmationDialog()\" fontIcon=\"close\" [size]=\"22\" (iconClick)=\"close()\" class=\"close-icon\"></app-icon>\n</div>\n<div class=\"dialogbox-content\" [class.no-header]=\"data?.hideHeader\" [class.has-footer]=\"data?.footerActions?.length\">\n  <ng-container *ngIf=\"data?.component\">\n    <ng-container *ngComponentOutlet=\"data.component; injector: componentInjector\"></ng-container>\n  </ng-container>\n  <ng-container *ngIf=\"!data?.component\">\n    <ng-container *ngIf=\"data?.content; else projected\">\n      {{ data.content }}\n    </ng-container>\n    <ng-template #projected>\n      <ng-content></ng-content>\n    </ng-template>\n  </ng-container>\n</div>\n<div class=\"dialogbox-footer\" *ngIf=\"data?.footerActions?.length\">\n  <div class=\"footer-actions\">\n    <app-button\n      *ngFor=\"let action of data.footerActions; trackBy: trackByActionId\"\n      [text]=\"action.text\"\n      [color]=\"action.color || 'primary'\"\n      [appearance]=\"action.appearance || 'raised'\"\n      [disabled]=\"action.disabled || false\"\n      [fontIcon]=\"action.fontIcon || ''\"\n      [class]=\"action.class || ''\"\n      (btnClick)=\"onFooterActionClick(action.id, $event)\"\n    ></app-button>\n  </div>\n</div> ", styles: ["::ng-deep .custom-dialog-panel .mat-dialog-container{border-radius:16px;padding:0;min-width:400px;max-width:90vw;box-shadow:0 8px 32px #0000002e;background:#fff;position:relative;margin:auto}::ng-deep .cdk-overlay-pane.custom-dialog-panel{display:flex!important;align-items:center!important;justify-content:center!important}.dialogbox-header{display:flex;align-items:center;justify-content:space-between;padding:.8em .7em .7em;height:3em;border-bottom:1px solid #f0f0f0;font-size:1.2rem;font-weight:600;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-header.confirmation-header{justify-content:center;padding:20px 24px}.dialogbox-title{flex:1;color:#222;font-size:1.15rem;font-weight:600}.dialogbox-title.centered-title{flex:none;text-align:center;color:#1f2937}.close-icon{cursor:pointer;color:#888;transition:color .2s;margin-left:16px}.close-icon:hover{color:#18b6b2}.dialogbox-content{padding:1em;height:calc(100% - 6.5em);background:var(--surface-color);border-bottom-left-radius:16px;border-bottom-right-radius:16px;max-height:75vh;overflow:scroll}.dialogbox-content.no-header{padding-top:16px;padding-bottom:16px;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-content.has-footer{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid #f0f0f0}.dialogbox-content app-filter{display:block;width:100%;height:600px;max-height:70vh}.dialogbox-content app-filter .filter-container{height:100%;max-height:100%}.dialogbox-footer{display:flex;align-items:center;justify-content:flex-end;padding:1em 1.2em;height:3.5em;background:#fff;border-bottom-left-radius:16px;border-bottom-right-radius:16px;border-top:1px solid #f0f0f0;gap:0}.dialogbox-footer:has(+.dialogbox-content.no-header),.no-header~.dialogbox-footer{padding-top:12px;padding-bottom:12px}.dialogbox-footer .footer-actions{display:flex;align-items:center;justify-content:flex-end;gap:0;width:100%}.dialogbox-footer .footer-actions app-button{position:relative;margin:0}.dialogbox-footer .footer-actions app-button:not(:last-child){margin-right:0;padding-right:12px}.dialogbox-footer .footer-actions app-button:not(:first-child){padding-left:12px;border-left:1px solid #e5e7eb}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgComponentOutlet, selector: "[ngComponentOutlet]", inputs: ["ngComponentOutlet", "ngComponentOutletInputs", "ngComponentOutletInjector", "ngComponentOutletContent", "ngComponentOutletNgModule", "ngComponentOutletNgModuleFactory"] }, { kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "ngmodule", type: MatDialogModule }, { kind: "component", type: IconComponent, selector: "app-icon", inputs: ["fontSet", "fontIcon", "iconType", "icomoonClass", "size", "isBlink", "fontBold", "color", "class", "counter", "isCovered"], outputs: ["iconClick"] }, { kind: "component", type: AppButtonComponent, selector: "app-button", inputs: ["color", "type", "disabled", "appearance", "class", "text", "fontIcon"], outputs: ["btnClick"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: DialogboxContentComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-dialogbox-content', standalone: true, imports: [CommonModule, MatDialogModule, IconComponent, AppButtonComponent], template: "<div class=\"dialogbox-header\" *ngIf=\"!data?.hideHeader\" [class.confirmation-header]=\"isConfirmationDialog()\">\n  <div class=\"dialogbox-title\" [class.centered-title]=\"isConfirmationDialog()\">{{ data?.title }}</div>\n  <app-icon *ngIf=\"!isConfirmationDialog()\" fontIcon=\"close\" [size]=\"22\" (iconClick)=\"close()\" class=\"close-icon\"></app-icon>\n</div>\n<div class=\"dialogbox-content\" [class.no-header]=\"data?.hideHeader\" [class.has-footer]=\"data?.footerActions?.length\">\n  <ng-container *ngIf=\"data?.component\">\n    <ng-container *ngComponentOutlet=\"data.component; injector: componentInjector\"></ng-container>\n  </ng-container>\n  <ng-container *ngIf=\"!data?.component\">\n    <ng-container *ngIf=\"data?.content; else projected\">\n      {{ data.content }}\n    </ng-container>\n    <ng-template #projected>\n      <ng-content></ng-content>\n    </ng-template>\n  </ng-container>\n</div>\n<div class=\"dialogbox-footer\" *ngIf=\"data?.footerActions?.length\">\n  <div class=\"footer-actions\">\n    <app-button\n      *ngFor=\"let action of data.footerActions; trackBy: trackByActionId\"\n      [text]=\"action.text\"\n      [color]=\"action.color || 'primary'\"\n      [appearance]=\"action.appearance || 'raised'\"\n      [disabled]=\"action.disabled || false\"\n      [fontIcon]=\"action.fontIcon || ''\"\n      [class]=\"action.class || ''\"\n      (btnClick)=\"onFooterActionClick(action.id, $event)\"\n    ></app-button>\n  </div>\n</div> ", styles: ["::ng-deep .custom-dialog-panel .mat-dialog-container{border-radius:16px;padding:0;min-width:400px;max-width:90vw;box-shadow:0 8px 32px #0000002e;background:#fff;position:relative;margin:auto}::ng-deep .cdk-overlay-pane.custom-dialog-panel{display:flex!important;align-items:center!important;justify-content:center!important}.dialogbox-header{display:flex;align-items:center;justify-content:space-between;padding:.8em .7em .7em;height:3em;border-bottom:1px solid #f0f0f0;font-size:1.2rem;font-weight:600;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-header.confirmation-header{justify-content:center;padding:20px 24px}.dialogbox-title{flex:1;color:#222;font-size:1.15rem;font-weight:600}.dialogbox-title.centered-title{flex:none;text-align:center;color:#1f2937}.close-icon{cursor:pointer;color:#888;transition:color .2s;margin-left:16px}.close-icon:hover{color:#18b6b2}.dialogbox-content{padding:1em;height:calc(100% - 6.5em);background:var(--surface-color);border-bottom-left-radius:16px;border-bottom-right-radius:16px;max-height:75vh;overflow:scroll}.dialogbox-content.no-header{padding-top:16px;padding-bottom:16px;border-top-left-radius:16px;border-top-right-radius:16px}.dialogbox-content.has-footer{border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom:1px solid #f0f0f0}.dialogbox-content app-filter{display:block;width:100%;height:600px;max-height:70vh}.dialogbox-content app-filter .filter-container{height:100%;max-height:100%}.dialogbox-footer{display:flex;align-items:center;justify-content:flex-end;padding:1em 1.2em;height:3.5em;background:#fff;border-bottom-left-radius:16px;border-bottom-right-radius:16px;border-top:1px solid #f0f0f0;gap:0}.dialogbox-footer:has(+.dialogbox-content.no-header),.no-header~.dialogbox-footer{padding-top:12px;padding-bottom:12px}.dialogbox-footer .footer-actions{display:flex;align-items:center;justify-content:flex-end;gap:0;width:100%}.dialogbox-footer .footer-actions app-button{position:relative;margin:0}.dialogbox-footer .footer-actions app-button:not(:last-child){margin-right:0;padding-right:12px}.dialogbox-footer .footer-actions app-button:not(:first-child){padding-left:12px;border-left:1px solid #e5e7eb}\n"] }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlhbG9nYm94LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbW1vbi1saWJzL2NvcmUvc3JjL2xpYi90b29scy9kaWFsb2dib3gvZGlhbG9nYm94LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbW1vbi1saWJzL2NvcmUvc3JjL2xpYi90b29scy9kaWFsb2dib3gvZGlhbG9nYm94LmNvbXBvbmVudC5odG1sIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY29tbW9uLWxpYnMvY29yZS9zcmMvbGliL3Rvb2xzL2RpYWxvZ2JveC9kaWFsb2dib3gtY29udGVudC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBZ0IsUUFBUSxFQUFFLE1BQU0sRUFBRSxpQkFBaUIsRUFBMkIsTUFBTSxlQUFlLENBQUM7QUFDL0osT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JHLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFDeEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRTdDLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLDhEQUE4RCxDQUFDOzs7QUFhbEgsTUFBTSxPQUFPLGdCQUFnQjtJQUQ3QjtRQUVVLFdBQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7S0FzRXBDO0lBcEVDLFVBQVUsQ0FBQyxTQUFv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SUFFRDs7T0FFRztJQUNILHdCQUF3QjtRQUN0QixPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxhQUFhLElBQUksRUFBRSxDQUFDLENBQUM7SUFDL0csQ0FBQztJQUVEOztPQUVHO0lBQ0gsZUFBZSxDQUFDLEtBQWEsRUFBRSxNQUEwQjtRQUN2RCxPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUM7SUFDbkIsQ0FBQzsrR0FoSFUseUJBQXlCO21HQUF6Qix5QkFBeUIsaUZFL0h0Qyx3OENBOEJPLHF1RUY2RkssWUFBWSx1Z0JBQUUsZUFBZSwrQkFBRSxhQUFhLG1OQUFFLGtCQUFrQjs7NEZBSS9ELHlCQUF5QjtrQkFQckMsU0FBUzsrQkFDRSx1QkFBdUIsY0FDckIsSUFBSSxXQUNQLENBQUMsWUFBWSxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsa0JBQWtCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBUeXBlLCBJbmplY3RvciwgaW5qZWN0LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE1hdERpYWxvZywgTWF0RGlhbG9nUmVmLCBNYXREaWFsb2dNb2R1bGUsIE1BVF9ESUFMT0dfREFUQSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgSWNvbkNvbXBvbmVudCB9IGZyb20gJy4uL2FwcC1pY29uL2ljb24uY29tcG9uZW50JztcbmltcG9ydCB7IEFwcEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gJy4uL2FwcC1idXR0b24vYXBwLWJ1dHRvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgRElBTE9HX0RBVEFfVE9LRU4gfSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBDb25maXJtYXRpb25EaWFsb2dDb21wb25lbnQsIENvbmZpcm1hdGlvbkRpYWxvZ0RhdGEgfSBmcm9tICcuLi9jb25maXJtYXRpb24tZGlhbG9nL2NvbmZpcm1hdGlvbi1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IENvbmZpcm1hdGlvbkRpYWxvZ1dyYXBwZXJDb21wb25lbnQgfSBmcm9tICcuLi9jb25maXJtYXRpb24tZGlhbG9nL2NvbmZpcm1hdGlvbi1kaWFsb2ctd3JhcHBlci5jb21wb25lbnQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERpYWxvZ0Zvb3RlckFjdGlvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbiAgY29sb3I/OiAncHJpbWFyeScgfCAnYWNjZW50JyB8ICd3YXJuJyB8ICdzZWNvbmRhcnknIHwgJ2Rhbmdlcic7XG4gIGFwcGVhcmFuY2U/OiAncmFpc2VkJyB8ICdmbGF0JyB8ICdzdHJva2VkJyB8ICdpY29uJyB8ICdmYWInIHwgJ21pbmktZmFiJyB8ICdiYXNpYyc7XG4gIGRpc2FibGVkPzogYm9vbGVhbjtcbiAgZm9udEljb24/OiBzdHJpbmc7XG4gIGNsYXNzPzogc3RyaW5nO1xufVxuXG5ASW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KVxuZXhwb3J0IGNsYXNzIERpYWxvZ2JveFNlcnZpY2Uge1xuICBwcml2YXRlIGRpYWxvZyA9IGluamVjdChNYXREaWFsb2cpO1xuXG4gIG9wZW5EaWFsb2coY29tcG9uZW50OiBUeXBlPGFueT4sIGNvbmZpZzogeyBcbiAgICB0aXRsZT86IHN0cmluZzsgXG4gICAgZGF0YT86IGFueTsgXG4gICAgd2lkdGg/OiBzdHJpbmc7IFxuICAgIGhlaWdodD86IHN0cmluZztcbiAgICBtaW5XaWR0aD86IHN0cmluZztcbiAgICBtaW5IZWlnaHQ/OiBzdHJpbmc7XG4gICAgbWF4V2lkdGg/OiBzdHJpbmc7XG4gICAgbWF4SGVpZ2h0Pzogc3RyaW5nO1xuICAgIGhpZGVIZWFkZXI/OiBib29sZWFuO1xuICAgIGZvb3RlckFjdGlvbnM/OiBEaWFsb2dGb290ZXJBY3Rpb25bXTtcbiAgfSA9IHt9KSB7XG4gICAgY29uc3QgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihEaWFsb2dib3hDb250ZW50Q29tcG9uZW50LCB7XG4gICAgICBkYXRhOiB7IFxuICAgICAgICB0aXRsZTogY29uZmlnLnRpdGxlLCBcbiAgICAgICAgY29tcG9uZW50LCBcbiAgICAgICAgY29tcG9uZW50RGF0YTogY29uZmlnLmRhdGEsIFxuICAgICAgICBoaWRlSGVhZGVyOiBjb25maWcuaGlkZUhlYWRlcixcbiAgICAgICAgZm9vdGVyQWN0aW9uczogY29uZmlnLmZvb3RlckFjdGlvbnNcbiAgICAgIH0sXG4gICAgICBwYW5lbENsYXNzOiAnY3VzdG9tLWRpYWxvZy1wYW5lbCcsXG4gICAgICB3aWR0aDogY29uZmlnLndpZHRoIHx8ICc4MCUnLFxuICAgICAgaGVpZ2h0OiBjb25maWcuaGVpZ2h0IHx8ICc2MCUnLFxuICAgICAgbWluV2lkdGg6IGNvbmZpZy5taW5XaWR0aCxcbiAgICAgIG1pbkhlaWdodDogY29uZmlnLm1pbkhlaWdodCxcbiAgICAgIG1heFdpZHRoOiBjb25maWcubWF4V2lkdGgsXG4gICAgICBtYXhIZWlnaHQ6IGNvbmZpZy5tYXhIZWlnaHQsXG4gICAgICBhdXRvRm9jdXM6IGZhbHNlLFxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXG4gICAgICBkaXNhYmxlQ2xvc2U6IGZhbHNlXG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIGRpYWxvZ1JlZjtcbiAgfVxuXG4gIG9wZW5Db25maXJtYXRpb25EaWFsb2coY29uZmlnOiB7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIHRpdGxlPzogc3RyaW5nO1xuICAgIGNhbmNlbFRleHQ/OiBzdHJpbmc7XG4gICAgY29uZmlybVRleHQ/OiBzdHJpbmc7XG4gICAgaWNvbj86IHN0cmluZztcbiAgICBzaG93Q2FuY2VsPzogYm9vbGVhbjtcbiAgICBzaG93Q29uZmlybT86IGJvb2xlYW47XG4gICAgd2lkdGg/OiBzdHJpbmc7XG4gICAgbWluV2lkdGg/OiBzdHJpbmc7XG4gICAgbWF4V2lkdGg/OiBzdHJpbmc7XG4gIH0pOiBNYXREaWFsb2dSZWY8YW55PiB7XG4gICAgY29uc3QgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihDb25maXJtYXRpb25EaWFsb2dXcmFwcGVyQ29tcG9uZW50LCB7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIG1lc3NhZ2U6IGNvbmZpZy5tZXNzYWdlLFxuICAgICAgICB0aXRsZTogY29uZmlnLnRpdGxlIHx8ICdDb25maXJtJyxcbiAgICAgICAgY2FuY2VsVGV4dDogY29uZmlnLmNhbmNlbFRleHQsXG4gICAgICAgIGNvbmZpcm1UZXh0OiBjb25maWcuY29uZmlybVRleHQsXG4gICAgICAgIGljb246IGNvbmZpZy5pY29uIHx8ICdpbmZvJyxcbiAgICAgICAgc2hvd0NhbmNlbDogY29uZmlnLnNob3dDYW5jZWwgIT09IGZhbHNlLFxuICAgICAgICBzaG93Q29uZmlybTogY29uZmlnLnNob3dDb25maXJtICE9PSBmYWxzZVxuICAgICAgfSxcbiAgICAgIHBhbmVsQ2xhc3M6ICdjb25maXJtYXRpb24tZGlhbG9nLXBhbmVsJyxcbiAgICAgIHdpZHRoOiBjb25maWcud2lkdGggfHwgJzQ1MHB4JyxcbiAgICAgIG1pbldpZHRoOiBjb25maWcubWluV2lkdGggfHwgJzQwMHB4JyxcbiAgICAgIG1heFdpZHRoOiBjb25maWcubWF4V2lkdGggfHwgJzYwMHB4JyxcbiAgICAgIGF1dG9Gb2N1czogZmFsc2UsXG4gICAgICBoYXNCYWNrZHJvcDogdHJ1ZSxcbiAgICAgIGRpc2FibGVDbG9zZTogZmFsc2VcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gZGlhbG9nUmVmO1xuICB9XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FwcC1kaWFsb2dib3gnLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBNYXREaWFsb2dNb2R1bGVdLFxuICB0ZW1wbGF0ZVVybDogJy4vZGlhbG9nYm94LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmw6ICcuL2RpYWxvZ2JveC5jb21wb25lbnQuc2Nzcydcbn0pXG5leHBvcnQgY2xhc3MgRGlhbG9nYm94Q29tcG9uZW50IHtcbiAgQElucHV0KCkgdGl0bGU6IHN0cmluZyA9ICcnO1xuICBASW5wdXQoKSBkYXRhOiBhbnk7XG4gIEBPdXRwdXQoKSBjbG9zZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBwcml2YXRlIGRpYWxvZyA9IGluamVjdChNYXREaWFsb2cpO1xuXG4gIG9wZW5EaWFsb2coKTogTWF0RGlhbG9nUmVmPGFueT4ge1xuICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oRGlhbG9nYm94Q29udGVudENvbXBvbmVudCwge1xuICAgICAgZGF0YTogeyB0aXRsZTogdGhpcy50aXRsZSwgY29udGVudDogdGhpcy5kYXRhIH0sXG4gICAgICBwYW5lbENsYXNzOiAnY3VzdG9tLWRpYWxvZy1wYW5lbCcsXG4gICAgICBhdXRvRm9jdXM6IGZhbHNlXG4gICAgfSk7XG4gICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgdGhpcy5jbG9zZWQuZW1pdChyZXN1bHQpO1xuICAgIH0pO1xuICAgIHJldHVybiBkaWFsb2dSZWY7XG4gIH1cbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYXBwLWRpYWxvZ2JveC1jb250ZW50JyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZSwgTWF0RGlhbG9nTW9kdWxlLCBJY29uQ29tcG9uZW50LCBBcHBCdXR0b25Db21wb25lbnRdLFxuICB0ZW1wbGF0ZVVybDogJy4vZGlhbG9nYm94LWNvbnRlbnQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9kaWFsb2dib3guY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBEaWFsb2dib3hDb250ZW50Q29tcG9uZW50IHtcbiAgZGlhbG9nUmVmID0gaW5qZWN0KE1hdERpYWxvZ1JlZjxEaWFsb2dib3hDb250ZW50Q29tcG9uZW50Pik7XG4gIGRhdGEgPSBpbmplY3Q8YW55PihNQVRfRElBTE9HX0RBVEEpO1xuICBwcml2YXRlIGluamVjdG9yID0gaW5qZWN0KEluamVjdG9yKTtcbiAgY29tcG9uZW50SW5qZWN0b3I6IEluamVjdG9yOyAvLyBQdWJsaWMgc28gdGVtcGxhdGUgY2FuIGFjY2VzcyBpdFxuICBjaGFuZ2VEZXRlY3RvclJlZiA9IGluamVjdChDaGFuZ2VEZXRlY3RvclJlZik7XG4gIFxuICAvLyBTdG9yZSBvcmlnaW5hbCBmb290ZXIgYWN0aW9ucyBmb3IgZHluYW1pYyB1cGRhdGVzXG4gIHByaXZhdGUgb3JpZ2luYWxGb290ZXJBY3Rpb25zOiBEaWFsb2dGb290ZXJBY3Rpb25bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIENyZWF0ZSBpbmplY3RvciBvbmNlIGluIGNvbnN0cnVjdG9yIHRvIHByZXZlbnQgcmVjcmVhdGlvbiBvbiBldmVyeSBjaGFuZ2UgZGV0ZWN0aW9uXG4gICAgdGhpcy5jb21wb25lbnRJbmplY3RvciA9IEluamVjdG9yLmNyZWF0ZSh7XG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgeyBwcm92aWRlOiBESUFMT0dfREFUQV9UT0tFTiwgdXNlVmFsdWU6IHRoaXMuZGF0YS5jb21wb25lbnREYXRhIH1cbiAgICAgIF0sXG4gICAgICBwYXJlbnQ6IHRoaXMuaW5qZWN0b3JcbiAgICB9KTtcbiAgICBcbiAgICAvLyBTdG9yZSBvcmlnaW5hbCBmb290ZXIgYWN0aW9uc1xuICAgIGlmICh0aGlzLmRhdGE/LmZvb3RlckFjdGlvbnMpIHtcbiAgICAgIHRoaXMub3JpZ2luYWxGb290ZXJBY3Rpb25zID0gWy4uLnRoaXMuZGF0YS5mb290ZXJBY3Rpb25zXTtcbiAgICB9XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICB9XG5cbiAgaXNDb25maXJtYXRpb25EaWFsb2coKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YT8uY29tcG9uZW50RGF0YT8uaXNDb25maXJtYXRpb25EaWFsb2cgPT09IHRydWU7XG4gIH1cblxuICBvbkZvb3RlckFjdGlvbkNsaWNrKGFjdGlvbklkOiBzdHJpbmcsIGV2ZW50OiBFdmVudCkge1xuICAgIC8vIEVtaXQgYWN0aW9uIGRhdGEgdGhyb3VnaCBkaWFsb2cgY2xvc2VcbiAgICAvLyBUaGlzIGNhbiBiZSBjYXVnaHQgaW4gYWZ0ZXJDbG9zZWQoKSBzdWJzY3JpcHRpb25cbiAgICAvLyBGb3IgY29uZmlybWF0aW9uIGRpYWxvZ3MsIGFkZCBjb25maXJtZWQgZmxhZ1xuICAgIGNvbnN0IHJlc3VsdDogYW55ID0geyBhY3Rpb246IGFjdGlvbklkLCBhY3Rpb25JZCwgZXZlbnQgfTtcbiAgICBpZiAoYWN0aW9uSWQgPT09ICdjb25maXJtJykge1xuICAgICAgcmVzdWx0LmNvbmZpcm1lZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChhY3Rpb25JZCA9PT0gJ2NhbmNlbCcpIHtcbiAgICAgIHJlc3VsdC5jb25maXJtZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UocmVzdWx0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgZm9vdGVyIGFjdGlvbnMgZHluYW1pY2FsbHlcbiAgICogQHBhcmFtIGFjdGlvbnMgLSBOZXcgYXJyYXkgb2YgZm9vdGVyIGFjdGlvbnMsIG9yIGEgZnVuY3Rpb24gdG8gZmlsdGVyL3VwZGF0ZSBleGlzdGluZyBhY3Rpb25zXG4gICAqL1xuICB1cGRhdGVGb290ZXJBY3Rpb25zKGFjdGlvbnM/OiBEaWFsb2dGb290ZXJBY3Rpb25bXSB8ICgoYWN0aW9uczogRGlhbG9nRm9vdGVyQWN0aW9uW10pID0+IERpYWxvZ0Zvb3RlckFjdGlvbltdKSkge1xuICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm47XG4gICAgXG4gICAgaWYgKHR5cGVvZiBhY3Rpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyBJZiBhIGZ1bmN0aW9uIGlzIHByb3ZpZGVkLCB1c2UgaXQgdG8gZmlsdGVyL3VwZGF0ZSBhY3Rpb25zXG4gICAgICBjb25zdCBhbGxBY3Rpb25zID0gdGhpcy5vcmlnaW5hbEZvb3RlckFjdGlvbnMubGVuZ3RoID4gMCBcbiAgICAgICAgPyB0aGlzLm9yaWdpbmFsRm9vdGVyQWN0aW9ucyBcbiAgICAgICAgOiAodGhpcy5kYXRhLmZvb3RlckFjdGlvbnMgfHwgW10pO1xuICAgICAgXG4gICAgICAvLyBTdG9yZSBvcmlnaW5hbCBpZiBub3QgYWxyZWFkeSBzdG9yZWRcbiAgICAgIGlmICh0aGlzLm9yaWdpbmFsRm9vdGVyQWN0aW9ucy5sZW5ndGggPT09IDAgJiYgYWxsQWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMub3JpZ2luYWxGb290ZXJBY3Rpb25zID0gWy4uLmFsbEFjdGlvbnNdO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDcmVhdGUgYSBuZXcgYXJyYXkgcmVmZXJlbmNlIHRvIHRyaWdnZXIgY2hhbmdlIGRldGVjdGlvblxuICAgICAgY29uc3QgdXBkYXRlZEFjdGlvbnMgPSBhY3Rpb25zKGFsbEFjdGlvbnMpO1xuICAgICAgLy8gQ3JlYXRlIGEgY29tcGxldGVseSBuZXcgYXJyYXkgd2l0aCBuZXcgb2JqZWN0IHJlZmVyZW5jZXNcbiAgICAgIHRoaXMuZGF0YS5mb290ZXJBY3Rpb25zID0gdXBkYXRlZEFjdGlvbnMubWFwKGFjdGlvbiA9PiAoeyAuLi5hY3Rpb24gfSkpO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9ucykge1xuICAgICAgLy8gSWYgYW4gYXJyYXkgaXMgcHJvdmlkZWQsIHVzZSBpdCBkaXJlY3RseVxuICAgICAgdGhpcy5kYXRhLmZvb3RlckFjdGlvbnMgPSBhY3Rpb25zLm1hcChhY3Rpb24gPT4gKHsgLi4uYWN0aW9uIH0pKTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHJpZ2dlciBjaGFuZ2UgZGV0ZWN0aW9uIC0gdXNlIGJvdGggbWFya0ZvckNoZWNrIGFuZCBkZXRlY3RDaGFuZ2VzXG4gICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgZGlzYWJsZWQgc3RhdGUgb2YgYSBzcGVjaWZpYyBmb290ZXIgYWN0aW9uXG4gICAqIEBwYXJhbSBhY3Rpb25JZCAtIElEIG9mIHRoZSBhY3Rpb24gdG8gdXBkYXRlXG4gICAqIEBwYXJhbSBkaXNhYmxlZCAtIE5ldyBkaXNhYmxlZCBzdGF0ZVxuICAgKi9cbiAgc2V0Rm9vdGVyQWN0aW9uRGlzYWJsZWQoYWN0aW9uSWQ6IHN0cmluZywgZGlzYWJsZWQ6IGJvb2xlYW4pIHtcbiAgICBpZiAoIXRoaXMuZGF0YT8uZm9vdGVyQWN0aW9ucykgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGF0YS5mb290ZXJBY3Rpb25zLmZpbmQoKGE6IERpYWxvZ0Zvb3RlckFjdGlvbikgPT4gYS5pZCA9PT0gYWN0aW9uSWQpO1xuICAgIGlmIChhY3Rpb24pIHtcbiAgICAgIGFjdGlvbi5kaXNhYmxlZCA9IGRpc2FibGVkO1xuICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IGZvb3RlciBhY3Rpb25zXG4gICAqL1xuICBnZXRGb290ZXJBY3Rpb25zKCk6IERpYWxvZ0Zvb3RlckFjdGlvbltdIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhPy5mb290ZXJBY3Rpb25zIHx8IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBvcmlnaW5hbCBmb290ZXIgYWN0aW9uc1xuICAgKi9cbiAgZ2V0T3JpZ2luYWxGb290ZXJBY3Rpb25zKCk6IERpYWxvZ0Zvb3RlckFjdGlvbltdIHtcbiAgICByZXR1cm4gdGhpcy5vcmlnaW5hbEZvb3RlckFjdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMub3JpZ2luYWxGb290ZXJBY3Rpb25zIDogKHRoaXMuZGF0YT8uZm9vdGVyQWN0aW9ucyB8fCBbXSk7XG4gIH1cblxuICAvKipcbiAgICogVHJhY2sgYnkgZnVuY3Rpb24gZm9yIG5nRm9yIHRvIGltcHJvdmUgY2hhbmdlIGRldGVjdGlvblxuICAgKi9cbiAgdHJhY2tCeUFjdGlvbklkKGluZGV4OiBudW1iZXIsIGFjdGlvbjogRGlhbG9nRm9vdGVyQWN0aW9uKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYWN0aW9uLmlkO1xuICB9XG59XG4iLCIiLCI8ZGl2IGNsYXNzPVwiZGlhbG9nYm94LWhlYWRlclwiICpuZ0lmPVwiIWRhdGE/LmhpZGVIZWFkZXJcIiBbY2xhc3MuY29uZmlybWF0aW9uLWhlYWRlcl09XCJpc0NvbmZpcm1hdGlvbkRpYWxvZygpXCI+XG4gIDxkaXYgY2xhc3M9XCJkaWFsb2dib3gtdGl0bGVcIiBbY2xhc3MuY2VudGVyZWQtdGl0bGVdPVwiaXNDb25maXJtYXRpb25EaWFsb2coKVwiPnt7IGRhdGE/LnRpdGxlIH19PC9kaXY+XG4gIDxhcHAtaWNvbiAqbmdJZj1cIiFpc0NvbmZpcm1hdGlvbkRpYWxvZygpXCIgZm9udEljb249XCJjbG9zZVwiIFtzaXplXT1cIjIyXCIgKGljb25DbGljayk9XCJjbG9zZSgpXCIgY2xhc3M9XCJjbG9zZS1pY29uXCI+PC9hcHAtaWNvbj5cbjwvZGl2PlxuPGRpdiBjbGFzcz1cImRpYWxvZ2JveC1jb250ZW50XCIgW2NsYXNzLm5vLWhlYWRlcl09XCJkYXRhPy5oaWRlSGVhZGVyXCIgW2NsYXNzLmhhcy1mb290ZXJdPVwiZGF0YT8uZm9vdGVyQWN0aW9ucz8ubGVuZ3RoXCI+XG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCJkYXRhPy5jb21wb25lbnRcIj5cbiAgICA8bmctY29udGFpbmVyICpuZ0NvbXBvbmVudE91dGxldD1cImRhdGEuY29tcG9uZW50OyBpbmplY3RvcjogY29tcG9uZW50SW5qZWN0b3JcIj48L25nLWNvbnRhaW5lcj5cbiAgPC9uZy1jb250YWluZXI+XG4gIDxuZy1jb250YWluZXIgKm5nSWY9XCIhZGF0YT8uY29tcG9uZW50XCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImRhdGE/LmNvbnRlbnQ7IGVsc2UgcHJvamVjdGVkXCI+XG4gICAgICB7eyBkYXRhLmNvbnRlbnQgfX1cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8bmctdGVtcGxhdGUgI3Byb2plY3RlZD5cbiAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgICA8L25nLXRlbXBsYXRlPlxuICA8L25nLWNvbnRhaW5lcj5cbjwvZGl2PlxuPGRpdiBjbGFzcz1cImRpYWxvZ2JveC1mb290ZXJcIiAqbmdJZj1cImRhdGE/LmZvb3RlckFjdGlvbnM/Lmxlbmd0aFwiPlxuICA8ZGl2IGNsYXNzPVwiZm9vdGVyLWFjdGlvbnNcIj5cbiAgICA8YXBwLWJ1dHRvblxuICAgICAgKm5nRm9yPVwibGV0IGFjdGlvbiBvZiBkYXRhLmZvb3RlckFjdGlvbnM7IHRyYWNrQnk6IHRyYWNrQnlBY3Rpb25JZFwiXG4gICAgICBbdGV4dF09XCJhY3Rpb24udGV4dFwiXG4gICAgICBbY29sb3JdPVwiYWN0aW9uLmNvbG9yIHx8ICdwcmltYXJ5J1wiXG4gICAgICBbYXBwZWFyYW5jZV09XCJhY3Rpb24uYXBwZWFyYW5jZSB8fCAncmFpc2VkJ1wiXG4gICAgICBbZGlzYWJsZWRdPVwiYWN0aW9uLmRpc2FibGVkIHx8IGZhbHNlXCJcbiAgICAgIFtmb250SWNvbl09XCJhY3Rpb24uZm9udEljb24gfHwgJydcIlxuICAgICAgW2NsYXNzXT1cImFjdGlvbi5jbGFzcyB8fCAnJ1wiXG4gICAgICAoYnRuQ2xpY2spPVwib25Gb290ZXJBY3Rpb25DbGljayhhY3Rpb24uaWQsICRldmVudClcIlxuICAgID48L2FwcC1idXR0b24+XG4gIDwvZGl2PlxuPC9kaXY+ICJdfQ==