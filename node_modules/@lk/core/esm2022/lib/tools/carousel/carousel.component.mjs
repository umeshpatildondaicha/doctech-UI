import { Component, Input, Output, EventEmitter, ContentChild } from '@angular/core';
import { CommonModule } from '@angular/common';
import { AppButtonComponent } from '../app-button/app-button.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
export class CarouselComponent {
    constructor() {
        this.items = [];
        this.height = '400px';
        this.width = '100%';
        this.autoPlay = false;
        this.autoPlayInterval = 3000;
        this.showIndicators = true;
        this.showControls = true;
        this.loop = true;
        this.itemChange = new EventEmitter();
        this.currentIndex = 0;
    }
    ngOnInit() {
        if (this.autoPlay && this.items.length > 1) {
            this.startAutoPlay();
        }
    }
    ngOnChanges(changes) {
        if (changes['items'] && this.items.length > 0) {
            if (this.currentIndex >= this.items.length) {
                this.currentIndex = 0;
            }
        }
        if (changes['autoPlay']) {
            if (this.autoPlay) {
                this.startAutoPlay();
            }
            else {
                this.stopAutoPlay();
            }
        }
    }
    ngOnDestroy() {
        this.stopAutoPlay();
    }
    startAutoPlay() {
        this.stopAutoPlay();
        if (this.autoPlay && this.items.length > 1) {
            this.autoPlayTimer = setInterval(() => {
                this.next();
            }, this.autoPlayInterval);
        }
    }
    stopAutoPlay() {
        if (this.autoPlayTimer) {
            clearInterval(this.autoPlayTimer);
            this.autoPlayTimer = null;
        }
    }
    next() {
        if (this.currentIndex < this.items.length - 1) {
            this.currentIndex++;
        }
        else if (this.loop) {
            this.currentIndex = 0;
        }
        this.emitItemChange();
    }
    previous() {
        if (this.currentIndex > 0) {
            this.currentIndex--;
        }
        else if (this.loop) {
            this.currentIndex = this.items.length - 1;
        }
        this.emitItemChange();
    }
    goTo(index) {
        if (index >= 0 && index < this.items.length) {
            this.currentIndex = index;
            this.emitItemChange();
        }
    }
    emitItemChange() {
        if (this.items[this.currentIndex]) {
            this.itemChange.emit({
                index: this.currentIndex,
                item: this.items[this.currentIndex]
            });
        }
    }
    get currentItem() {
        return this.items[this.currentIndex] || null;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: CarouselComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.3.12", type: CarouselComponent, isStandalone: true, selector: "app-carousel", inputs: { items: "items", height: "height", width: "width", autoPlay: "autoPlay", autoPlayInterval: "autoPlayInterval", showIndicators: "showIndicators", showControls: "showControls", loop: "loop" }, outputs: { itemChange: "itemChange" }, queries: [{ propertyName: "itemTemplate", first: true, predicate: ["carouselItemTemplate"], descendants: true }], usesOnChanges: true, ngImport: i0, template: "<div class=\"carousel-container\" [style.width]=\"width\" [style.height]=\"height\">\n  <div class=\"carousel-wrapper\">\n    @if (showControls && items.length > 1) {\n      <app-button\n        appearance=\"icon\"\n        type=\"button\"\n        [class]=\"'carousel-control prev'\"\n        [fontIcon]=\"'chevron_left'\"\n        (btnClick)=\"previous()\"\n      ></app-button>\n      <app-button\n        appearance=\"icon\"\n        type=\"button\"\n        [class]=\"'carousel-control next'\"\n        [fontIcon]=\"'chevron_right'\"\n        (btnClick)=\"next()\"\n      ></app-button>\n    }\n\n    <div class=\"carousel-content\">\n      @if (itemTemplate && currentItem) {\n        <ng-container *ngTemplateOutlet=\"itemTemplate; context: { $implicit: currentItem, index: currentIndex }\"></ng-container>\n      } @else if (currentItem) {\n        <div class=\"carousel-item-default\">\n          @if (currentItem.image) {\n            <img [src]=\"currentItem.image\" [alt]=\"currentItem.title || 'Carousel item'\" class=\"carousel-image\" />\n          }\n          @if (currentItem.title) {\n            <div class=\"carousel-title\">{{ currentItem.title }}</div>\n          }\n          @if (currentItem.description) {\n            <div class=\"carousel-description\">{{ currentItem.description }}</div>\n          }\n        </div>\n      }\n    </div>\n  </div>\n\n  @if (showIndicators && items.length > 1) {\n    <div class=\"carousel-indicators\">\n      @for (item of items; track $index) {\n        <app-button\n          appearance=\"icon\"\n          type=\"button\"\n          [class]=\"'indicator' + (currentIndex === $index ? ' active' : '')\"\n          (btnClick)=\"goTo($index)\"\n          [attr.aria-label]=\"'Go to slide ' + ($index + 1)\"\n        ></app-button>\n      }\n    </div>\n  }\n</div>\n\n", styles: [".carousel-container{position:relative;overflow:hidden;border-radius:4px}.carousel-wrapper{position:relative;width:100%;height:100%}.carousel-control{position:absolute;top:50%;transform:translateY(-50%);background-color:#00000080;color:#fff;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;transition:background-color .2s}.carousel-control:hover{background-color:#000000b3}.carousel-control mat-icon{font-size:24px;width:24px;height:24px}.carousel-control.prev{left:16px}.carousel-control.next{right:16px}.carousel-content{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.carousel-item-default{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:32px}.carousel-image{max-width:100%;max-height:100%;object-fit:contain;margin-bottom:16px}.carousel-title{font-size:24px;font-weight:500;margin-bottom:8px;color:#424242}.carousel-description{font-size:16px;color:#757575}.carousel-indicators{position:absolute;bottom:16px;left:50%;transform:translate(-50%);display:flex;gap:8px;z-index:10}.indicator{width:12px;height:12px;border-radius:50%;border:2px solid white;background-color:#ffffff80;cursor:pointer;transition:background-color .2s}.indicator:hover{background-color:#fffc}.indicator.active{background-color:#fff}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: AppButtonComponent, selector: "app-button", inputs: ["color", "type", "disabled", "appearance", "class", "text", "fontIcon"], outputs: ["btnClick"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: CarouselComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-carousel', standalone: true, imports: [CommonModule, AppButtonComponent], template: "<div class=\"carousel-container\" [style.width]=\"width\" [style.height]=\"height\">\n  <div class=\"carousel-wrapper\">\n    @if (showControls && items.length > 1) {\n      <app-button\n        appearance=\"icon\"\n        type=\"button\"\n        [class]=\"'carousel-control prev'\"\n        [fontIcon]=\"'chevron_left'\"\n        (btnClick)=\"previous()\"\n      ></app-button>\n      <app-button\n        appearance=\"icon\"\n        type=\"button\"\n        [class]=\"'carousel-control next'\"\n        [fontIcon]=\"'chevron_right'\"\n        (btnClick)=\"next()\"\n      ></app-button>\n    }\n\n    <div class=\"carousel-content\">\n      @if (itemTemplate && currentItem) {\n        <ng-container *ngTemplateOutlet=\"itemTemplate; context: { $implicit: currentItem, index: currentIndex }\"></ng-container>\n      } @else if (currentItem) {\n        <div class=\"carousel-item-default\">\n          @if (currentItem.image) {\n            <img [src]=\"currentItem.image\" [alt]=\"currentItem.title || 'Carousel item'\" class=\"carousel-image\" />\n          }\n          @if (currentItem.title) {\n            <div class=\"carousel-title\">{{ currentItem.title }}</div>\n          }\n          @if (currentItem.description) {\n            <div class=\"carousel-description\">{{ currentItem.description }}</div>\n          }\n        </div>\n      }\n    </div>\n  </div>\n\n  @if (showIndicators && items.length > 1) {\n    <div class=\"carousel-indicators\">\n      @for (item of items; track $index) {\n        <app-button\n          appearance=\"icon\"\n          type=\"button\"\n          [class]=\"'indicator' + (currentIndex === $index ? ' active' : '')\"\n          (btnClick)=\"goTo($index)\"\n          [attr.aria-label]=\"'Go to slide ' + ($index + 1)\"\n        ></app-button>\n      }\n    </div>\n  }\n</div>\n\n", styles: [".carousel-container{position:relative;overflow:hidden;border-radius:4px}.carousel-wrapper{position:relative;width:100%;height:100%}.carousel-control{position:absolute;top:50%;transform:translateY(-50%);background-color:#00000080;color:#fff;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;transition:background-color .2s}.carousel-control:hover{background-color:#000000b3}.carousel-control mat-icon{font-size:24px;width:24px;height:24px}.carousel-control.prev{left:16px}.carousel-control.next{right:16px}.carousel-content{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.carousel-item-default{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:32px}.carousel-image{max-width:100%;max-height:100%;object-fit:contain;margin-bottom:16px}.carousel-title{font-size:24px;font-weight:500;margin-bottom:8px;color:#424242}.carousel-description{font-size:16px;color:#757575}.carousel-indicators{position:absolute;bottom:16px;left:50%;transform:translate(-50%);display:flex;gap:8px;z-index:10}.indicator{width:12px;height:12px;border-radius:50%;border:2px solid white;background-color:#ffffff80;cursor:pointer;transition:background-color .2s}.indicator:hover{background-color:#fffc}.indicator.active{background-color:#fff}\n"] }]
        }], propDecorators: { items: [{
                type: Input
            }], height: [{
                type: Input
            }], width: [{
                type: Input
            }], autoPlay: [{
                type: Input
            }], autoPlayInterval: [{
                type: Input
            }], showIndicators: [{
                type: Input
            }], showControls: [{
                type: Input
            }], loop: [{
                type: Input
            }], itemTemplate: [{
                type: ContentChild,
                args: ['carouselItemTemplate']
            }], itemChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2Fyb3VzZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY29tbW9uLWxpYnMvY29yZS9zcmMvbGliL3Rvb2xzL2Nhcm91c2VsL2Nhcm91c2VsLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbW1vbi1saWJzL2NvcmUvc3JjL2xpYi90b29scy9jYXJvdXNlbC9jYXJvdXNlbC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUE0RCxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0ksT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG9DQUFvQyxDQUFDOzs7QUFnQnhFLE1BQU0sT0FBTyxpQkFBaUI7SUFQOUI7UUFRVyxVQUFLLEdBQW1CLEVBQUUsQ0FBQztRQUMzQixXQUFNLEdBQVcsT0FBTyxDQUFDO1FBQ3pCLFVBQUssR0FBVyxNQUFNLENBQUM7UUFDdkIsYUFBUSxHQUFZLEtBQUssQ0FBQztRQUMxQixxQkFBZ0IsR0FBVyxJQUFJLENBQUM7UUFDaEMsbUJBQWMsR0FBWSxJQUFJLENBQUM7UUFDL0IsaUJBQVksR0FBWSxJQUFJLENBQUM7UUFDN0IsU0FBSSxHQUFZLElBQUksQ0FBQztRQUlwQixlQUFVLEdBQUcsSUFBSSxZQUFZLEVBQXlDLENBQUM7UUFFakYsaUJBQVksR0FBVyxDQUFDLENBQUM7S0FpRjFCO0lBOUVDLFFBQVE7UUFDTixJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7WUFDM0MsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3ZCLENBQUM7SUFDSCxDQUFDO0lBRUQsV0FBVyxDQUFDLE9BQXNCO1FBQ2hDLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzlDLElBQUksSUFBSSxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUMzQyxJQUFJLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQztZQUN4QixDQUFDO1FBQ0gsQ0FBQztRQUNELElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7WUFDeEIsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ2xCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUN2QixDQUFDO2lCQUFNLENBQUM7Z0JBQ04sSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3RCLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDdEIsQ0FBQztJQUVELGFBQWE7UUFDWCxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDcEIsSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzNDLElBQUksQ0FBQyxhQUFhLEdBQUcsV0FBVyxDQUFDLEdBQUcsRUFBRTtnQkFDcEMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2QsQ0FBQyxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO0lBRUQsWUFBWTtRQUNWLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ3ZCLGFBQWEsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDbEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7UUFDNUIsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJO1FBQ0YsSUFBSSxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzlDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUN0QixDQUFDO2FBQU0sSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDckIsSUFBSSxDQUFDLFlBQVksR0FBRyxDQUFDLENBQUM7UUFDeEIsQ0FBQztRQUNELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksSUFBSSxDQUFDLFlBQVksR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUMxQixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDdEIsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3JCLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQzVDLENBQUM7UUFDRCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFhO1FBQ2hCLElBQUksS0FBSyxJQUFJLENBQUMsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUM1QyxJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQztZQUMxQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDeEIsQ0FBQztJQUNILENBQUM7SUFFRCxjQUFjO1FBQ1osSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDO1lBQ2xDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO2dCQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLFlBQVk7Z0JBQ3hCLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7YUFDcEMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJLFdBQVc7UUFDYixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLElBQUksQ0FBQztJQUMvQyxDQUFDOytHQTlGVSxpQkFBaUI7bUdBQWpCLGlCQUFpQiw4YkNsQjlCLDB5REFxREEsbzdDRHZDWSxZQUFZLHNNQUFFLGtCQUFrQjs7NEZBSS9CLGlCQUFpQjtrQkFQN0IsU0FBUzsrQkFDRSxjQUFjLGNBQ1osSUFBSSxXQUNQLENBQUMsWUFBWSxFQUFFLGtCQUFrQixDQUFDOzhCQUtsQyxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUNHLEtBQUs7c0JBQWIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLGdCQUFnQjtzQkFBeEIsS0FBSztnQkFDRyxjQUFjO3NCQUF0QixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csSUFBSTtzQkFBWixLQUFLO2dCQUVnQyxZQUFZO3NCQUFqRCxZQUFZO3VCQUFDLHNCQUFzQjtnQkFFMUIsVUFBVTtzQkFBbkIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95LCBTaW1wbGVDaGFuZ2VzLCBUZW1wbGF0ZVJlZiwgQ29udGVudENoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgQXBwQnV0dG9uQ29tcG9uZW50IH0gZnJvbSAnLi4vYXBwLWJ1dHRvbi9hcHAtYnV0dG9uLmNvbXBvbmVudCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2Fyb3VzZWxJdGVtIHtcbiAgaW1hZ2U/OiBzdHJpbmc7XG4gIHRpdGxlPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgZGF0YT86IGFueTtcbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYXBwLWNhcm91c2VsJyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZSwgQXBwQnV0dG9uQ29tcG9uZW50XSxcbiAgdGVtcGxhdGVVcmw6ICcuL2Nhcm91c2VsLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmw6ICcuL2Nhcm91c2VsLmNvbXBvbmVudC5zY3NzJ1xufSlcbmV4cG9ydCBjbGFzcyBDYXJvdXNlbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuICBASW5wdXQoKSBpdGVtczogQ2Fyb3VzZWxJdGVtW10gPSBbXTtcbiAgQElucHV0KCkgaGVpZ2h0OiBzdHJpbmcgPSAnNDAwcHgnO1xuICBASW5wdXQoKSB3aWR0aDogc3RyaW5nID0gJzEwMCUnO1xuICBASW5wdXQoKSBhdXRvUGxheTogYm9vbGVhbiA9IGZhbHNlO1xuICBASW5wdXQoKSBhdXRvUGxheUludGVydmFsOiBudW1iZXIgPSAzMDAwO1xuICBASW5wdXQoKSBzaG93SW5kaWNhdG9yczogYm9vbGVhbiA9IHRydWU7XG4gIEBJbnB1dCgpIHNob3dDb250cm9sczogYm9vbGVhbiA9IHRydWU7XG4gIEBJbnB1dCgpIGxvb3A6IGJvb2xlYW4gPSB0cnVlO1xuICBcbiAgQENvbnRlbnRDaGlsZCgnY2Fyb3VzZWxJdGVtVGVtcGxhdGUnKSBpdGVtVGVtcGxhdGU/OiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBcbiAgQE91dHB1dCgpIGl0ZW1DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHsgaW5kZXg6IG51bWJlcjsgaXRlbTogQ2Fyb3VzZWxJdGVtIH0+KCk7XG5cbiAgY3VycmVudEluZGV4OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGF1dG9QbGF5VGltZXI6IGFueTtcblxuICBuZ09uSW5pdCgpIHtcbiAgICBpZiAodGhpcy5hdXRvUGxheSAmJiB0aGlzLml0ZW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgIHRoaXMuc3RhcnRBdXRvUGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlc1snaXRlbXMnXSAmJiB0aGlzLml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+PSB0aGlzLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzWydhdXRvUGxheSddKSB7XG4gICAgICBpZiAodGhpcy5hdXRvUGxheSkge1xuICAgICAgICB0aGlzLnN0YXJ0QXV0b1BsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3RvcEF1dG9QbGF5KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5zdG9wQXV0b1BsYXkoKTtcbiAgfVxuXG4gIHN0YXJ0QXV0b1BsYXkoKSB7XG4gICAgdGhpcy5zdG9wQXV0b1BsYXkoKTtcbiAgICBpZiAodGhpcy5hdXRvUGxheSAmJiB0aGlzLml0ZW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgIHRoaXMuYXV0b1BsYXlUaW1lciA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgdGhpcy5uZXh0KCk7XG4gICAgICB9LCB0aGlzLmF1dG9QbGF5SW50ZXJ2YWwpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3BBdXRvUGxheSgpIHtcbiAgICBpZiAodGhpcy5hdXRvUGxheVRpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b1BsYXlUaW1lcik7XG4gICAgICB0aGlzLmF1dG9QbGF5VGltZXIgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIG5leHQoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudEluZGV4IDwgdGhpcy5pdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCsrO1xuICAgIH0gZWxzZSBpZiAodGhpcy5sb29wKSB7XG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IDA7XG4gICAgfVxuICAgIHRoaXMuZW1pdEl0ZW1DaGFuZ2UoKTtcbiAgfVxuXG4gIHByZXZpb3VzKCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+IDApIHtcbiAgICAgIHRoaXMuY3VycmVudEluZGV4LS07XG4gICAgfSBlbHNlIGlmICh0aGlzLmxvb3ApIHtcbiAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgIH1cbiAgICB0aGlzLmVtaXRJdGVtQ2hhbmdlKCk7XG4gIH1cblxuICBnb1RvKGluZGV4OiBudW1iZXIpIHtcbiAgICBpZiAoaW5kZXggPj0gMCAmJiBpbmRleCA8IHRoaXMuaXRlbXMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IGluZGV4O1xuICAgICAgdGhpcy5lbWl0SXRlbUNoYW5nZSgpO1xuICAgIH1cbiAgfVxuXG4gIGVtaXRJdGVtQ2hhbmdlKCkge1xuICAgIGlmICh0aGlzLml0ZW1zW3RoaXMuY3VycmVudEluZGV4XSkge1xuICAgICAgdGhpcy5pdGVtQ2hhbmdlLmVtaXQoe1xuICAgICAgICBpbmRleDogdGhpcy5jdXJyZW50SW5kZXgsXG4gICAgICAgIGl0ZW06IHRoaXMuaXRlbXNbdGhpcy5jdXJyZW50SW5kZXhdXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBnZXQgY3VycmVudEl0ZW0oKTogQ2Fyb3VzZWxJdGVtIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuaXRlbXNbdGhpcy5jdXJyZW50SW5kZXhdIHx8IG51bGw7XG4gIH1cbn1cblxuIiwiPGRpdiBjbGFzcz1cImNhcm91c2VsLWNvbnRhaW5lclwiIFtzdHlsZS53aWR0aF09XCJ3aWR0aFwiIFtzdHlsZS5oZWlnaHRdPVwiaGVpZ2h0XCI+XG4gIDxkaXYgY2xhc3M9XCJjYXJvdXNlbC13cmFwcGVyXCI+XG4gICAgQGlmIChzaG93Q29udHJvbHMgJiYgaXRlbXMubGVuZ3RoID4gMSkge1xuICAgICAgPGFwcC1idXR0b25cbiAgICAgICAgYXBwZWFyYW5jZT1cImljb25cIlxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgW2NsYXNzXT1cIidjYXJvdXNlbC1jb250cm9sIHByZXYnXCJcbiAgICAgICAgW2ZvbnRJY29uXT1cIidjaGV2cm9uX2xlZnQnXCJcbiAgICAgICAgKGJ0bkNsaWNrKT1cInByZXZpb3VzKClcIlxuICAgICAgPjwvYXBwLWJ1dHRvbj5cbiAgICAgIDxhcHAtYnV0dG9uXG4gICAgICAgIGFwcGVhcmFuY2U9XCJpY29uXCJcbiAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgIFtjbGFzc109XCInY2Fyb3VzZWwtY29udHJvbCBuZXh0J1wiXG4gICAgICAgIFtmb250SWNvbl09XCInY2hldnJvbl9yaWdodCdcIlxuICAgICAgICAoYnRuQ2xpY2spPVwibmV4dCgpXCJcbiAgICAgID48L2FwcC1idXR0b24+XG4gICAgfVxuXG4gICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLWNvbnRlbnRcIj5cbiAgICAgIEBpZiAoaXRlbVRlbXBsYXRlICYmIGN1cnJlbnRJdGVtKSB7XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJpdGVtVGVtcGxhdGU7IGNvbnRleHQ6IHsgJGltcGxpY2l0OiBjdXJyZW50SXRlbSwgaW5kZXg6IGN1cnJlbnRJbmRleCB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICB9IEBlbHNlIGlmIChjdXJyZW50SXRlbSkge1xuICAgICAgICA8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaXRlbS1kZWZhdWx0XCI+XG4gICAgICAgICAgQGlmIChjdXJyZW50SXRlbS5pbWFnZSkge1xuICAgICAgICAgICAgPGltZyBbc3JjXT1cImN1cnJlbnRJdGVtLmltYWdlXCIgW2FsdF09XCJjdXJyZW50SXRlbS50aXRsZSB8fCAnQ2Fyb3VzZWwgaXRlbSdcIiBjbGFzcz1cImNhcm91c2VsLWltYWdlXCIgLz5cbiAgICAgICAgICB9XG4gICAgICAgICAgQGlmIChjdXJyZW50SXRlbS50aXRsZSkge1xuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLXRpdGxlXCI+e3sgY3VycmVudEl0ZW0udGl0bGUgfX08L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgICAgQGlmIChjdXJyZW50SXRlbS5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcm91c2VsLWRlc2NyaXB0aW9uXCI+e3sgY3VycmVudEl0ZW0uZGVzY3JpcHRpb24gfX08L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvZGl2PlxuICAgICAgfVxuICAgIDwvZGl2PlxuICA8L2Rpdj5cblxuICBAaWYgKHNob3dJbmRpY2F0b3JzICYmIGl0ZW1zLmxlbmd0aCA+IDEpIHtcbiAgICA8ZGl2IGNsYXNzPVwiY2Fyb3VzZWwtaW5kaWNhdG9yc1wiPlxuICAgICAgQGZvciAoaXRlbSBvZiBpdGVtczsgdHJhY2sgJGluZGV4KSB7XG4gICAgICAgIDxhcHAtYnV0dG9uXG4gICAgICAgICAgYXBwZWFyYW5jZT1cImljb25cIlxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgIFtjbGFzc109XCInaW5kaWNhdG9yJyArIChjdXJyZW50SW5kZXggPT09ICRpbmRleCA/ICcgYWN0aXZlJyA6ICcnKVwiXG4gICAgICAgICAgKGJ0bkNsaWNrKT1cImdvVG8oJGluZGV4KVwiXG4gICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCInR28gdG8gc2xpZGUgJyArICgkaW5kZXggKyAxKVwiXG4gICAgICAgID48L2FwcC1idXR0b24+XG4gICAgICB9XG4gICAgPC9kaXY+XG4gIH1cbjwvZGl2PlxuXG4iXX0=