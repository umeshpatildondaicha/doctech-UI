import { Component, Input, Output, EventEmitter, Inject, PLATFORM_ID } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import { AgGridModule } from 'ag-grid-angular';
import { AllCommunityModule, ModuleRegistry } from 'ag-grid-community';
import { CommonModule } from '@angular/common';
import { HttpClientModule, HttpParams } from '@angular/common/http';
import { MatMenuModule } from '@angular/material/menu';
import { MatIconModule } from '@angular/material/icon';
import { MatButtonModule } from '@angular/material/button';
import { AppInputComponent } from '../app-input/app-input.component';
import { FilterComponent } from '../filter/filter.component';
import { GridMenuRendererComponent } from '../grid-menu-renderer/grid-menu-renderer.component';
import { IconComponent } from '../app-icon/icon.component';
import { forkJoin, of } from 'rxjs';
import { catchError } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "../dialogbox/dialogbox.component";
import * as i2 from "../../services/api-config.service";
import * as i3 from "@angular/common/http";
import * as i4 from "@angular/common";
import * as i5 from "ag-grid-angular";
import * as i6 from "@angular/material/icon";
// AG Grid v34+ requires module registration for features like pagination, filtering, row API, etc.
// Register all community modules once for the app (safe to call multiple times).
ModuleRegistry.registerModules([AllCommunityModule]);
/**
 * Grid Component with Menu Support
 *
 * This component extends the standard ag-grid with menu functionality.
 *
 * Menu Configuration:
 * 1. Set menuActions in gridOptions to automatically add a menu column
 * 2. Or manually add a column with cellRenderer: 'gridMenu'
 *
 * Example usage:
 * ```typescript
 * this.gridOptions = {
 *   menuActions: [
 *     {
 *       title: 'View',
 *       icon: 'visibility',
 *       click: (param) => this.onView(param.data)
 *     },
 *     {
 *       title: 'Edit',
 *       icon: 'edit',
 *       click: (param) => this.onEdit(param.data)
 *     },
 *     {
 *       title: 'Delete',
 *       icon: 'delete',
 *       click: (param) => this.onDelete(param.data)
 *     }
 *   ]
 * };
 * ```
 */
export class GridComponent {
    constructor(dialogbox, platformId, apiConfigService, http) {
        this.dialogbox = dialogbox;
        this.platformId = platformId;
        this.apiConfigService = apiConfigService;
        this.http = http;
        this.rowData = [];
        this.columnDefs = [];
        this.gridOptions = {};
        this.domLayout = 'autoHeight';
        this.animateRows = true;
        this.class = 'ag-theme-alpine';
        this.height = '400px';
        this.width = '100%';
        this.showHeader = true;
        this.searchPlaceholder = 'Search...';
        this.rightTooltemplateRef = null;
        this.cardTemplate = null;
        this.defaultViewMode = 'list';
        this.showAddButton = false;
        this.apiConfig = null;
        this.searchChange = new EventEmitter();
        this.rowClicked = new EventEmitter();
        this.addClick = new EventEmitter();
        this.searchText = '';
        this.filteredRowData = [];
        this.processedColumnDefs = [];
        this.activeFiltersCount = 0;
        this.activeFilterChips = [];
        this.viewMode = 'list';
        this.displayedRows = 0;
        this.totalRows = 0;
        this._activeFilters = [];
        this._activeLogic = 'AND';
        this.isBrowser = isPlatformBrowser(this.platformId);
    }
    ngOnInit() {
        this.gridOptions.pagination = true;
        this.gridOptions.paginationPageSize = 25;
        this.gridOptions.paginationPageSizeSelector = [10, 25, 50, 100];
        this.gridOptions.rowHeight = 48;
        this.gridOptions.headerHeight = 40;
        this.gridOptions.suppressCellFocus = true;
        this.gridOptions.getRowHeight = (params) => {
            // Support dynamic row height for multi-line content
            return params.node.rowHeight || 48;
        };
        this.gridOptions.context = { gridOptions: this.gridOptions };
        this.gridOptions.noRowsOverlayComponentParams = {
            noRowsMessageFunc: () => 'No records to display'
        };
        // Configure row selection if enabled
        if (this.gridOptions.rowSelection) {
            // Ensure row clicks trigger selection
            if (this.gridOptions.suppressRowClickSelection === undefined) {
                this.gridOptions.suppressRowClickSelection = false;
            }
            // Add row selection class
            this.class = (this.class || 'ag-theme-clean') + ' has-row-selection';
        }
        // Register cell renderer components for AG-Grid
        // This ensures AG-Grid can resolve the components at runtime
        if (!this.gridOptions.components) {
            this.gridOptions.components = {};
        }
        this.gridOptions.components['gridMenu'] = GridMenuRendererComponent;
        this.filteredRowData = [...this.rowData];
        this.viewMode = this.defaultViewMode;
        if (this.shouldFetchFromApi()) {
            this.fetchGridDataFromApi();
        }
        else {
            this.processColumnDefs();
            this.updatePaginationInfo();
        }
    }
    ngOnChanges(changes) {
        const rowDataChanged = 'rowData' in changes;
        const apiConfigChanged = 'apiConfig' in changes;
        if (rowDataChanged && this.rowData && this.rowData.length > 0) {
            this.filteredRowData = this.applySearchTo([...this.rowData]);
            this.processColumnDefs();
            this.updatePaginationInfo();
            return;
        }
        if (apiConfigChanged && this.shouldFetchFromApi()) {
            this.fetchGridDataFromApi();
        }
    }
    onGridReady(params) {
        this.gridApi = params.api;
        this.updatePaginationInfo();
    }
    onModelUpdated(event) {
        this.updatePaginationInfo();
    }
    updatePaginationInfo() {
        if (this.gridApi) {
            const totalFilteredRows = this.gridApi.getDisplayedRowCount();
            const pageSize = this.gridApi.paginationGetPageSize();
            const currentPage = this.gridApi.paginationGetCurrentPage();
            const startRow = currentPage * pageSize;
            const endRow = Math.min(startRow + pageSize, totalFilteredRows);
            const displayedOnPage = totalFilteredRows > 0 ? endRow - startRow : 0;
            this.displayedRows = displayedOnPage;
            this.totalRows = totalFilteredRows;
        }
        else {
            this.displayedRows = this.filteredRowData.length;
            this.totalRows = this.filteredRowData.length;
        }
    }
    onAddClick() {
        this.addClick.emit();
    }
    onColumnSettingsClick() {
        // Emit event or open column visibility dialog
        if (this.gridApi) {
            // Can implement column visibility toggle here
            console.log('Column settings clicked');
        }
    }
    /**
     * Get status class based on status value
     * Helper method to automatically determine status badge class from enum/string values
     */
    static getStatusClass(statusValue) {
        if (!statusValue)
            return 'status-neutral';
        const status = String(statusValue).toLowerCase().replace(/[_\s-]/g, '-');
        // Success states
        if (['paid', 'closed', 'cleared', 'active', 'completed', 'approved', 'enabled', 'online', 'available', 'done', 'finished', 'resolved', 'accepted', 'verified', 'confirmed', 'delivered', 'published', 'live'].includes(status)) {
            return 'status-success';
        }
        // Error/Danger states
        if (['cancelled', 'canceled', 'failed', 'void', 'rejected', 'denied', 'blocked', 'disabled', 'inactive', 'unavailable', 'offline', 'expired', 'terminated', 'suspended', 'deleted', 'error', 'critical'].includes(status)) {
            return 'status-danger';
        }
        // Warning states
        if (['pending', 'in-progress', 'in_progress', 'waiting', 'processing', 'queued', 'draft', 'review', 'under-review', 'on-hold', 'onhold', 'delayed', 'partially-paid', 'partially_paid', 'partial'].includes(status)) {
            return 'status-warning';
        }
        // Info states
        if (['issued', 'scheduled', 'assigned', 'allocated', 'reserved', 'booked', 'acknowledged', 'notified', 'info'].includes(status)) {
            return 'status-info';
        }
        // Special states
        if (['urgent', 'emergency', 'high-priority', 'high_priority', 'priority'].includes(status)) {
            return 'status-urgent';
        }
        // Busy states
        if (['busy', 'working', 'occupied'].includes(status)) {
            return 'status-busy';
        }
        return 'status-neutral';
    }
    /**
     * Process column definitions to add menu column if needed
     *
     * This method:
     * 1. Checks if any column has cellRenderer: 'gridMenu'
     * 2. If menuActions exist in gridOptions but no menu column is configured, adds one automatically
     * 3. If a menu column exists, updates it with the proper cell renderer
     * 4. Auto-detects status columns and applies appropriate cell classes
     */
    processColumnDefs() {
        // Process columns and disable floating filters by default to match image (unless explicitly set)
        this.processedColumnDefs = this.columnDefs.map(col => {
            const field = col.field?.toLowerCase() || '';
            const isStatusColumn = field.includes('status') || field.includes('state');
            return {
                ...col,
                floatingFilter: col.floatingFilter ?? false,
                suppressHeaderMenuButton: col.suppressHeaderMenuButton ?? true,
                // Auto-add status cell class for status columns
                cellClass: isStatusColumn && !col.cellClass
                    ? 'status-cell'
                    : col.cellClass
            };
        });
        // Check if any column has cellRenderer: 'gridMenu' or if there's already an actions column
        const hasMenuColumn = this.processedColumnDefs.some(col => col.cellRenderer === 'gridMenu' ||
            col.cellRenderer === GridMenuRendererComponent ||
            (col.field === 'actions' && col.pinned === 'right'));
        const extendedGridOptions = this.gridOptions;
        if (!hasMenuColumn && extendedGridOptions.menuActions && extendedGridOptions.menuActions.length > 0) {
            // Add compact hover-only menu column if menuActions exist but no menu column is configured
            this.processedColumnDefs.push({
                headerName: '',
                field: 'actions',
                sortable: false,
                filter: false,
                width: 36,
                minWidth: 36,
                maxWidth: 36,
                suppressSizeToFit: true,
                resizable: false,
                pinned: 'right',
                cellClass: 'actions-cell',
                headerClass: 'actions-header-cell',
                cellRenderer: GridMenuRendererComponent,
                cellRendererParams: {
                    menuActions: extendedGridOptions.menuActions
                }
            });
        }
        else if (hasMenuColumn) {
            // Update existing menu column with cellRenderer
            this.processedColumnDefs = this.processedColumnDefs.map(col => {
                if (col.cellRenderer === 'gridMenu') {
                    return {
                        ...col,
                        cellRenderer: GridMenuRendererComponent,
                        cellRendererParams: {
                            menuActions: extendedGridOptions.menuActions
                        }
                    };
                }
                return col;
            });
        }
    }
    onSearchChange(value) {
        this.searchText = value;
        // Re-apply search on top of active advanced filters
        const base = this._activeFilters && this._activeFilters.length
            ? (this.rowData || []).filter(r => this._activeFilters.map(f => this.evaluateFilter(r, f)).reduce((acc, cur) => this._activeLogic === 'AND' ? acc && cur : acc || cur, this._activeLogic === 'AND'))
            : [...(this.rowData || [])];
        this.filteredRowData = this.applySearchTo(base);
        this.searchChange.emit(value);
    }
    applySearchTo(data) {
        if (!this.searchText || !this.searchText.trim())
            return data;
        const searchTerm = this.searchText.toLowerCase();
        return (data || []).filter(row => Object.values(row).some(value => value?.toString().toLowerCase().includes(searchTerm)));
    }
    onFilterClick() {
        const data = this.buildFilterDialogData();
        const ref = this.dialogbox.openDialog(FilterComponent, {
            title: 'Filter Grid',
            data,
            width: '900px'
        });
        ref.afterClosed().subscribe((result) => {
            if (result && result.filters) {
                this.applyAdvancedFilters(result.filters, result.logic || 'AND');
                this.activeFiltersCount = result.filters.length;
                this.updateFilterChips(result.filters);
            }
            else if (result === null) {
                // Dialog was cancelled or cleared
                this.activeFiltersCount = 0;
                this.activeFilterChips = [];
            }
        });
    }
    buildFilterDialogData() {
        const extendedGridOptions = this.gridOptions;
        const provided = extendedGridOptions.filterConfig || {};
        const fields = (provided.fields && provided.fields.length ? provided.fields : this.columnDefs
            .filter(col => !!col.field)
            .map(col => {
            return {
                label: col.headerName || col.field,
                value: col.field,
                inputType: this.detectInputType(col.field)
            };
        }));
        const valuesMap = { ...(provided.valuesMap || {}) };
        const operatorsMap = { ...(provided.operatorsMap || {}) };
        for (const fieldDef of fields) {
            if (fieldDef.inputType === 'select') {
                if (!valuesMap[fieldDef.value]) {
                    valuesMap[fieldDef.value] = this.getUniqueValues(fieldDef.value, 200);
                }
            }
            if (!operatorsMap[fieldDef.value]) {
                operatorsMap[fieldDef.value] = this.defaultOperatorsByType(fieldDef.inputType);
            }
        }
        const initialFilters = provided.initialFilters || this._activeFilters || [];
        const logic = provided.logic || this._activeLogic || 'AND';
        return { fields, valuesMap, operatorsMap, filters: initialFilters, logic };
    }
    detectInputType(field) {
        // Prefer select when unique values are small
        const uniques = this.getUniqueValues(field, 51);
        if (uniques.length > 0 && uniques.length <= 50) {
            return 'select';
        }
        const sample = this.rowData && this.rowData.length ? this.rowData[0][field] : undefined;
        if (typeof sample === 'number')
            return 'number';
        if (typeof sample === 'boolean')
            return 'boolean';
        if (this.looksLikeDate(sample))
            return 'date';
        return 'input';
    }
    looksLikeDate(value) {
        if (!value)
            return false;
        if (value instanceof Date)
            return true;
        const dt = new Date(value);
        return !isNaN(dt.getTime());
    }
    getUniqueValues(field, limit) {
        const set = new Set();
        for (const row of this.rowData || []) {
            set.add(row[field]);
            if (set.size >= limit)
                break;
        }
        return Array.from(set);
    }
    defaultOperatorsByType(type) {
        switch (type) {
            case 'number':
                return [
                    { label: 'Equals', value: 'eq' },
                    { label: 'Not Equals', value: 'neq' },
                    { label: 'Greater Than', value: 'gt' },
                    { label: 'Greater Or Equal', value: 'gte' },
                    { label: 'Less Than', value: 'lt' },
                    { label: 'Less Or Equal', value: 'lte' },
                    { label: 'Between', value: 'between' }
                ];
            case 'date':
                return [
                    { label: 'On', value: 'eq' },
                    { label: 'Before', value: 'lt' },
                    { label: 'After', value: 'gt' },
                    { label: 'Between', value: 'between' }
                ];
            case 'boolean':
                return [
                    { label: 'Is', value: 'eq' },
                    { label: 'Is Not', value: 'neq' }
                ];
            case 'select':
            case 'input':
            default:
                return [
                    { label: 'Contains', value: 'contains' },
                    { label: 'Equals', value: 'eq' },
                    { label: 'Not Equals', value: 'neq' },
                    { label: 'Starts With', value: 'startsWith' },
                    { label: 'Ends With', value: 'endsWith' },
                    { label: 'Is Empty', value: 'empty' },
                    { label: 'Is Not Empty', value: 'notEmpty' }
                ];
        }
    }
    updateFilterChips(filters) {
        this.activeFilterChips = filters.map(f => {
            const column = this.columnDefs.find(col => col.field === f.field);
            const label = column?.headerName || f.field;
            let value = f.value;
            if (f.inputType === 'boolean') {
                value = f.value === true || f.value === 'true' ? 'Yes' : 'No';
            }
            else if (f.inputType === 'date') {
                value = new Date(f.value).toLocaleDateString();
            }
            else if (f.operator === 'between' && f.valueTo !== undefined) {
                value = `${f.value} - ${f.valueTo}`;
            }
            return {
                label,
                value: String(value),
                field: f.field
            };
        });
    }
    removeFilterChip(field) {
        this._activeFilters = this._activeFilters.filter(f => f.field !== field);
        this.activeFiltersCount = this._activeFilters.length;
        this.activeFilterChips = this.activeFilterChips.filter(chip => chip.field !== field);
        if (this._activeFilters.length === 0) {
            this.filteredRowData = this.applySearchTo([...(this.rowData || [])]);
        }
        else {
            this.applyAdvancedFilters(this._activeFilters, this._activeLogic);
        }
    }
    applyAdvancedFilters(filters, logic) {
        this._activeFilters = filters;
        this._activeLogic = logic;
        if (!filters || filters.length === 0) {
            this.filteredRowData = this.applySearchTo([...(this.rowData || [])]);
            this.activeFilterChips = [];
            return;
        }
        const evaluator = (row) => {
            const results = filters.map(f => this.evaluateFilter(row, f));
            return logic === 'AND' ? results.every(Boolean) : results.some(Boolean);
        };
        const base = (this.rowData || []).filter(evaluator);
        this.filteredRowData = this.applySearchTo(base);
    }
    evaluateFilter(row, f) {
        const raw = row[f.field];
        const op = (f.operator || '').toLowerCase();
        const type = f.inputType;
        // Handle empty/notEmpty without touching values
        if (op === 'empty')
            return raw === undefined || raw === null || String(raw).trim() === '';
        if (op === 'notempty')
            return !(raw === undefined || raw === null || String(raw).trim() === '');
        if (type === 'number') {
            const a = Number(raw);
            const b = Number(f.value);
            const c = f.valueTo !== undefined ? Number(f.valueTo) : undefined;
            if (isNaN(a) || isNaN(b))
                return false;
            switch (op) {
                case 'eq': return a === b;
                case 'neq': return a !== b;
                case 'gt': return a > b;
                case 'gte': return a >= b;
                case 'lt': return a < b;
                case 'lte': return a <= b;
                case 'between': return c !== undefined && !isNaN(c) ? a >= Math.min(b, c) && a <= Math.max(b, c) : false;
                default: return false;
            }
        }
        if (type === 'date') {
            const a = this.toDate(raw);
            const b = this.toDate(f.value);
            const c = f.valueTo ? this.toDate(f.valueTo) : null;
            if (!a || !b)
                return false;
            switch (op) {
                case 'eq': return this.sameDay(a, b);
                case 'lt': return a.getTime() < b.getTime();
                case 'gt': return a.getTime() > b.getTime();
                case 'between': return !!c && a.getTime() >= Math.min(b.getTime(), c.getTime()) && a.getTime() <= Math.max(b.getTime(), c.getTime());
                default: return false;
            }
        }
        if (type === 'boolean') {
            const a = Boolean(raw);
            const b = f.value === true || f.value === 'true';
            switch (op) {
                case 'eq': return a === b;
                case 'neq': return a !== b;
                default: return false;
            }
        }
        // string/select
        const a = (raw ?? '').toString().toLowerCase();
        const b = (f.value ?? '').toString().toLowerCase();
        switch (op) {
            case 'eq': return a === b;
            case 'neq': return a !== b;
            case 'contains': return a.includes(b);
            case 'startswith': return a.startsWith(b);
            case 'endswith': return a.endsWith(b);
            default: return false;
        }
    }
    toDate(value) {
        if (!value)
            return null;
        if (value instanceof Date)
            return value;
        const d = new Date(value);
        return isNaN(d.getTime()) ? null : d;
    }
    sameDay(a, b) {
        return a.getFullYear() === b.getFullYear() && a.getMonth() === b.getMonth() && a.getDate() === b.getDate();
    }
    // New grid methods for enhanced functionality
    onRefresh() {
        // Emit refresh event or reload data
        this.filteredRowData = [...this.rowData];
        console.log('Grid refreshed');
    }
    onExport() {
        // Export grid data to CSV
        const csvContent = this.exportToCSV();
        this.downloadCSV(csvContent, 'grid-data.csv');
    }
    exportToCSV() {
        if (!this.filteredRowData || this.filteredRowData.length === 0) {
            return '';
        }
        // Get column headers
        const headers = this.processedColumnDefs
            .filter(col => col.field && col.field !== 'actions')
            .map(col => col.headerName || col.field);
        // Get data rows
        const rows = this.filteredRowData.map(item => this.processedColumnDefs
            .filter(col => col.field && col.field !== 'actions')
            .map(col => {
            const value = item[col.field];
            return typeof value === 'string' ? `"${value.replace(/"/g, '""')}"` : value;
        }));
        // Combine headers and rows
        const csvArray = [headers, ...rows];
        return csvArray.map(row => row.join(',')).join('\n');
    }
    downloadCSV(content, filename) {
        const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        if (link.download !== undefined) {
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }
    // View mode switching
    switchToListView() {
        this.viewMode = 'list';
    }
    switchToCardView() {
        this.viewMode = 'card';
    }
    toggleViewMode() {
        this.viewMode = this.viewMode === 'list' ? 'card' : 'list';
    }
    onRowClicked(event) {
        if (!event || !event.data)
            return;
        // If rowSelection is enabled, programmatically select the row
        if (this.gridOptions.rowSelection && this.gridApi && event.node) {
            if (this.gridOptions.rowSelection === 'single') {
                // Deselect all rows first for single selection
                this.gridApi.deselectAll();
            }
            // Toggle selection on the clicked row
            event.node.setSelected(true);
        }
        this.rowClicked.emit(event.data);
    }
    ngOnDestroy() {
        if (this.dataFetchSub) {
            this.dataFetchSub.unsubscribe();
        }
    }
    shouldFetchFromApi() {
        return (!this.rowData || this.rowData.length === 0) && !!this.apiConfig?.dataConfig;
    }
    fetchGridDataFromApi() {
        if (!this.apiConfig?.dataConfig) {
            return;
        }
        const limits = this.getPaginationLimits();
        const dataRequest$ = this.sendApiRequest(this.apiConfig.dataConfig, limits)
            .pipe(catchError(() => of({})));
        const countRequest$ = this.apiConfig.countConfig
            ? this.sendApiRequest(this.apiConfig.countConfig, limits).pipe(catchError(() => of({})))
            : of(null);
        if (this.dataFetchSub) {
            this.dataFetchSub.unsubscribe();
        }
        this.dataFetchSub = forkJoin({ data: dataRequest$, count: countRequest$ }).subscribe((response) => {
            const rows = this.extractDataArray(response.data);
            const count = this.extractCount(response.count);
            this.applyFetchedData(rows, count);
        });
    }
    sendApiRequest(config, limits) {
        const url = this.appendQueryParams(this.buildUrl(config.url), config, limits);
        const method = (config.requestType || 'GET').toUpperCase();
        if (method === 'POST') {
            const payload = this.buildPayload(config, limits);
            return this.http.post(url, payload);
        }
        const params = this.buildHttpParams(config, limits);
        return this.http.get(url, { params });
    }
    buildPayload(config, limits) {
        const payload = {
            ...(config.params || {})
        };
        if (limits) {
            const lowerKey = config.lLimitKey || 'llimit';
            const upperKey = config.uLimitKey || 'ulimit';
            payload[lowerKey] = limits.lower;
            payload[upperKey] = limits.upper;
        }
        return config.suppressNullValues ? this.stripNullish(payload) : payload;
    }
    buildHttpParams(config, limits) {
        const params = {
            ...(config.params || {})
        };
        if (limits) {
            const lowerKey = config.lLimitKey || 'llimit';
            const upperKey = config.uLimitKey || 'ulimit';
            params[lowerKey] = limits.lower;
            params[upperKey] = limits.upper;
        }
        const cleaned = config.suppressNullValues ? this.stripNullish(params) : params;
        let httpParams = new HttpParams();
        Object.entries(cleaned).forEach(([key, value]) => {
            if (value !== undefined && value !== null) {
                httpParams = httpParams.append(key, String(value));
            }
        });
        return httpParams;
    }
    stripNullish(obj) {
        return Object.entries(obj).reduce((acc, [key, value]) => {
            if (value !== null && value !== undefined) {
                acc[key] = value;
            }
            return acc;
        }, {});
    }
    appendQueryParams(url, config, limits) {
        if (!config.queryParamsUrl) {
            return url;
        }
        const lower = limits?.lower ?? '';
        const upper = limits?.upper ?? '';
        const query = config.queryParamsUrl
            .replace(/\$llimit/gi, String(lower))
            .replace(/\$ulimit/gi, String(upper));
        if (!query) {
            return url;
        }
        const separator = url.includes('?') ? '&' : '?';
        return `${url}${separator}${query}`;
    }
    buildUrl(path) {
        const base = this.apiConfigService.getApiUrl();
        if (!base) {
            return path;
        }
        return `${base.replace(/\/$/, '')}/${path.replace(/^\//, '')}`;
    }
    extractDataArray(response) {
        if (!response)
            return [];
        const casted = response;
        return casted.data || casted.result || casted.records || casted.items || [];
    }
    extractCount(response) {
        if (!response)
            return undefined;
        const casted = response;
        return casted.count ?? casted.totalCount ?? casted.total;
    }
    applyFetchedData(rows, totalCount) {
        this.rowData = Array.isArray(rows) ? rows : [];
        this.filteredRowData = this.applySearchTo([...this.rowData]);
        this.totalRows = totalCount ?? this.rowData.length;
        this.displayedRows = this.filteredRowData.length;
        this.processColumnDefs();
        this.updatePaginationInfo();
    }
    getPaginationLimits() {
        const pageSize = this.gridOptions.paginationPageSize || 25;
        const lower = 0;
        const upper = lower + pageSize;
        return { lower, upper };
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: GridComponent, deps: [{ token: i1.DialogboxService }, { token: PLATFORM_ID }, { token: i2.ApiConfigService }, { token: i3.HttpClient }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.12", type: GridComponent, isStandalone: true, selector: "app-grid", inputs: { rowData: "rowData", columnDefs: "columnDefs", gridOptions: "gridOptions", domLayout: "domLayout", animateRows: "animateRows", class: "class", height: "height", width: "width", showHeader: "showHeader", searchPlaceholder: "searchPlaceholder", rightTooltemplateRef: "rightTooltemplateRef", cardTemplate: "cardTemplate", defaultViewMode: "defaultViewMode", showAddButton: "showAddButton", apiConfig: "apiConfig" }, outputs: { searchChange: "searchChange", rowClicked: "rowClicked", addClick: "addClick" }, usesOnChanges: true, ngImport: i0, template: "<div class=\"grid-container\">\n  <!-- Clean Grid Toolbar -->\n  <div class=\"grid-toolbar\" *ngIf=\"showHeader\">\n    <div class=\"toolbar-left\">\n      <span class=\"pagination-info\">Displaying {{ displayedRows }} of {{ totalRows }}</span>\n      \n      <!-- Filter Chips -->\n      <div class=\"filter-chips\" *ngIf=\"activeFilterChips.length > 0\">\n        <div class=\"filter-chip\" *ngFor=\"let chip of activeFilterChips\">\n          <span class=\"chip-label\">{{ chip.label }}:</span>\n          <span class=\"chip-value\">{{ chip.value }}</span>\n          <button type=\"button\" class=\"chip-remove\" (click)=\"removeFilterChip(chip.field)\" title=\"Remove filter\" aria-label=\"Remove filter\">\u00D7</button>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"toolbar-center\">\n      <div class=\"search-section\">\n        <app-input\n          [placeholder]=\"searchPlaceholder\"\n          [value]=\"searchText\"\n          [prefixIconName]=\"'search'\"\n          (valueChange)=\"onSearchChange($event)\"\n          [search]=\"true\"\n          class=\"search-input\">\n        </app-input>\n      </div>\n    </div>\n    \n    <div class=\"toolbar-right\">\n      <div class=\"action-icons\">\n        <ng-container *ngTemplateOutlet=\"rightTooltemplateRef\"></ng-container>\n\n        <!-- Only keep Filter icon for now -->\n        <button\n          class=\"icon-btn filter-btn\"\n          (click)=\"onFilterClick()\"\n          title=\"Filter\"\n          [class.active]=\"activeFiltersCount > 0\">\n          <mat-icon>tune</mat-icon>\n        </button>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Grid Content -->\n  <div class=\"grid-content\">\n    <div class=\"grid-wrapper\">\n      <!-- List View (AG-Grid) -->\n      <ag-grid-angular\n        *ngIf=\"isBrowser && viewMode === 'list'\"\n        [rowData]=\"filteredRowData\"\n        class=\"clean-grid ag-theme-clean\"\n        [columnDefs]=\"processedColumnDefs\"\n        [gridOptions]=\"gridOptions\"\n        [domLayout]=\"domLayout\"\n        [animateRows]=\"animateRows\"\n        [class]=\"class\"\n        [class.has-row-selection]=\"gridOptions.rowSelection\"\n        [style.width]=\"width\"\n        [style.height]=\"'100%'\"\n        (gridReady)=\"onGridReady($event)\"\n        (modelUpdated)=\"onModelUpdated($event)\"\n        (rowClicked)=\"onRowClicked($event)\">\n      </ag-grid-angular>\n\n      <!-- Card View (Custom Template) -->\n      <div class=\"card-grid\" *ngIf=\"isBrowser && viewMode === 'card' && cardTemplate\">\n        <ng-container *ngFor=\"let item of filteredRowData\">\n          <ng-container *ngTemplateOutlet=\"cardTemplate; context: { $implicit: item }\"></ng-container>\n        </ng-container>\n      </div>\n      \n      <!-- Loading State -->\n      <div class=\"grid-loading\" *ngIf=\"!isBrowser\">\n        <div class=\"loading-spinner\"></div>\n        <span>Loading grid...</span>\n      </div>\n    </div>\n  </div>\n</div>\n", styles: [".grid-container{display:flex;flex-direction:column;height:100%;width:100%;background:var(--page-background-color);border-radius:var(--input-radius);overflow:hidden;box-shadow:var(--primary-shadow)}.grid-container ::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}.grid-toolbar{min-height:4em;display:flex;align-items:center;justify-content:space-between;padding:.75em 1.25em;background:var(--surface-color);border-bottom:1px solid var(--primary-border);border-radius:var(--input-radius) var(--input-radius) 0 0;box-shadow:inset 0 -1px #18b6b21a;gap:1.25em;flex-wrap:wrap}.toolbar-left{display:flex;align-items:center;gap:1em;min-width:0}.toolbar-left .pagination-info{display:inline-flex;align-items:center;padding:6px 12px;background:#18b6b214;border-radius:999px;color:var(--primary-color);font-weight:var(--secondary-font-weight);font-size:calc(var(--tertiary-font-size) - 1px);letter-spacing:.015em}.toolbar-left .filter-chips{display:flex;align-items:center;flex-wrap:wrap;gap:8px;max-width:clamp(200px,30vw,450px);padding-left:4px}.toolbar-left .filter-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:#18b6b21f;border:1px solid rgba(24,182,178,.35);border-radius:999px;color:var(--primary-font-color);font-size:calc(var(--tertiary-font-size) - 1px);transition:all .2s ease}.toolbar-left .filter-chip .chip-label{font-weight:600;color:var(--primary-color)}.toolbar-left .filter-chip .chip-value{font-weight:var(--secondary-font-weight);max-width:130px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.toolbar-left .filter-chip:hover{background:#18b6b22e;border-color:#18b6b28c;box-shadow:0 8px 16px -12px #18b6b2d9;transform:translateY(-1px)}.toolbar-left .filter-chip .chip-remove{width:18px;height:18px;border-radius:50%;background:#ffffffd9;border:none;color:var(--primary-color);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:12px;line-height:1;padding:0;transition:all .2s ease}.toolbar-left .filter-chip .chip-remove:hover{background:var(--primary-color);color:var(--surface-color);box-shadow:0 4px 10px -6px var(--primary-color)}.toolbar-center{flex:1;display:flex;justify-content:flex-start;max-width:400px}.toolbar-center .search-section{width:100%;max-width:320px}.toolbar-center .search-section .search-input{width:100%}.toolbar-center .search-section .search-input ::ng-deep .app-input-container{box-shadow:var(--primary-shadow);border:1px solid var(--primary-border);transition:all .3s ease}.toolbar-center .search-section .search-input ::ng-deep .app-input-container:focus-within{border-color:var(--primary-color);box-shadow:0 0 0 3px #18b6b21a}.toolbar-right{flex:0 0 auto}.toolbar-right .action-icons{display:flex;align-items:center;gap:12px;background:#18b6b20f;border-radius:999px;padding:6px 10px}.icon-btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;width:40px;height:40px;border:1px solid var(--primary-border);border-radius:50%;background:var(--surface-color);color:var(--primary-font-color);font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);cursor:pointer;transition:all .3s ease;position:relative;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.icon-btn:hover{background:var(--secondary-background-color);border-color:var(--primary-color);transform:translateY(-1px);box-shadow:var(--primary-shadow)}.icon-btn:active{transform:translateY(0);box-shadow:0 2px 4px #0000001a}.icon-btn:focus-visible{outline:2px solid rgba(24,182,178,.4);outline-offset:2px}.icon-btn.add-btn{background:linear-gradient(135deg,var(--primary-color),var(--tertiary-color));color:var(--surface-color);border-color:transparent;box-shadow:0 10px 18px -15px #18b6b2d9}.icon-btn.add-btn:hover{border-color:transparent;box-shadow:0 16px 28px -18px #18b6b2f2}.icon-btn.settings-btn{background:#18b6b214;border-color:#18b6b240}.icon-btn.settings-btn:hover{background:#18b6b229;border-color:var(--primary-color);color:var(--primary-color)}.icon-btn.refresh-btn:hover,.icon-btn.export-btn:hover{background:var(--secondary-background-color);border-color:var(--tertiary-color);color:var(--primary-font-color)}.icon-btn.filter-btn.active,.icon-btn.filter-btn:hover{background:var(--diet-quinary-color);border-color:var(--primary-color);color:var(--primary-color)}.icon-btn.filter-btn .filter-badge{position:absolute;top:-8px;right:-8px;background:var(--diet-secondary-color);color:var(--surface-color);border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;border:2px solid var(--surface-color)}.grid-content{height:calc(100% - 4em);flex:1;display:flex;flex-direction:column;overflow:hidden;background:linear-gradient(160deg,#18b6b20d,#1c324605)}.grid-wrapper{flex:1;position:relative;overflow:hidden;height:100%;background:var(--surface-color);border-radius:calc(var(--input-radius) + 2px);box-shadow:0 24px 48px -32px #0f172a8c;border:1px solid rgba(24,182,178,.08)}.grid-wrapper:after{content:\"\";position:absolute;inset:0;pointer-events:none;background:linear-gradient(180deg,#18b6b212,#18b6b200 40%);opacity:.6}@media (max-width: 960px){.grid-toolbar{padding:.75em;gap:.75em}.toolbar-left{flex:1 1 100%;justify-content:space-between}.toolbar-center{order:3;flex-basis:100%;margin-top:.75em}.toolbar-right{margin-left:auto}}@media (max-width: 640px){.toolbar-left{flex-direction:column;align-items:flex-start;gap:.5em}.toolbar-left .pagination-info{width:100%;justify-content:center}.toolbar-left .filter-chips{max-width:100%}.icon-btn{width:36px;height:36px}}::ng-deep .status-chip{display:inline-flex;align-items:center;justify-content:center;padding:6px 12px;border-radius:var(--button-radius);border:1px solid;font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);line-height:1.4;white-space:nowrap;min-width:80px;text-transform:capitalize}::ng-deep .status-success{background:var(--status-success-bg);color:var(--status-success-color);border-color:var(--status-success-border)}::ng-deep .status-warning{background:var(--status-warning-bg);color:var(--status-warning-color);border-color:var(--status-warning-border)}::ng-deep .status-danger{background:var(--status-danger-bg);color:var(--status-danger-color);border-color:var(--status-danger-border)}::ng-deep .status-info{background:var(--status-info-bg);color:var(--status-info-color);border-color:var(--status-info-border)}::ng-deep .status-neutral{background:var(--status-neutral-bg);color:var(--status-neutral-color);border-color:var(--status-neutral-border)}::ng-deep .status-available{background:var(--status-available-bg);color:var(--status-available-color);border-color:var(--status-available-border)}::ng-deep .status-unavailable{background:var(--status-unavailable-bg);color:var(--status-unavailable-color);border-color:var(--status-unavailable-border)}::ng-deep .status-busy{background:var(--status-busy-bg);color:var(--status-busy-color);border-color:var(--status-busy-border)}::ng-deep .status-offline{background:var(--status-offline-bg);color:var(--status-offline-color);border-color:var(--status-offline-border)}::ng-deep .actions-header-cell{padding:0!important}::ng-deep .actions-cell{padding:0!important;display:flex;align-items:center;justify-content:center;position:relative}::ng-deep .ag-row.ag-row-hover .actions-cell:after,::ng-deep .ag-row.ag-row-selected .actions-cell:after{content:\"\";position:absolute;right:0;top:0;bottom:0;width:4px;background:var(--primary-color)}.grid-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;color:var(--secondary-font-color);gap:16px}.grid-loading .loading-spinner{width:32px;height:32px;border:3px solid var(--primary-border);border-top:3px solid var(--primary-color);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.grid-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:400px;padding:40px;text-align:center;color:var(--secondary-font-color)}.grid-empty .empty-icon{margin-bottom:16px;opacity:.6}.grid-empty h4{margin:0 0 8px;font-size:var(--primary-font-size);font-weight:var(--primary-font-weight);color:var(--primary-font-color)}.grid-empty p{margin:0 0 24px;font-size:var(--tertiary-font-size);color:var(--secondary-font-color);max-width:300px;line-height:1.5}.grid-empty .empty-action-btn{display:flex;align-items:center;gap:8px;padding:12px 20px;border:1px solid var(--primary-color);border-radius:var(--button-radius);background:var(--primary-color);color:var(--surface-color);font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);cursor:pointer;transition:all .3s ease}.grid-empty .empty-action-btn:hover{background:var(--primary-color);transform:translateY(-1px);box-shadow:var(--primary-shadow)}::ng-deep .ag-row-focus{background:var(--secondary-background-color)!important;border-left:3px solid var(--primary-color)!important}::ng-deep .clean-grid.ag-theme-clean{--ag-background-color: var(--surface-color);--ag-foreground-color: var(--primary-font-color);--ag-border-color: var(--primary-border);--ag-header-background-color: var(--page-background-color);--ag-header-foreground-color: var(--primary-font-color);--ag-odd-row-background-color: var(--surface-color);--ag-row-hover-color: var(--secondary-background-color);--ag-selected-row-background-color: rgba(24, 182, 178, .1);--ag-range-selection-background-color: rgba(24, 182, 178, .2);--ag-header-height: 56px;--ag-row-height: 52px;--ag-grid-size: 4px;--ag-icon-size: 16px;--ag-font-size: var(--tertiary-font-size);--ag-font-family: inherit;border:none!important;border-radius:0 0 var(--input-radius) var(--input-radius);box-shadow:none!important}::ng-deep .clean-grid .ag-header{background:linear-gradient(180deg,var(--page-background-color) 0%,var(--secondary-background-color) 100%);border-bottom:2px solid var(--primary-border);font-weight:var(--primary-font-weight)}::ng-deep .clean-grid .ag-header .ag-header-cell{border-right:1px solid var(--primary-border);padding:0 16px}::ng-deep .clean-grid .ag-header .ag-header-cell .ag-header-cell-label{font-weight:var(--primary-font-weight);color:var(--primary-font-color);font-size:var(--tertiary-font-size)}::ng-deep .clean-grid .ag-header .ag-header-cell:hover{background:#18b6b20d}::ng-deep .clean-grid .ag-header .ag-header-cell-resize{background:var(--primary-color);width:2px;opacity:.6}::ng-deep .clean-grid .ag-row{border-bottom:1px solid var(--primary-border);transition:all .2s ease}::ng-deep .clean-grid .ag-row:hover{background:var(--page-background-color)!important;box-shadow:inset 4px 0 0 var(--primary-color)}::ng-deep .clean-grid .ag-row.ag-row-selected{background:#18b6b214!important;border-color:var(--primary-color)}::ng-deep .clean-grid .ag-row:last-child{border-bottom:none}::ng-deep .clean-grid.has-row-selection .ag-row{cursor:pointer}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected{background:#18b6b226!important;border-left:4px solid var(--primary-color)!important;box-shadow:inset 0 0 0 1px #18b6b233,0 2px 8px #18b6b21a!important}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected .ag-cell{background-color:transparent!important;font-weight:var(--secondary-font-weight)}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected:hover{background:#18b6b22e!important;box-shadow:inset 0 0 0 1px #18b6b24d,0 4px 12px #18b6b226!important}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-focus.ag-row-selected{background:#18b6b226!important;border-left:4px solid var(--primary-color)!important}::ng-deep .clean-grid .ag-cell{display:flex!important;align-items:center!important;padding:0 16px;border-right:1px solid transparent;color:var(--primary-font-color);font-size:var(--tertiary-font-size);line-height:1.4}::ng-deep .clean-grid .ag-cell:focus{border:2px solid var(--primary-color)!important;outline:none;border-radius:4px}::ng-deep .clean-grid .ag-cell .ag-cell-value{display:flex!important;align-items:center!important;width:100%}::ng-deep .clean-grid .ag-center-cols-viewport{background:var(--surface-color)}::ng-deep .clean-grid .ag-root-wrapper,::ng-deep .clean-grid .ag-root-wrapper.ag-layout-auto-height.ag-ltr,::ng-deep .clean-grid .ag-root-wrapper-body{height:100%;border:none!important;box-shadow:none!important}::ng-deep .clean-grid .ag-body-viewport{overflow-y:scroll}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar{width:8px;height:8px}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-track{background:var(--secondary-background-color);border-radius:4px}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-thumb{background:var(--tertiary-color);border-radius:4px;transition:background .3s ease}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-thumb:hover{background:var(--primary-color)}::ng-deep .clean-grid .ag-overlay-loading-wrapper{background:#ffffffe6;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}::ng-deep .clean-grid .ag-overlay-no-rows-wrapper{background:transparent}::ng-deep .clean-grid .ag-header-icon{color:var(--primary-color)}::ng-deep .clean-grid .ag-header-cell-filtered{background:#18b6b21a}::ng-deep .clean-grid .ag-header-cell-filtered .ag-header-cell-label{color:var(--primary-color);font-weight:600}::ng-deep .clean-grid .ag-selection-checkbox .ag-input-wrapper{background:var(--surface-color);border:2px solid var(--primary-border);border-radius:4px}::ng-deep .clean-grid .ag-selection-checkbox .ag-input-wrapper:after{color:var(--primary-color)}::ng-deep .clean-grid .ag-selection-checkbox input:checked+.ag-input-wrapper{background:var(--primary-color);border-color:var(--primary-color)}::ng-deep .clean-grid .ag-pinned-left-cols-container,::ng-deep .clean-grid .ag-pinned-right-cols-container,::ng-deep .clean-grid .ag-pinned-left-header,::ng-deep .clean-grid .ag-pinned-right-header{box-shadow:none!important}::ng-deep .clean-grid .ag-pinned-left-cols-container,::ng-deep .clean-grid .ag-pinned-left-header{border-right:none!important}::ng-deep .clean-grid .ag-pinned-right-cols-container,::ng-deep .clean-grid .ag-pinned-right-header{border-left:none!important}::ng-deep .clean-grid .clean-grid.ag-theme-clean .ag-cell.ag-cell-first-right-pinned{border-left:none!important}::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}::ng-deep .mat-mdc-tab-body-content{overflow:hidden!important}@media print{:host{background:none!important}.grid-toolbar,.grid-content,.grid-wrapper{background:#fff!important;box-shadow:none!important}.grid-wrapper:after{display:none!important}}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i4.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "ngmodule", type: AgGridModule }, { kind: "component", type: i5.AgGridAngular, selector: "ag-grid-angular", inputs: ["gridOptions", "modules", "statusBar", "sideBar", "suppressContextMenu", "preventDefaultOnContextMenu", "allowContextMenuWithControlKey", "columnMenu", "suppressMenuHide", "enableBrowserTooltips", "tooltipTrigger", "tooltipShowDelay", "tooltipHideDelay", "tooltipMouseTrack", "tooltipShowMode", "tooltipInteraction", "popupParent", "copyHeadersToClipboard", "copyGroupHeadersToClipboard", "clipboardDelimiter", "suppressCopyRowsToClipboard", "suppressCopySingleCellRanges", "suppressLastEmptyLineOnPaste", "suppressClipboardPaste", "suppressClipboardApi", "suppressCutToClipboard", "columnDefs", "defaultColDef", "defaultColGroupDef", "columnTypes", "dataTypeDefinitions", "maintainColumnOrder", "enableStrictPivotColumnOrder", "suppressFieldDotNotation", "headerHeight", "groupHeaderHeight", "floatingFiltersHeight", "pivotHeaderHeight", "pivotGroupHeaderHeight", "hidePaddedHeaderRows", "allowDragFromColumnsToolPanel", "suppressMovableColumns", "suppressColumnMoveAnimation", "suppressMoveWhenColumnDragging", "suppressDragLeaveHidesColumns", "suppressGroupChangesColumnVisibility", "suppressMakeColumnVisibleAfterUnGroup", "suppressRowGroupHidesColumns", "colResizeDefault", "suppressAutoSize", "autoSizePadding", "skipHeaderOnAutoSize", "autoSizeStrategy", "components", "editType", "suppressStartEditOnTab", "getFullRowEditValidationErrors", "invalidEditValueMode", "singleClickEdit", "suppressClickEdit", "readOnlyEdit", "stopEditingWhenCellsLoseFocus", "enterNavigatesVertically", "enterNavigatesVerticallyAfterEdit", "enableCellEditingOnBackspace", "undoRedoCellEditing", "undoRedoCellEditingLimit", "defaultCsvExportParams", "suppressCsvExport", "defaultExcelExportParams", "suppressExcelExport", "excelStyles", "findSearchValue", "findOptions", "quickFilterText", "cacheQuickFilter", "includeHiddenColumnsInQuickFilter", "quickFilterParser", "quickFilterMatcher", "applyQuickFilterBeforePivotOrAgg", "excludeChildrenWhenTreeDataFiltering", "enableAdvancedFilter", "alwaysPassFilter", "includeHiddenColumnsInAdvancedFilter", "advancedFilterParent", "advancedFilterBuilderParams", "advancedFilterParams", "suppressAdvancedFilterEval", "suppressSetFilterByDefault", "enableFilterHandlers", "filterHandlers", "enableCharts", "chartThemes", "customChartThemes", "chartThemeOverrides", "chartToolPanelsDef", "chartMenuItems", "loadingCellRenderer", "loadingCellRendererParams", "loadingCellRendererSelector", "localeText", "masterDetail", "keepDetailRows", "keepDetailRowsCount", "detailCellRenderer", "detailCellRendererParams", "detailRowHeight", "detailRowAutoHeight", "context", "alignedGrids", "tabIndex", "rowBuffer", "valueCache", "valueCacheNeverExpires", "enableCellExpressions", "suppressTouch", "suppressFocusAfterRefresh", "suppressBrowserResizeObserver", "suppressPropertyNamesCheck", "suppressChangeDetection", "debug", "loading", "overlayLoadingTemplate", "loadingOverlayComponent", "loadingOverlayComponentParams", "suppressLoadingOverlay", "overlayNoRowsTemplate", "noRowsOverlayComponent", "noRowsOverlayComponentParams", "suppressNoRowsOverlay", "pagination", "paginationPageSize", "paginationPageSizeSelector", "paginationAutoPageSize", "paginateChildRows", "suppressPaginationPanel", "pivotMode", "pivotPanelShow", "pivotMaxGeneratedColumns", "pivotDefaultExpanded", "pivotColumnGroupTotals", "pivotRowTotals", "pivotSuppressAutoColumn", "suppressExpandablePivotGroups", "functionsReadOnly", "aggFuncs", "suppressAggFuncInHeader", "alwaysAggregateAtRootLevel", "aggregateOnlyChangedColumns", "suppressAggFilteredOnly", "removePivotHeaderRowWhenSingleValueColumn", "animateRows", "cellFlashDuration", "cellFadeDuration", "allowShowChangeAfterFilter", "domLayout", "ensureDomOrder", "enableCellSpan", "enableRtl", "suppressColumnVirtualisation", "suppressMaxRenderedRowRestriction", "suppressRowVirtualisation", "rowDragManaged", "rowDragInsertDelay", "suppressRowDrag", "suppressMoveWhenRowDragging", "rowDragEntireRow", "rowDragMultiRow", "rowDragText", "dragAndDropImageComponent", "dragAndDropImageComponentParams", "fullWidthCellRenderer", "fullWidthCellRendererParams", "embedFullWidthRows", "groupDisplayType", "groupDefaultExpanded", "autoGroupColumnDef", "groupMaintainOrder", "groupSelectsChildren", "groupLockGroupColumns", "groupAggFiltering", "groupTotalRow", "grandTotalRow", "suppressStickyTotalRow", "groupSuppressBlankHeader", "groupSelectsFiltered", "showOpenedGroup", "groupHideParentOfSingleChild", "groupRemoveSingleChildren", "groupRemoveLowestSingleChildren", "groupHideOpenParents", "groupAllowUnbalanced", "rowGroupPanelShow", "groupRowRenderer", "groupRowRendererParams", "treeData", "treeDataChildrenField", "treeDataParentIdField", "rowGroupPanelSuppressSort", "suppressGroupRowsSticky", "groupHierarchyConfig", "pinnedTopRowData", "pinnedBottomRowData", "enableRowPinning", "isRowPinnable", "isRowPinned", "rowModelType", "rowData", "asyncTransactionWaitMillis", "suppressModelUpdateAfterUpdateTransaction", "datasource", "cacheOverflowSize", "infiniteInitialRowCount", "serverSideInitialRowCount", "suppressServerSideFullWidthLoadingRow", "cacheBlockSize", "maxBlocksInCache", "maxConcurrentDatasourceRequests", "blockLoadDebounceMillis", "purgeClosedRowNodes", "serverSideDatasource", "serverSideSortAllLevels", "serverSideEnableClientSideSort", "serverSideOnlyRefreshFilteredGroups", "serverSidePivotResultFieldSeparator", "viewportDatasource", "viewportRowModelPageSize", "viewportRowModelBufferSize", "alwaysShowHorizontalScroll", "alwaysShowVerticalScroll", "debounceVerticalScrollbar", "suppressHorizontalScroll", "suppressScrollOnNewData", "suppressScrollWhenPopupsAreOpen", "suppressAnimationFrame", "suppressMiddleClickScrolls", "suppressPreventDefaultOnMouseWheel", "scrollbarWidth", "rowSelection", "cellSelection", "rowMultiSelectWithClick", "suppressRowDeselection", "suppressRowClickSelection", "suppressCellFocus", "suppressHeaderFocus", "selectionColumnDef", "rowNumbers", "suppressMultiRangeSelection", "enableCellTextSelection", "enableRangeSelection", "enableRangeHandle", "enableFillHandle", "fillHandleDirection", "suppressClearOnFillReduction", "sortingOrder", "accentedSort", "unSortIcon", "suppressMultiSort", "alwaysMultiSort", "multiSortKey", "suppressMaintainUnsortedOrder", "icons", "rowHeight", "rowStyle", "rowClass", "rowClassRules", "suppressRowHoverHighlight", "suppressRowTransform", "columnHoverHighlight", "gridId", "deltaSort", "treeDataDisplayType", "enableGroupEdit", "initialState", "theme", "loadThemeGoogleFonts", "themeCssLayer", "styleNonce", "themeStyleContainer", "getContextMenuItems", "getMainMenuItems", "postProcessPopup", "processUnpinnedColumns", "processCellForClipboard", "processHeaderForClipboard", "processGroupHeaderForClipboard", "processCellFromClipboard", "sendToClipboard", "processDataFromClipboard", "isExternalFilterPresent", "doesExternalFilterPass", "getChartToolbarItems", "createChartContainer", "focusGridInnerElement", "navigateToNextHeader", "tabToNextHeader", "navigateToNextCell", "tabToNextCell", "getLocaleText", "getDocument", "paginationNumberFormatter", "getGroupRowAgg", "isGroupOpenByDefault", "ssrmExpandAllAffectsAllRows", "initialGroupOrderComparator", "processPivotResultColDef", "processPivotResultColGroupDef", "getDataPath", "getChildCount", "getServerSideGroupLevelParams", "isServerSideGroupOpenByDefault", "isApplyServerSideTransaction", "isServerSideGroup", "getServerSideGroupKey", "getBusinessKeyForNode", "getRowId", "resetRowDataOnUpdate", "processRowPostCreate", "isRowSelectable", "isRowMaster", "fillOperation", "postSortRows", "getRowStyle", "getRowClass", "getRowHeight", "isFullWidthRow", "isRowValidDropPosition"], outputs: ["toolPanelVisibleChanged", "toolPanelSizeChanged", "columnMenuVisibleChanged", "contextMenuVisibleChanged", "cutStart", "cutEnd", "pasteStart", "pasteEnd", "columnVisible", "columnPinned", "columnResized", "columnMoved", "columnValueChanged", "columnPivotModeChanged", "columnPivotChanged", "columnGroupOpened", "newColumnsLoaded", "gridColumnsChanged", "displayedColumnsChanged", "virtualColumnsChanged", "columnEverythingChanged", "columnsReset", "columnHeaderMouseOver", "columnHeaderMouseLeave", "columnHeaderClicked", "columnHeaderContextMenu", "componentStateChanged", "cellValueChanged", "cellEditRequest", "rowValueChanged", "cellEditingStarted", "cellEditingStopped", "rowEditingStarted", "rowEditingStopped", "bulkEditingStarted", "bulkEditingStopped", "batchEditingStarted", "batchEditingStopped", "undoStarted", "undoEnded", "redoStarted", "redoEnded", "cellSelectionDeleteStart", "cellSelectionDeleteEnd", "rangeDeleteStart", "rangeDeleteEnd", "fillStart", "fillEnd", "filterOpened", "filterChanged", "filterModified", "filterUiChanged", "floatingFilterUiChanged", "advancedFilterBuilderVisibleChanged", "findChanged", "chartCreated", "chartRangeSelectionChanged", "chartOptionsChanged", "chartDestroyed", "cellKeyDown", "gridReady", "firstDataRendered", "gridSizeChanged", "modelUpdated", "virtualRowRemoved", "viewportChanged", "bodyScroll", "bodyScrollEnd", "dragStarted", "dragStopped", "dragCancelled", "stateUpdated", "paginationChanged", "rowDragEnter", "rowDragMove", "rowDragLeave", "rowDragEnd", "rowDragCancel", "rowResizeStarted", "rowResizeEnded", "columnRowGroupChanged", "rowGroupOpened", "expandOrCollapseAll", "pivotMaxColumnsExceeded", "pinnedRowDataChanged", "pinnedRowsChanged", "rowDataUpdated", "asyncTransactionsFlushed", "storeRefreshed", "headerFocused", "cellClicked", "cellDoubleClicked", "cellFocused", "cellMouseOver", "cellMouseOut", "cellMouseDown", "rowClicked", "rowDoubleClicked", "rowSelected", "selectionChanged", "cellContextMenu", "rangeSelectionChanged", "cellSelectionChanged", "tooltipShow", "tooltipHide", "sortChanged"] }, { kind: "component", type: AppInputComponent, selector: "app-input", inputs: ["type", "placeholder", "value", "disabled", "required", "appearance", "label", "errorMessage", "multiline", "rows", "prefixIconName", "prefixIconSize", "suffixIconName", "suffixIconSize", "search", "searchUrl"], outputs: ["valueChange", "searchResults"] }, { kind: "ngmodule", type: HttpClientModule }, { kind: "ngmodule", type: MatMenuModule }, { kind: "ngmodule", type: MatIconModule }, { kind: "component", type: i6.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "ngmodule", type: MatButtonModule }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.12", ngImport: i0, type: GridComponent, decorators: [{
            type: Component,
            args: [{ selector: 'app-grid', standalone: true, imports: [
                        CommonModule,
                        AgGridModule,
                        AppInputComponent,
                        GridMenuRendererComponent,
                        IconComponent,
                        HttpClientModule,
                        MatMenuModule,
                        MatIconModule,
                        MatButtonModule
                    ], template: "<div class=\"grid-container\">\n  <!-- Clean Grid Toolbar -->\n  <div class=\"grid-toolbar\" *ngIf=\"showHeader\">\n    <div class=\"toolbar-left\">\n      <span class=\"pagination-info\">Displaying {{ displayedRows }} of {{ totalRows }}</span>\n      \n      <!-- Filter Chips -->\n      <div class=\"filter-chips\" *ngIf=\"activeFilterChips.length > 0\">\n        <div class=\"filter-chip\" *ngFor=\"let chip of activeFilterChips\">\n          <span class=\"chip-label\">{{ chip.label }}:</span>\n          <span class=\"chip-value\">{{ chip.value }}</span>\n          <button type=\"button\" class=\"chip-remove\" (click)=\"removeFilterChip(chip.field)\" title=\"Remove filter\" aria-label=\"Remove filter\">\u00D7</button>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"toolbar-center\">\n      <div class=\"search-section\">\n        <app-input\n          [placeholder]=\"searchPlaceholder\"\n          [value]=\"searchText\"\n          [prefixIconName]=\"'search'\"\n          (valueChange)=\"onSearchChange($event)\"\n          [search]=\"true\"\n          class=\"search-input\">\n        </app-input>\n      </div>\n    </div>\n    \n    <div class=\"toolbar-right\">\n      <div class=\"action-icons\">\n        <ng-container *ngTemplateOutlet=\"rightTooltemplateRef\"></ng-container>\n\n        <!-- Only keep Filter icon for now -->\n        <button\n          class=\"icon-btn filter-btn\"\n          (click)=\"onFilterClick()\"\n          title=\"Filter\"\n          [class.active]=\"activeFiltersCount > 0\">\n          <mat-icon>tune</mat-icon>\n        </button>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Grid Content -->\n  <div class=\"grid-content\">\n    <div class=\"grid-wrapper\">\n      <!-- List View (AG-Grid) -->\n      <ag-grid-angular\n        *ngIf=\"isBrowser && viewMode === 'list'\"\n        [rowData]=\"filteredRowData\"\n        class=\"clean-grid ag-theme-clean\"\n        [columnDefs]=\"processedColumnDefs\"\n        [gridOptions]=\"gridOptions\"\n        [domLayout]=\"domLayout\"\n        [animateRows]=\"animateRows\"\n        [class]=\"class\"\n        [class.has-row-selection]=\"gridOptions.rowSelection\"\n        [style.width]=\"width\"\n        [style.height]=\"'100%'\"\n        (gridReady)=\"onGridReady($event)\"\n        (modelUpdated)=\"onModelUpdated($event)\"\n        (rowClicked)=\"onRowClicked($event)\">\n      </ag-grid-angular>\n\n      <!-- Card View (Custom Template) -->\n      <div class=\"card-grid\" *ngIf=\"isBrowser && viewMode === 'card' && cardTemplate\">\n        <ng-container *ngFor=\"let item of filteredRowData\">\n          <ng-container *ngTemplateOutlet=\"cardTemplate; context: { $implicit: item }\"></ng-container>\n        </ng-container>\n      </div>\n      \n      <!-- Loading State -->\n      <div class=\"grid-loading\" *ngIf=\"!isBrowser\">\n        <div class=\"loading-spinner\"></div>\n        <span>Loading grid...</span>\n      </div>\n    </div>\n  </div>\n</div>\n", styles: [".grid-container{display:flex;flex-direction:column;height:100%;width:100%;background:var(--page-background-color);border-radius:var(--input-radius);overflow:hidden;box-shadow:var(--primary-shadow)}.grid-container ::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}.grid-toolbar{min-height:4em;display:flex;align-items:center;justify-content:space-between;padding:.75em 1.25em;background:var(--surface-color);border-bottom:1px solid var(--primary-border);border-radius:var(--input-radius) var(--input-radius) 0 0;box-shadow:inset 0 -1px #18b6b21a;gap:1.25em;flex-wrap:wrap}.toolbar-left{display:flex;align-items:center;gap:1em;min-width:0}.toolbar-left .pagination-info{display:inline-flex;align-items:center;padding:6px 12px;background:#18b6b214;border-radius:999px;color:var(--primary-color);font-weight:var(--secondary-font-weight);font-size:calc(var(--tertiary-font-size) - 1px);letter-spacing:.015em}.toolbar-left .filter-chips{display:flex;align-items:center;flex-wrap:wrap;gap:8px;max-width:clamp(200px,30vw,450px);padding-left:4px}.toolbar-left .filter-chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:#18b6b21f;border:1px solid rgba(24,182,178,.35);border-radius:999px;color:var(--primary-font-color);font-size:calc(var(--tertiary-font-size) - 1px);transition:all .2s ease}.toolbar-left .filter-chip .chip-label{font-weight:600;color:var(--primary-color)}.toolbar-left .filter-chip .chip-value{font-weight:var(--secondary-font-weight);max-width:130px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.toolbar-left .filter-chip:hover{background:#18b6b22e;border-color:#18b6b28c;box-shadow:0 8px 16px -12px #18b6b2d9;transform:translateY(-1px)}.toolbar-left .filter-chip .chip-remove{width:18px;height:18px;border-radius:50%;background:#ffffffd9;border:none;color:var(--primary-color);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:12px;line-height:1;padding:0;transition:all .2s ease}.toolbar-left .filter-chip .chip-remove:hover{background:var(--primary-color);color:var(--surface-color);box-shadow:0 4px 10px -6px var(--primary-color)}.toolbar-center{flex:1;display:flex;justify-content:flex-start;max-width:400px}.toolbar-center .search-section{width:100%;max-width:320px}.toolbar-center .search-section .search-input{width:100%}.toolbar-center .search-section .search-input ::ng-deep .app-input-container{box-shadow:var(--primary-shadow);border:1px solid var(--primary-border);transition:all .3s ease}.toolbar-center .search-section .search-input ::ng-deep .app-input-container:focus-within{border-color:var(--primary-color);box-shadow:0 0 0 3px #18b6b21a}.toolbar-right{flex:0 0 auto}.toolbar-right .action-icons{display:flex;align-items:center;gap:12px;background:#18b6b20f;border-radius:999px;padding:6px 10px}.icon-btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;width:40px;height:40px;border:1px solid var(--primary-border);border-radius:50%;background:var(--surface-color);color:var(--primary-font-color);font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);cursor:pointer;transition:all .3s ease;position:relative;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.icon-btn:hover{background:var(--secondary-background-color);border-color:var(--primary-color);transform:translateY(-1px);box-shadow:var(--primary-shadow)}.icon-btn:active{transform:translateY(0);box-shadow:0 2px 4px #0000001a}.icon-btn:focus-visible{outline:2px solid rgba(24,182,178,.4);outline-offset:2px}.icon-btn.add-btn{background:linear-gradient(135deg,var(--primary-color),var(--tertiary-color));color:var(--surface-color);border-color:transparent;box-shadow:0 10px 18px -15px #18b6b2d9}.icon-btn.add-btn:hover{border-color:transparent;box-shadow:0 16px 28px -18px #18b6b2f2}.icon-btn.settings-btn{background:#18b6b214;border-color:#18b6b240}.icon-btn.settings-btn:hover{background:#18b6b229;border-color:var(--primary-color);color:var(--primary-color)}.icon-btn.refresh-btn:hover,.icon-btn.export-btn:hover{background:var(--secondary-background-color);border-color:var(--tertiary-color);color:var(--primary-font-color)}.icon-btn.filter-btn.active,.icon-btn.filter-btn:hover{background:var(--diet-quinary-color);border-color:var(--primary-color);color:var(--primary-color)}.icon-btn.filter-btn .filter-badge{position:absolute;top:-8px;right:-8px;background:var(--diet-secondary-color);color:var(--surface-color);border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;border:2px solid var(--surface-color)}.grid-content{height:calc(100% - 4em);flex:1;display:flex;flex-direction:column;overflow:hidden;background:linear-gradient(160deg,#18b6b20d,#1c324605)}.grid-wrapper{flex:1;position:relative;overflow:hidden;height:100%;background:var(--surface-color);border-radius:calc(var(--input-radius) + 2px);box-shadow:0 24px 48px -32px #0f172a8c;border:1px solid rgba(24,182,178,.08)}.grid-wrapper:after{content:\"\";position:absolute;inset:0;pointer-events:none;background:linear-gradient(180deg,#18b6b212,#18b6b200 40%);opacity:.6}@media (max-width: 960px){.grid-toolbar{padding:.75em;gap:.75em}.toolbar-left{flex:1 1 100%;justify-content:space-between}.toolbar-center{order:3;flex-basis:100%;margin-top:.75em}.toolbar-right{margin-left:auto}}@media (max-width: 640px){.toolbar-left{flex-direction:column;align-items:flex-start;gap:.5em}.toolbar-left .pagination-info{width:100%;justify-content:center}.toolbar-left .filter-chips{max-width:100%}.icon-btn{width:36px;height:36px}}::ng-deep .status-chip{display:inline-flex;align-items:center;justify-content:center;padding:6px 12px;border-radius:var(--button-radius);border:1px solid;font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);line-height:1.4;white-space:nowrap;min-width:80px;text-transform:capitalize}::ng-deep .status-success{background:var(--status-success-bg);color:var(--status-success-color);border-color:var(--status-success-border)}::ng-deep .status-warning{background:var(--status-warning-bg);color:var(--status-warning-color);border-color:var(--status-warning-border)}::ng-deep .status-danger{background:var(--status-danger-bg);color:var(--status-danger-color);border-color:var(--status-danger-border)}::ng-deep .status-info{background:var(--status-info-bg);color:var(--status-info-color);border-color:var(--status-info-border)}::ng-deep .status-neutral{background:var(--status-neutral-bg);color:var(--status-neutral-color);border-color:var(--status-neutral-border)}::ng-deep .status-available{background:var(--status-available-bg);color:var(--status-available-color);border-color:var(--status-available-border)}::ng-deep .status-unavailable{background:var(--status-unavailable-bg);color:var(--status-unavailable-color);border-color:var(--status-unavailable-border)}::ng-deep .status-busy{background:var(--status-busy-bg);color:var(--status-busy-color);border-color:var(--status-busy-border)}::ng-deep .status-offline{background:var(--status-offline-bg);color:var(--status-offline-color);border-color:var(--status-offline-border)}::ng-deep .actions-header-cell{padding:0!important}::ng-deep .actions-cell{padding:0!important;display:flex;align-items:center;justify-content:center;position:relative}::ng-deep .ag-row.ag-row-hover .actions-cell:after,::ng-deep .ag-row.ag-row-selected .actions-cell:after{content:\"\";position:absolute;right:0;top:0;bottom:0;width:4px;background:var(--primary-color)}.grid-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;color:var(--secondary-font-color);gap:16px}.grid-loading .loading-spinner{width:32px;height:32px;border:3px solid var(--primary-border);border-top:3px solid var(--primary-color);border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.grid-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:400px;padding:40px;text-align:center;color:var(--secondary-font-color)}.grid-empty .empty-icon{margin-bottom:16px;opacity:.6}.grid-empty h4{margin:0 0 8px;font-size:var(--primary-font-size);font-weight:var(--primary-font-weight);color:var(--primary-font-color)}.grid-empty p{margin:0 0 24px;font-size:var(--tertiary-font-size);color:var(--secondary-font-color);max-width:300px;line-height:1.5}.grid-empty .empty-action-btn{display:flex;align-items:center;gap:8px;padding:12px 20px;border:1px solid var(--primary-color);border-radius:var(--button-radius);background:var(--primary-color);color:var(--surface-color);font-size:var(--tertiary-font-size);font-weight:var(--secondary-font-weight);cursor:pointer;transition:all .3s ease}.grid-empty .empty-action-btn:hover{background:var(--primary-color);transform:translateY(-1px);box-shadow:var(--primary-shadow)}::ng-deep .ag-row-focus{background:var(--secondary-background-color)!important;border-left:3px solid var(--primary-color)!important}::ng-deep .clean-grid.ag-theme-clean{--ag-background-color: var(--surface-color);--ag-foreground-color: var(--primary-font-color);--ag-border-color: var(--primary-border);--ag-header-background-color: var(--page-background-color);--ag-header-foreground-color: var(--primary-font-color);--ag-odd-row-background-color: var(--surface-color);--ag-row-hover-color: var(--secondary-background-color);--ag-selected-row-background-color: rgba(24, 182, 178, .1);--ag-range-selection-background-color: rgba(24, 182, 178, .2);--ag-header-height: 56px;--ag-row-height: 52px;--ag-grid-size: 4px;--ag-icon-size: 16px;--ag-font-size: var(--tertiary-font-size);--ag-font-family: inherit;border:none!important;border-radius:0 0 var(--input-radius) var(--input-radius);box-shadow:none!important}::ng-deep .clean-grid .ag-header{background:linear-gradient(180deg,var(--page-background-color) 0%,var(--secondary-background-color) 100%);border-bottom:2px solid var(--primary-border);font-weight:var(--primary-font-weight)}::ng-deep .clean-grid .ag-header .ag-header-cell{border-right:1px solid var(--primary-border);padding:0 16px}::ng-deep .clean-grid .ag-header .ag-header-cell .ag-header-cell-label{font-weight:var(--primary-font-weight);color:var(--primary-font-color);font-size:var(--tertiary-font-size)}::ng-deep .clean-grid .ag-header .ag-header-cell:hover{background:#18b6b20d}::ng-deep .clean-grid .ag-header .ag-header-cell-resize{background:var(--primary-color);width:2px;opacity:.6}::ng-deep .clean-grid .ag-row{border-bottom:1px solid var(--primary-border);transition:all .2s ease}::ng-deep .clean-grid .ag-row:hover{background:var(--page-background-color)!important;box-shadow:inset 4px 0 0 var(--primary-color)}::ng-deep .clean-grid .ag-row.ag-row-selected{background:#18b6b214!important;border-color:var(--primary-color)}::ng-deep .clean-grid .ag-row:last-child{border-bottom:none}::ng-deep .clean-grid.has-row-selection .ag-row{cursor:pointer}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected{background:#18b6b226!important;border-left:4px solid var(--primary-color)!important;box-shadow:inset 0 0 0 1px #18b6b233,0 2px 8px #18b6b21a!important}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected .ag-cell{background-color:transparent!important;font-weight:var(--secondary-font-weight)}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-selected:hover{background:#18b6b22e!important;box-shadow:inset 0 0 0 1px #18b6b24d,0 4px 12px #18b6b226!important}::ng-deep .clean-grid.has-row-selection .ag-row.ag-row-focus.ag-row-selected{background:#18b6b226!important;border-left:4px solid var(--primary-color)!important}::ng-deep .clean-grid .ag-cell{display:flex!important;align-items:center!important;padding:0 16px;border-right:1px solid transparent;color:var(--primary-font-color);font-size:var(--tertiary-font-size);line-height:1.4}::ng-deep .clean-grid .ag-cell:focus{border:2px solid var(--primary-color)!important;outline:none;border-radius:4px}::ng-deep .clean-grid .ag-cell .ag-cell-value{display:flex!important;align-items:center!important;width:100%}::ng-deep .clean-grid .ag-center-cols-viewport{background:var(--surface-color)}::ng-deep .clean-grid .ag-root-wrapper,::ng-deep .clean-grid .ag-root-wrapper.ag-layout-auto-height.ag-ltr,::ng-deep .clean-grid .ag-root-wrapper-body{height:100%;border:none!important;box-shadow:none!important}::ng-deep .clean-grid .ag-body-viewport{overflow-y:scroll}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar{width:8px;height:8px}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-track{background:var(--secondary-background-color);border-radius:4px}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-thumb{background:var(--tertiary-color);border-radius:4px;transition:background .3s ease}::ng-deep .clean-grid .ag-body-viewport::-webkit-scrollbar-thumb:hover{background:var(--primary-color)}::ng-deep .clean-grid .ag-overlay-loading-wrapper{background:#ffffffe6;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}::ng-deep .clean-grid .ag-overlay-no-rows-wrapper{background:transparent}::ng-deep .clean-grid .ag-header-icon{color:var(--primary-color)}::ng-deep .clean-grid .ag-header-cell-filtered{background:#18b6b21a}::ng-deep .clean-grid .ag-header-cell-filtered .ag-header-cell-label{color:var(--primary-color);font-weight:600}::ng-deep .clean-grid .ag-selection-checkbox .ag-input-wrapper{background:var(--surface-color);border:2px solid var(--primary-border);border-radius:4px}::ng-deep .clean-grid .ag-selection-checkbox .ag-input-wrapper:after{color:var(--primary-color)}::ng-deep .clean-grid .ag-selection-checkbox input:checked+.ag-input-wrapper{background:var(--primary-color);border-color:var(--primary-color)}::ng-deep .clean-grid .ag-pinned-left-cols-container,::ng-deep .clean-grid .ag-pinned-right-cols-container,::ng-deep .clean-grid .ag-pinned-left-header,::ng-deep .clean-grid .ag-pinned-right-header{box-shadow:none!important}::ng-deep .clean-grid .ag-pinned-left-cols-container,::ng-deep .clean-grid .ag-pinned-left-header{border-right:none!important}::ng-deep .clean-grid .ag-pinned-right-cols-container,::ng-deep .clean-grid .ag-pinned-right-header{border-left:none!important}::ng-deep .clean-grid .clean-grid.ag-theme-clean .ag-cell.ag-cell-first-right-pinned{border-left:none!important}::ng-deep .mat-mdc-form-field-subscript-wrapper{display:none!important}::ng-deep .mat-mdc-tab-body-content{overflow:hidden!important}@media print{:host{background:none!important}.grid-toolbar,.grid-content,.grid-wrapper{background:#fff!important;box-shadow:none!important}.grid-wrapper:after{display:none!important}}\n"] }]
        }], ctorParameters: () => [{ type: i1.DialogboxService }, { type: Object, decorators: [{
                    type: Inject,
                    args: [PLATFORM_ID]
                }] }, { type: i2.ApiConfigService }, { type: i3.HttpClient }], propDecorators: { rowData: [{
                type: Input
            }], columnDefs: [{
                type: Input
            }], gridOptions: [{
                type: Input
            }], domLayout: [{
                type: Input
            }], animateRows: [{
                type: Input
            }], class: [{
                type: Input
            }], height: [{
                type: Input
            }], width: [{
                type: Input
            }], showHeader: [{
                type: Input
            }], searchPlaceholder: [{
                type: Input
            }], rightTooltemplateRef: [{
                type: Input
            }], cardTemplate: [{
                type: Input
            }], defaultViewMode: [{
                type: Input
            }], showAddButton: [{
                type: Input
            }], apiConfig: [{
                type: Input
            }], searchChange: [{
                type: Output
            }], rowClicked: [{
                type: Output
            }], addClick: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb21tb24tbGlicy9jb3JlL3NyYy9saWIvdG9vbHMvZ3JpZC9ncmlkLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbW1vbi1saWJzL2NvcmUvc3JjL2xpYi90b29scy9ncmlkL2dyaWQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUE0RCxNQUFNLGVBQWUsQ0FBQztBQUN0SixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFFLGtCQUFrQixFQUFrRCxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUN2SCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFjLGdCQUFnQixFQUFFLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ2hGLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUN2RCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzNELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBRXJFLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM3RCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxvREFBb0QsQ0FBQztBQUMvRixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENB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QUs7Z0JBQ0csYUFBYTtzQkFBckIsS0FBSztnQkFDRyxTQUFTO3NCQUFqQixLQUFLO2dCQUVJLFlBQVk7c0JBQXJCLE1BQU07Z0JBQ0csVUFBVTtzQkFBbkIsTUFBTTtnQkFDRyxRQUFRO3NCQUFqQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgUExBVEZPUk1fSUQsIFRlbXBsYXRlUmVmLCBPbkluaXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgT25EZXN0cm95IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBBZ0dyaWRNb2R1bGUgfSBmcm9tICdhZy1ncmlkLWFuZ3VsYXInO1xuaW1wb3J0IHsgQWxsQ29tbXVuaXR5TW9kdWxlLCBDb2xEZWYsIERvbUxheW91dFR5cGUsIEdyaWRBcGksIEdyaWRSZWFkeUV2ZW50LCBNb2R1bGVSZWdpc3RyeSB9IGZyb20gJ2FnLWdyaWQtY29tbXVuaXR5JztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwQ2xpZW50TW9kdWxlLCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgTWF0TWVudU1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL21lbnUnO1xuaW1wb3J0IHsgTWF0SWNvbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2ljb24nO1xuaW1wb3J0IHsgTWF0QnV0dG9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvYnV0dG9uJztcbmltcG9ydCB7IEFwcElucHV0Q29tcG9uZW50IH0gZnJvbSAnLi4vYXBwLWlucHV0L2FwcC1pbnB1dC5jb21wb25lbnQnO1xuaW1wb3J0IHsgRGlhbG9nYm94U2VydmljZSB9IGZyb20gJy4uL2RpYWxvZ2JveC9kaWFsb2dib3guY29tcG9uZW50JztcbmltcG9ydCB7IEZpbHRlckNvbXBvbmVudCB9IGZyb20gJy4uL2ZpbHRlci9maWx0ZXIuY29tcG9uZW50JztcbmltcG9ydCB7IEdyaWRNZW51UmVuZGVyZXJDb21wb25lbnQgfSBmcm9tICcuLi9ncmlkLW1lbnUtcmVuZGVyZXIvZ3JpZC1tZW51LXJlbmRlcmVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJY29uQ29tcG9uZW50IH0gZnJvbSAnLi4vYXBwLWljb24vaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgQXBpQ29uZmlnU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2FwaS1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBmb3JrSm9pbiwgb2YsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEV4dGVuZGVkR3JpZE9wdGlvbnMsIEdyaWRBcGlDb25maWcsIEdyaWRBcGlSZXF1ZXN0Q29uZmlnLCBHcmlkQXBpRGF0YVJlc3BvbnNlLCBHcmlkQXBpQ291bnRSZXNwb25zZSB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvZ3JpZC5pbnRlcmZhY2UnO1xuXG4vLyBBRyBHcmlkIHYzNCsgcmVxdWlyZXMgbW9kdWxlIHJlZ2lzdHJhdGlvbiBmb3IgZmVhdHVyZXMgbGlrZSBwYWdpbmF0aW9uLCBmaWx0ZXJpbmcsIHJvdyBBUEksIGV0Yy5cbi8vIFJlZ2lzdGVyIGFsbCBjb21tdW5pdHkgbW9kdWxlcyBvbmNlIGZvciB0aGUgYXBwIChzYWZlIHRvIGNhbGwgbXVsdGlwbGUgdGltZXMpLlxuTW9kdWxlUmVnaXN0cnkucmVnaXN0ZXJNb2R1bGVzKFtBbGxDb21tdW5pdHlNb2R1bGVdKTtcblxuLyoqXG4gKiBHcmlkIENvbXBvbmVudCB3aXRoIE1lbnUgU3VwcG9ydFxuICogXG4gKiBUaGlzIGNvbXBvbmVudCBleHRlbmRzIHRoZSBzdGFuZGFyZCBhZy1ncmlkIHdpdGggbWVudSBmdW5jdGlvbmFsaXR5LlxuICogXG4gKiBNZW51IENvbmZpZ3VyYXRpb246XG4gKiAxLiBTZXQgbWVudUFjdGlvbnMgaW4gZ3JpZE9wdGlvbnMgdG8gYXV0b21hdGljYWxseSBhZGQgYSBtZW51IGNvbHVtblxuICogMi4gT3IgbWFudWFsbHkgYWRkIGEgY29sdW1uIHdpdGggY2VsbFJlbmRlcmVyOiAnZ3JpZE1lbnUnXG4gKiBcbiAqIEV4YW1wbGUgdXNhZ2U6XG4gKiBgYGB0eXBlc2NyaXB0XG4gKiB0aGlzLmdyaWRPcHRpb25zID0ge1xuICogICBtZW51QWN0aW9uczogW1xuICogICAgIHtcbiAqICAgICAgIHRpdGxlOiAnVmlldycsXG4gKiAgICAgICBpY29uOiAndmlzaWJpbGl0eScsXG4gKiAgICAgICBjbGljazogKHBhcmFtKSA9PiB0aGlzLm9uVmlldyhwYXJhbS5kYXRhKVxuICogICAgIH0sXG4gKiAgICAge1xuICogICAgICAgdGl0bGU6ICdFZGl0JyxcbiAqICAgICAgIGljb246ICdlZGl0JyxcbiAqICAgICAgIGNsaWNrOiAocGFyYW0pID0+IHRoaXMub25FZGl0KHBhcmFtLmRhdGEpXG4gKiAgICAgfSxcbiAqICAgICB7XG4gKiAgICAgICB0aXRsZTogJ0RlbGV0ZScsXG4gKiAgICAgICBpY29uOiAnZGVsZXRlJyxcbiAqICAgICAgIGNsaWNrOiAocGFyYW0pID0+IHRoaXMub25EZWxldGUocGFyYW0uZGF0YSlcbiAqICAgICB9XG4gKiAgIF1cbiAqIH07XG4gKiBgYGBcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYXBwLWdyaWQnLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgQ29tbW9uTW9kdWxlLCBcbiAgICBBZ0dyaWRNb2R1bGUsIFxuICAgIEFwcElucHV0Q29tcG9uZW50LCBcbiAgICBHcmlkTWVudVJlbmRlcmVyQ29tcG9uZW50LFxuICAgIEljb25Db21wb25lbnQsXG4gICAgSHR0cENsaWVudE1vZHVsZSxcbiAgICBNYXRNZW51TW9kdWxlLCBcbiAgICBNYXRJY29uTW9kdWxlLCBcbiAgICBNYXRCdXR0b25Nb2R1bGVcbiAgXSxcbiAgdGVtcGxhdGVVcmw6ICcuL2dyaWQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybDogJy4vZ3JpZC5jb21wb25lbnQuc2Nzcydcbn0pXG5leHBvcnQgY2xhc3MgR3JpZENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuICBASW5wdXQoKSByb3dEYXRhOiBhbnlbXSA9IFtdO1xuICBASW5wdXQoKSBjb2x1bW5EZWZzOiBDb2xEZWZbXSA9IFtdO1xuICBASW5wdXQoKSBncmlkT3B0aW9uczogRXh0ZW5kZWRHcmlkT3B0aW9ucyA9IHt9O1xuICBASW5wdXQoKSBkb21MYXlvdXQ6IERvbUxheW91dFR5cGUgPSAnYXV0b0hlaWdodCc7XG4gIEBJbnB1dCgpIGFuaW1hdGVSb3dzOiBib29sZWFuID0gdHJ1ZTtcbiAgQElucHV0KCkgY2xhc3M6IHN0cmluZyA9ICdhZy10aGVtZS1hbHBpbmUnO1xuICBASW5wdXQoKSBoZWlnaHQ6IHN0cmluZyA9ICc0MDBweCc7XG4gIEBJbnB1dCgpIHdpZHRoOiBzdHJpbmcgPSAnMTAwJSc7XG4gIEBJbnB1dCgpIHNob3dIZWFkZXI6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBzZWFyY2hQbGFjZWhvbGRlcjogc3RyaW5nID0gJ1NlYXJjaC4uLic7XG4gIEBJbnB1dCgpIHJpZ2h0VG9vbHRlbXBsYXRlUmVmOiBUZW1wbGF0ZVJlZjxhbnk+IHwgbnVsbCA9IG51bGw7XG4gIEBJbnB1dCgpIGNhcmRUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IG51bGwgPSBudWxsO1xuICBASW5wdXQoKSBkZWZhdWx0Vmlld01vZGU6ICdsaXN0JyB8ICdjYXJkJyA9ICdsaXN0JztcbiAgQElucHV0KCkgc2hvd0FkZEJ1dHRvbjogYm9vbGVhbiA9IGZhbHNlO1xuICBASW5wdXQoKSBhcGlDb25maWc6IEdyaWRBcGlDb25maWcgfCBudWxsID0gbnVsbDtcblxuICBAT3V0cHV0KCkgc2VhcmNoQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG4gIEBPdXRwdXQoKSByb3dDbGlja2VkID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIEBPdXRwdXQoKSBhZGRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICBzZWFyY2hUZXh0OiBzdHJpbmcgPSAnJztcbiAgZmlsdGVyZWRSb3dEYXRhOiBhbnlbXSA9IFtdO1xuICBpc0Jyb3dzZXI6IGJvb2xlYW47XG4gIHByb2Nlc3NlZENvbHVtbkRlZnM6IENvbERlZltdID0gW107XG4gIGFjdGl2ZUZpbHRlcnNDb3VudDogbnVtYmVyID0gMDtcbiAgYWN0aXZlRmlsdGVyQ2hpcHM6IEFycmF5PHsgbGFiZWw6IHN0cmluZzsgdmFsdWU6IHN0cmluZzsgZmllbGQ6IHN0cmluZyB9PiA9IFtdO1xuICB2aWV3TW9kZTogJ2xpc3QnIHwgJ2NhcmQnID0gJ2xpc3QnO1xuICBkaXNwbGF5ZWRSb3dzOiBudW1iZXIgPSAwO1xuICB0b3RhbFJvd3M6IG51bWJlciA9IDA7XG4gIGdyaWRBcGkhOiBHcmlkQXBpO1xuICBwcml2YXRlIGRhdGFGZXRjaFN1Yj86IFN1YnNjcmlwdGlvbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGRpYWxvZ2JveDogRGlhbG9nYm94U2VydmljZSxcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCxcbiAgICBwcml2YXRlIGFwaUNvbmZpZ1NlcnZpY2U6IEFwaUNvbmZpZ1NlcnZpY2UsXG4gICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50XG4gICkge1xuICAgIHRoaXMuaXNCcm93c2VyID0gaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuZ3JpZE9wdGlvbnMucGFnaW5hdGlvbiA9IHRydWU7XG4gICAgdGhpcy5ncmlkT3B0aW9ucy5wYWdpbmF0aW9uUGFnZVNpemUgPSAyNTtcbiAgICB0aGlzLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZVNlbGVjdG9yID0gWzEwLCAyNSwgNTAsIDEwMF07XG4gICAgdGhpcy5ncmlkT3B0aW9ucy5yb3dIZWlnaHQgPSA0ODtcbiAgICB0aGlzLmdyaWRPcHRpb25zLmhlYWRlckhlaWdodCA9IDQwO1xuICAgIHRoaXMuZ3JpZE9wdGlvbnMuc3VwcHJlc3NDZWxsRm9jdXMgPSB0cnVlO1xuICAgIHRoaXMuZ3JpZE9wdGlvbnMuZ2V0Um93SGVpZ2h0ID0gKHBhcmFtcykgPT4ge1xuICAgICAgLy8gU3VwcG9ydCBkeW5hbWljIHJvdyBoZWlnaHQgZm9yIG11bHRpLWxpbmUgY29udGVudFxuICAgICAgcmV0dXJuIHBhcmFtcy5ub2RlLnJvd0hlaWdodCB8fCA0ODtcbiAgICB9O1xuICAgIHRoaXMuZ3JpZE9wdGlvbnMuY29udGV4dCA9IHsgZ3JpZE9wdGlvbnM6IHRoaXMuZ3JpZE9wdGlvbnMgYXMgRXh0ZW5kZWRHcmlkT3B0aW9ucyB9O1xuICAgIHRoaXMuZ3JpZE9wdGlvbnMubm9Sb3dzT3ZlcmxheUNvbXBvbmVudFBhcmFtcyA9IHtcbiAgICAgIG5vUm93c01lc3NhZ2VGdW5jOiAoKSA9PiAnTm8gcmVjb3JkcyB0byBkaXNwbGF5J1xuICAgIH07XG4gICAgXG4gICAgLy8gQ29uZmlndXJlIHJvdyBzZWxlY3Rpb24gaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLmdyaWRPcHRpb25zLnJvd1NlbGVjdGlvbikge1xuICAgICAgLy8gRW5zdXJlIHJvdyBjbGlja3MgdHJpZ2dlciBzZWxlY3Rpb25cbiAgICAgIGlmICh0aGlzLmdyaWRPcHRpb25zLnN1cHByZXNzUm93Q2xpY2tTZWxlY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmdyaWRPcHRpb25zLnN1cHByZXNzUm93Q2xpY2tTZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIEFkZCByb3cgc2VsZWN0aW9uIGNsYXNzXG4gICAgICB0aGlzLmNsYXNzID0gKHRoaXMuY2xhc3MgfHwgJ2FnLXRoZW1lLWNsZWFuJykgKyAnIGhhcy1yb3ctc2VsZWN0aW9uJztcbiAgICB9XG4gICAgXG4gICAgLy8gUmVnaXN0ZXIgY2VsbCByZW5kZXJlciBjb21wb25lbnRzIGZvciBBRy1HcmlkXG4gICAgLy8gVGhpcyBlbnN1cmVzIEFHLUdyaWQgY2FuIHJlc29sdmUgdGhlIGNvbXBvbmVudHMgYXQgcnVudGltZVxuICAgIGlmICghdGhpcy5ncmlkT3B0aW9ucy5jb21wb25lbnRzKSB7XG4gICAgICB0aGlzLmdyaWRPcHRpb25zLmNvbXBvbmVudHMgPSB7fTtcbiAgICB9XG4gICAgdGhpcy5ncmlkT3B0aW9ucy5jb21wb25lbnRzWydncmlkTWVudSddID0gR3JpZE1lbnVSZW5kZXJlckNvbXBvbmVudDtcbiAgICB0aGlzLmZpbHRlcmVkUm93RGF0YSA9IFsuLi50aGlzLnJvd0RhdGFdO1xuICAgIHRoaXMudmlld01vZGUgPSB0aGlzLmRlZmF1bHRWaWV3TW9kZTtcbiAgICBpZiAodGhpcy5zaG91bGRGZXRjaEZyb21BcGkoKSkge1xuICAgICAgdGhpcy5mZXRjaEdyaWREYXRhRnJvbUFwaSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByb2Nlc3NDb2x1bW5EZWZzKCk7XG4gICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb25JbmZvKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGNvbnN0IHJvd0RhdGFDaGFuZ2VkID0gJ3Jvd0RhdGEnIGluIGNoYW5nZXM7XG4gICAgY29uc3QgYXBpQ29uZmlnQ2hhbmdlZCA9ICdhcGlDb25maWcnIGluIGNoYW5nZXM7XG5cbiAgICBpZiAocm93RGF0YUNoYW5nZWQgJiYgdGhpcy5yb3dEYXRhICYmIHRoaXMucm93RGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmZpbHRlcmVkUm93RGF0YSA9IHRoaXMuYXBwbHlTZWFyY2hUbyhbLi4udGhpcy5yb3dEYXRhXSk7XG4gICAgICB0aGlzLnByb2Nlc3NDb2x1bW5EZWZzKCk7XG4gICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb25JbmZvKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGFwaUNvbmZpZ0NoYW5nZWQgJiYgdGhpcy5zaG91bGRGZXRjaEZyb21BcGkoKSkge1xuICAgICAgdGhpcy5mZXRjaEdyaWREYXRhRnJvbUFwaSgpO1xuICAgIH1cbiAgfVxuXG4gIG9uR3JpZFJlYWR5KHBhcmFtczogR3JpZFJlYWR5RXZlbnQpOiB2b2lkIHtcbiAgICB0aGlzLmdyaWRBcGkgPSBwYXJhbXMuYXBpO1xuICAgIHRoaXMudXBkYXRlUGFnaW5hdGlvbkluZm8oKTtcbiAgfVxuXG4gIG9uTW9kZWxVcGRhdGVkKGV2ZW50OiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb25JbmZvKCk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVBhZ2luYXRpb25JbmZvKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmdyaWRBcGkpIHtcbiAgICAgIGNvbnN0IHRvdGFsRmlsdGVyZWRSb3dzID0gdGhpcy5ncmlkQXBpLmdldERpc3BsYXllZFJvd0NvdW50KCk7XG4gICAgICBjb25zdCBwYWdlU2l6ZSA9IHRoaXMuZ3JpZEFwaS5wYWdpbmF0aW9uR2V0UGFnZVNpemUoKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRQYWdlID0gdGhpcy5ncmlkQXBpLnBhZ2luYXRpb25HZXRDdXJyZW50UGFnZSgpO1xuICAgICAgY29uc3Qgc3RhcnRSb3cgPSBjdXJyZW50UGFnZSAqIHBhZ2VTaXplO1xuICAgICAgY29uc3QgZW5kUm93ID0gTWF0aC5taW4oc3RhcnRSb3cgKyBwYWdlU2l6ZSwgdG90YWxGaWx0ZXJlZFJvd3MpO1xuICAgICAgY29uc3QgZGlzcGxheWVkT25QYWdlID0gdG90YWxGaWx0ZXJlZFJvd3MgPiAwID8gZW5kUm93IC0gc3RhcnRSb3cgOiAwO1xuICAgICAgXG4gICAgICB0aGlzLmRpc3BsYXllZFJvd3MgPSBkaXNwbGF5ZWRPblBhZ2U7XG4gICAgICB0aGlzLnRvdGFsUm93cyA9IHRvdGFsRmlsdGVyZWRSb3dzO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc3BsYXllZFJvd3MgPSB0aGlzLmZpbHRlcmVkUm93RGF0YS5sZW5ndGg7XG4gICAgICB0aGlzLnRvdGFsUm93cyA9IHRoaXMuZmlsdGVyZWRSb3dEYXRhLmxlbmd0aDtcbiAgICB9XG4gIH1cblxuICBvbkFkZENsaWNrKCk6IHZvaWQge1xuICAgIHRoaXMuYWRkQ2xpY2suZW1pdCgpO1xuICB9XG5cbiAgb25Db2x1bW5TZXR0aW5nc0NsaWNrKCk6IHZvaWQge1xuICAgIC8vIEVtaXQgZXZlbnQgb3Igb3BlbiBjb2x1bW4gdmlzaWJpbGl0eSBkaWFsb2dcbiAgICBpZiAodGhpcy5ncmlkQXBpKSB7XG4gICAgICAvLyBDYW4gaW1wbGVtZW50IGNvbHVtbiB2aXNpYmlsaXR5IHRvZ2dsZSBoZXJlXG4gICAgICBjb25zb2xlLmxvZygnQ29sdW1uIHNldHRpbmdzIGNsaWNrZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHN0YXR1cyBjbGFzcyBiYXNlZCBvbiBzdGF0dXMgdmFsdWVcbiAgICogSGVscGVyIG1ldGhvZCB0byBhdXRvbWF0aWNhbGx5IGRldGVybWluZSBzdGF0dXMgYmFkZ2UgY2xhc3MgZnJvbSBlbnVtL3N0cmluZyB2YWx1ZXNcbiAgICovXG4gIHN0YXRpYyBnZXRTdGF0dXNDbGFzcyhzdGF0dXNWYWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyB7XG4gICAgaWYgKCFzdGF0dXNWYWx1ZSkgcmV0dXJuICdzdGF0dXMtbmV1dHJhbCc7XG4gICAgXG4gICAgY29uc3Qgc3RhdHVzID0gU3RyaW5nKHN0YXR1c1ZhbHVlKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1tfXFxzLV0vZywgJy0nKTtcbiAgICBcbiAgICAvLyBTdWNjZXNzIHN0YXRlc1xuICAgIGlmIChbJ3BhaWQnLCAnY2xvc2VkJywgJ2NsZWFyZWQnLCAnYWN0aXZlJywgJ2NvbXBsZXRlZCcsICdhcHByb3ZlZCcsICdlbmFibGVkJywgJ29ubGluZScsICdhdmFpbGFibGUnLCAnZG9uZScsICdmaW5pc2hlZCcsICdyZXNvbHZlZCcsICdhY2NlcHRlZCcsICd2ZXJpZmllZCcsICdjb25maXJtZWQnLCAnZGVsaXZlcmVkJywgJ3B1Ymxpc2hlZCcsICdsaXZlJ10uaW5jbHVkZXMoc3RhdHVzKSkge1xuICAgICAgcmV0dXJuICdzdGF0dXMtc3VjY2Vzcyc7XG4gICAgfVxuICAgIFxuICAgIC8vIEVycm9yL0RhbmdlciBzdGF0ZXNcbiAgICBpZiAoWydjYW5jZWxsZWQnLCAnY2FuY2VsZWQnLCAnZmFpbGVkJywgJ3ZvaWQnLCAncmVqZWN0ZWQnLCAnZGVuaWVkJywgJ2Jsb2NrZWQnLCAnZGlzYWJsZWQnLCAnaW5hY3RpdmUnLCAndW5hdmFpbGFibGUnLCAnb2ZmbGluZScsICdleHBpcmVkJywgJ3Rlcm1pbmF0ZWQnLCAnc3VzcGVuZGVkJywgJ2RlbGV0ZWQnLCAnZXJyb3InLCAnY3JpdGljYWwnXS5pbmNsdWRlcyhzdGF0dXMpKSB7XG4gICAgICByZXR1cm4gJ3N0YXR1cy1kYW5nZXInO1xuICAgIH1cbiAgICBcbiAgICAvLyBXYXJuaW5nIHN0YXRlc1xuICAgIGlmIChbJ3BlbmRpbmcnLCAnaW4tcHJvZ3Jlc3MnLCAnaW5fcHJvZ3Jlc3MnLCAnd2FpdGluZycsICdwcm9jZXNzaW5nJywgJ3F1ZXVlZCcsICdkcmFmdCcsICdyZXZpZXcnLCAndW5kZXItcmV2aWV3JywgJ29uLWhvbGQnLCAnb25ob2xkJywgJ2RlbGF5ZWQnLCAncGFydGlhbGx5LXBhaWQnLCAncGFydGlhbGx5X3BhaWQnLCAncGFydGlhbCddLmluY2x1ZGVzKHN0YXR1cykpIHtcbiAgICAgIHJldHVybiAnc3RhdHVzLXdhcm5pbmcnO1xuICAgIH1cbiAgICBcbiAgICAvLyBJbmZvIHN0YXRlc1xuICAgIGlmIChbJ2lzc3VlZCcsICdzY2hlZHVsZWQnLCAnYXNzaWduZWQnLCAnYWxsb2NhdGVkJywgJ3Jlc2VydmVkJywgJ2Jvb2tlZCcsICdhY2tub3dsZWRnZWQnLCAnbm90aWZpZWQnLCAnaW5mbyddLmluY2x1ZGVzKHN0YXR1cykpIHtcbiAgICAgIHJldHVybiAnc3RhdHVzLWluZm8nO1xuICAgIH1cbiAgICBcbiAgICAvLyBTcGVjaWFsIHN0YXRlc1xuICAgIGlmIChbJ3VyZ2VudCcsICdlbWVyZ2VuY3knLCAnaGlnaC1wcmlvcml0eScsICdoaWdoX3ByaW9yaXR5JywgJ3ByaW9yaXR5J10uaW5jbHVkZXMoc3RhdHVzKSkge1xuICAgICAgcmV0dXJuICdzdGF0dXMtdXJnZW50JztcbiAgICB9XG4gICAgXG4gICAgLy8gQnVzeSBzdGF0ZXNcbiAgICBpZiAoWydidXN5JywgJ3dvcmtpbmcnLCAnb2NjdXBpZWQnXS5pbmNsdWRlcyhzdGF0dXMpKSB7XG4gICAgICByZXR1cm4gJ3N0YXR1cy1idXN5JztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICdzdGF0dXMtbmV1dHJhbCc7XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzcyBjb2x1bW4gZGVmaW5pdGlvbnMgdG8gYWRkIG1lbnUgY29sdW1uIGlmIG5lZWRlZFxuICAgKiBcbiAgICogVGhpcyBtZXRob2Q6XG4gICAqIDEuIENoZWNrcyBpZiBhbnkgY29sdW1uIGhhcyBjZWxsUmVuZGVyZXI6ICdncmlkTWVudSdcbiAgICogMi4gSWYgbWVudUFjdGlvbnMgZXhpc3QgaW4gZ3JpZE9wdGlvbnMgYnV0IG5vIG1lbnUgY29sdW1uIGlzIGNvbmZpZ3VyZWQsIGFkZHMgb25lIGF1dG9tYXRpY2FsbHlcbiAgICogMy4gSWYgYSBtZW51IGNvbHVtbiBleGlzdHMsIHVwZGF0ZXMgaXQgd2l0aCB0aGUgcHJvcGVyIGNlbGwgcmVuZGVyZXJcbiAgICogNC4gQXV0by1kZXRlY3RzIHN0YXR1cyBjb2x1bW5zIGFuZCBhcHBsaWVzIGFwcHJvcHJpYXRlIGNlbGwgY2xhc3Nlc1xuICAgKi9cbiAgcHJpdmF0ZSBwcm9jZXNzQ29sdW1uRGVmcygpIHtcbiAgICAvLyBQcm9jZXNzIGNvbHVtbnMgYW5kIGRpc2FibGUgZmxvYXRpbmcgZmlsdGVycyBieSBkZWZhdWx0IHRvIG1hdGNoIGltYWdlICh1bmxlc3MgZXhwbGljaXRseSBzZXQpXG4gICAgdGhpcy5wcm9jZXNzZWRDb2x1bW5EZWZzID0gdGhpcy5jb2x1bW5EZWZzLm1hcChjb2wgPT4ge1xuICAgICAgY29uc3QgZmllbGQgPSBjb2wuZmllbGQ/LnRvTG93ZXJDYXNlKCkgfHwgJyc7XG4gICAgICBjb25zdCBpc1N0YXR1c0NvbHVtbiA9IGZpZWxkLmluY2x1ZGVzKCdzdGF0dXMnKSB8fCBmaWVsZC5pbmNsdWRlcygnc3RhdGUnKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uY29sLFxuICAgICAgICBmbG9hdGluZ0ZpbHRlcjogY29sLmZsb2F0aW5nRmlsdGVyID8/IGZhbHNlLFxuICAgICAgICBzdXBwcmVzc0hlYWRlck1lbnVCdXR0b246IGNvbC5zdXBwcmVzc0hlYWRlck1lbnVCdXR0b24gPz8gdHJ1ZSxcbiAgICAgICAgLy8gQXV0by1hZGQgc3RhdHVzIGNlbGwgY2xhc3MgZm9yIHN0YXR1cyBjb2x1bW5zXG4gICAgICAgIGNlbGxDbGFzczogaXNTdGF0dXNDb2x1bW4gJiYgIWNvbC5jZWxsQ2xhc3MgXG4gICAgICAgICAgPyAnc3RhdHVzLWNlbGwnIFxuICAgICAgICAgIDogY29sLmNlbGxDbGFzc1xuICAgICAgfTtcbiAgICB9KTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiBhbnkgY29sdW1uIGhhcyBjZWxsUmVuZGVyZXI6ICdncmlkTWVudScgb3IgaWYgdGhlcmUncyBhbHJlYWR5IGFuIGFjdGlvbnMgY29sdW1uXG4gICAgY29uc3QgaGFzTWVudUNvbHVtbiA9IHRoaXMucHJvY2Vzc2VkQ29sdW1uRGVmcy5zb21lKGNvbCA9PiBcbiAgICAgIGNvbC5jZWxsUmVuZGVyZXIgPT09ICdncmlkTWVudScgfHwgXG4gICAgICBjb2wuY2VsbFJlbmRlcmVyID09PSBHcmlkTWVudVJlbmRlcmVyQ29tcG9uZW50IHx8XG4gICAgICAoY29sLmZpZWxkID09PSAnYWN0aW9ucycgJiYgY29sLnBpbm5lZCA9PT0gJ3JpZ2h0JylcbiAgICApO1xuICAgIFxuICAgIGNvbnN0IGV4dGVuZGVkR3JpZE9wdGlvbnMgPSB0aGlzLmdyaWRPcHRpb25zIGFzIEV4dGVuZGVkR3JpZE9wdGlvbnM7XG4gICAgXG4gICAgaWYgKCFoYXNNZW51Q29sdW1uICYmIGV4dGVuZGVkR3JpZE9wdGlvbnMubWVudUFjdGlvbnMgJiYgZXh0ZW5kZWRHcmlkT3B0aW9ucy5tZW51QWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBBZGQgY29tcGFjdCBob3Zlci1vbmx5IG1lbnUgY29sdW1uIGlmIG1lbnVBY3Rpb25zIGV4aXN0IGJ1dCBubyBtZW51IGNvbHVtbiBpcyBjb25maWd1cmVkXG4gICAgICB0aGlzLnByb2Nlc3NlZENvbHVtbkRlZnMucHVzaCh7XG4gICAgICAgIGhlYWRlck5hbWU6ICcnLFxuICAgICAgICBmaWVsZDogJ2FjdGlvbnMnLFxuICAgICAgICBzb3J0YWJsZTogZmFsc2UsXG4gICAgICAgIGZpbHRlcjogZmFsc2UsXG4gICAgICAgIHdpZHRoOiAzNixcbiAgICAgICAgbWluV2lkdGg6IDM2LFxuICAgICAgICBtYXhXaWR0aDogMzYsXG4gICAgICAgIHN1cHByZXNzU2l6ZVRvRml0OiB0cnVlLFxuICAgICAgICByZXNpemFibGU6IGZhbHNlLFxuICAgICAgICBwaW5uZWQ6ICdyaWdodCcsXG4gICAgICAgIGNlbGxDbGFzczogJ2FjdGlvbnMtY2VsbCcsXG4gICAgICAgIGhlYWRlckNsYXNzOiAnYWN0aW9ucy1oZWFkZXItY2VsbCcsXG4gICAgICAgIGNlbGxSZW5kZXJlcjogR3JpZE1lbnVSZW5kZXJlckNvbXBvbmVudCxcbiAgICAgICAgY2VsbFJlbmRlcmVyUGFyYW1zOiB7XG4gICAgICAgICAgbWVudUFjdGlvbnM6IGV4dGVuZGVkR3JpZE9wdGlvbnMubWVudUFjdGlvbnNcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChoYXNNZW51Q29sdW1uKSB7XG4gICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgbWVudSBjb2x1bW4gd2l0aCBjZWxsUmVuZGVyZXJcbiAgICAgIHRoaXMucHJvY2Vzc2VkQ29sdW1uRGVmcyA9IHRoaXMucHJvY2Vzc2VkQ29sdW1uRGVmcy5tYXAoY29sID0+IHtcbiAgICAgICAgaWYgKGNvbC5jZWxsUmVuZGVyZXIgPT09ICdncmlkTWVudScpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uY29sLFxuICAgICAgICAgICAgY2VsbFJlbmRlcmVyOiBHcmlkTWVudVJlbmRlcmVyQ29tcG9uZW50LFxuICAgICAgICAgICAgY2VsbFJlbmRlcmVyUGFyYW1zOiB7XG4gICAgICAgICAgICAgIG1lbnVBY3Rpb25zOiBleHRlbmRlZEdyaWRPcHRpb25zLm1lbnVBY3Rpb25zXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25TZWFyY2hDaGFuZ2UodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuc2VhcmNoVGV4dCA9IHZhbHVlO1xuICAgIC8vIFJlLWFwcGx5IHNlYXJjaCBvbiB0b3Agb2YgYWN0aXZlIGFkdmFuY2VkIGZpbHRlcnNcbiAgICBjb25zdCBiYXNlID0gdGhpcy5fYWN0aXZlRmlsdGVycyAmJiB0aGlzLl9hY3RpdmVGaWx0ZXJzLmxlbmd0aFxuICAgICAgPyAodGhpcy5yb3dEYXRhIHx8IFtdKS5maWx0ZXIociA9PiB0aGlzLl9hY3RpdmVGaWx0ZXJzIS5tYXAoZiA9PiB0aGlzLmV2YWx1YXRlRmlsdGVyKHIsIGYpKS5yZWR1Y2UoKGFjYywgY3VyKSA9PiB0aGlzLl9hY3RpdmVMb2dpYyA9PT0gJ0FORCcgPyBhY2MgJiYgY3VyIDogYWNjIHx8IGN1ciwgdGhpcy5fYWN0aXZlTG9naWMgPT09ICdBTkQnKSlcbiAgICAgIDogWy4uLih0aGlzLnJvd0RhdGEgfHwgW10pXTtcbiAgICB0aGlzLmZpbHRlcmVkUm93RGF0YSA9IHRoaXMuYXBwbHlTZWFyY2hUbyhiYXNlKTtcbiAgICB0aGlzLnNlYXJjaENoYW5nZS5lbWl0KHZhbHVlKTtcbiAgfVxuXG4gIHByaXZhdGUgYXBwbHlTZWFyY2hUbyhkYXRhOiBhbnlbXSk6IGFueVtdIHtcbiAgICBpZiAoIXRoaXMuc2VhcmNoVGV4dCB8fCAhdGhpcy5zZWFyY2hUZXh0LnRyaW0oKSkgcmV0dXJuIGRhdGE7XG4gICAgY29uc3Qgc2VhcmNoVGVybSA9IHRoaXMuc2VhcmNoVGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiAoZGF0YSB8fCBbXSkuZmlsdGVyKHJvdyA9PiBPYmplY3QudmFsdWVzKHJvdykuc29tZSh2YWx1ZSA9PiB2YWx1ZT8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaFRlcm0pKSk7XG4gIH1cblxuICBvbkZpbHRlckNsaWNrKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmJ1aWxkRmlsdGVyRGlhbG9nRGF0YSgpO1xuICAgIGNvbnN0IHJlZiA9IHRoaXMuZGlhbG9nYm94Lm9wZW5EaWFsb2coRmlsdGVyQ29tcG9uZW50LCB7IFxuICAgICAgdGl0bGU6ICdGaWx0ZXIgR3JpZCcsIFxuICAgICAgZGF0YSwgXG4gICAgICB3aWR0aDogJzkwMHB4JyBcbiAgICB9KTtcbiAgICByZWYuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUoKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5maWx0ZXJzKSB7XG4gICAgICAgIHRoaXMuYXBwbHlBZHZhbmNlZEZpbHRlcnMocmVzdWx0LmZpbHRlcnMsIHJlc3VsdC5sb2dpYyB8fCAnQU5EJyk7XG4gICAgICAgIHRoaXMuYWN0aXZlRmlsdGVyc0NvdW50ID0gcmVzdWx0LmZpbHRlcnMubGVuZ3RoO1xuICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlckNoaXBzKHJlc3VsdC5maWx0ZXJzKTtcbiAgICAgIH0gZWxzZSBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgICAgIC8vIERpYWxvZyB3YXMgY2FuY2VsbGVkIG9yIGNsZWFyZWRcbiAgICAgICAgdGhpcy5hY3RpdmVGaWx0ZXJzQ291bnQgPSAwO1xuICAgICAgICB0aGlzLmFjdGl2ZUZpbHRlckNoaXBzID0gW107XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkRmlsdGVyRGlhbG9nRGF0YSgpIHtcbiAgICBjb25zdCBleHRlbmRlZEdyaWRPcHRpb25zID0gdGhpcy5ncmlkT3B0aW9ucyBhcyBFeHRlbmRlZEdyaWRPcHRpb25zO1xuICAgIGNvbnN0IHByb3ZpZGVkID0gZXh0ZW5kZWRHcmlkT3B0aW9ucy5maWx0ZXJDb25maWcgfHwge307XG5cbiAgICBjb25zdCBmaWVsZHMgPSAocHJvdmlkZWQuZmllbGRzICYmIHByb3ZpZGVkLmZpZWxkcy5sZW5ndGggPyBwcm92aWRlZC5maWVsZHMgOiB0aGlzLmNvbHVtbkRlZnNcbiAgICAgIC5maWx0ZXIoY29sID0+ICEhY29sLmZpZWxkKVxuICAgICAgLm1hcChjb2wgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGxhYmVsOiBjb2wuaGVhZGVyTmFtZSB8fCAoY29sLmZpZWxkIGFzIHN0cmluZyksXG4gICAgICAgICAgdmFsdWU6IGNvbC5maWVsZCBhcyBzdHJpbmcsXG4gICAgICAgICAgaW5wdXRUeXBlOiB0aGlzLmRldGVjdElucHV0VHlwZShjb2wuZmllbGQgYXMgc3RyaW5nKVxuICAgICAgICB9O1xuICAgICAgfSkpO1xuXG4gICAgY29uc3QgdmFsdWVzTWFwOiB7IFtrZXk6IHN0cmluZ106IGFueVtdIH0gPSB7IC4uLihwcm92aWRlZC52YWx1ZXNNYXAgfHwge30pIH07XG4gICAgY29uc3Qgb3BlcmF0b3JzTWFwOiB7IFtrZXk6IHN0cmluZ106IEFycmF5PHsgbGFiZWw6IHN0cmluZzsgdmFsdWU6IHN0cmluZyB9Pn0gPSB7IC4uLihwcm92aWRlZC5vcGVyYXRvcnNNYXAgfHwge30pIH07XG5cbiAgICBmb3IgKGNvbnN0IGZpZWxkRGVmIG9mIGZpZWxkcykge1xuICAgICAgaWYgKGZpZWxkRGVmLmlucHV0VHlwZSA9PT0gJ3NlbGVjdCcpIHtcbiAgICAgICAgaWYgKCF2YWx1ZXNNYXBbZmllbGREZWYudmFsdWVdKSB7XG4gICAgICAgICAgdmFsdWVzTWFwW2ZpZWxkRGVmLnZhbHVlXSA9IHRoaXMuZ2V0VW5pcXVlVmFsdWVzKGZpZWxkRGVmLnZhbHVlLCAyMDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIW9wZXJhdG9yc01hcFtmaWVsZERlZi52YWx1ZV0pIHtcbiAgICAgICAgb3BlcmF0b3JzTWFwW2ZpZWxkRGVmLnZhbHVlXSA9IHRoaXMuZGVmYXVsdE9wZXJhdG9yc0J5VHlwZShmaWVsZERlZi5pbnB1dFR5cGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGluaXRpYWxGaWx0ZXJzID0gcHJvdmlkZWQuaW5pdGlhbEZpbHRlcnMgfHwgdGhpcy5fYWN0aXZlRmlsdGVycyB8fCBbXTtcbiAgICBjb25zdCBsb2dpYyA9IHByb3ZpZGVkLmxvZ2ljIHx8IHRoaXMuX2FjdGl2ZUxvZ2ljIHx8ICdBTkQnO1xuXG4gICAgcmV0dXJuIHsgZmllbGRzLCB2YWx1ZXNNYXAsIG9wZXJhdG9yc01hcCwgZmlsdGVyczogaW5pdGlhbEZpbHRlcnMsIGxvZ2ljIH07XG4gIH1cblxuICBwcml2YXRlIGRldGVjdElucHV0VHlwZShmaWVsZDogc3RyaW5nKTogJ3NlbGVjdCcgfCAnaW5wdXQnIHwgJ251bWJlcicgfCAnZGF0ZScgfCAnYm9vbGVhbicge1xuICAgIC8vIFByZWZlciBzZWxlY3Qgd2hlbiB1bmlxdWUgdmFsdWVzIGFyZSBzbWFsbFxuICAgIGNvbnN0IHVuaXF1ZXMgPSB0aGlzLmdldFVuaXF1ZVZhbHVlcyhmaWVsZCwgNTEpO1xuICAgIGlmICh1bmlxdWVzLmxlbmd0aCA+IDAgJiYgdW5pcXVlcy5sZW5ndGggPD0gNTApIHtcbiAgICAgIHJldHVybiAnc2VsZWN0JztcbiAgICB9XG4gICAgY29uc3Qgc2FtcGxlID0gdGhpcy5yb3dEYXRhICYmIHRoaXMucm93RGF0YS5sZW5ndGggPyB0aGlzLnJvd0RhdGFbMF1bZmllbGRdIDogdW5kZWZpbmVkO1xuICAgIGlmICh0eXBlb2Ygc2FtcGxlID09PSAnbnVtYmVyJykgcmV0dXJuICdudW1iZXInO1xuICAgIGlmICh0eXBlb2Ygc2FtcGxlID09PSAnYm9vbGVhbicpIHJldHVybiAnYm9vbGVhbic7XG4gICAgaWYgKHRoaXMubG9va3NMaWtlRGF0ZShzYW1wbGUpKSByZXR1cm4gJ2RhdGUnO1xuICAgIHJldHVybiAnaW5wdXQnO1xuICB9XG5cbiAgcHJpdmF0ZSBsb29rc0xpa2VEYXRlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcbiAgICBpZiAoIXZhbHVlKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkgcmV0dXJuIHRydWU7XG4gICAgY29uc3QgZHQgPSBuZXcgRGF0ZSh2YWx1ZSk7XG4gICAgcmV0dXJuICFpc05hTihkdC5nZXRUaW1lKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRVbmlxdWVWYWx1ZXMoZmllbGQ6IHN0cmluZywgbGltaXQ6IG51bWJlcik6IGFueVtdIHtcbiAgICBjb25zdCBzZXQgPSBuZXcgU2V0PGFueT4oKTtcbiAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLnJvd0RhdGEgfHwgW10pIHtcbiAgICAgIHNldC5hZGQocm93W2ZpZWxkXSk7XG4gICAgICBpZiAoc2V0LnNpemUgPj0gbGltaXQpIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbShzZXQpO1xuICB9XG5cbiAgcHJpdmF0ZSBkZWZhdWx0T3BlcmF0b3JzQnlUeXBlKHR5cGU6ICdzZWxlY3QnIHwgJ2lucHV0JyB8ICdudW1iZXInIHwgJ2RhdGUnIHwgJ2Jvb2xlYW4nKSB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIHsgbGFiZWw6ICdFcXVhbHMnLCB2YWx1ZTogJ2VxJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdOb3QgRXF1YWxzJywgdmFsdWU6ICduZXEnIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ0dyZWF0ZXIgVGhhbicsIHZhbHVlOiAnZ3QnIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ0dyZWF0ZXIgT3IgRXF1YWwnLCB2YWx1ZTogJ2d0ZScgfSxcbiAgICAgICAgICB7IGxhYmVsOiAnTGVzcyBUaGFuJywgdmFsdWU6ICdsdCcgfSxcbiAgICAgICAgICB7IGxhYmVsOiAnTGVzcyBPciBFcXVhbCcsIHZhbHVlOiAnbHRlJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdCZXR3ZWVuJywgdmFsdWU6ICdiZXR3ZWVuJyB9XG4gICAgICAgIF07XG4gICAgICBjYXNlICdkYXRlJzpcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICB7IGxhYmVsOiAnT24nLCB2YWx1ZTogJ2VxJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdCZWZvcmUnLCB2YWx1ZTogJ2x0JyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdBZnRlcicsIHZhbHVlOiAnZ3QnIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ0JldHdlZW4nLCB2YWx1ZTogJ2JldHdlZW4nIH1cbiAgICAgICAgXTtcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIHsgbGFiZWw6ICdJcycsIHZhbHVlOiAnZXEnIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ0lzIE5vdCcsIHZhbHVlOiAnbmVxJyB9XG4gICAgICAgIF07XG4gICAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgY2FzZSAnaW5wdXQnOlxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICB7IGxhYmVsOiAnQ29udGFpbnMnLCB2YWx1ZTogJ2NvbnRhaW5zJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdFcXVhbHMnLCB2YWx1ZTogJ2VxJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdOb3QgRXF1YWxzJywgdmFsdWU6ICduZXEnIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ1N0YXJ0cyBXaXRoJywgdmFsdWU6ICdzdGFydHNXaXRoJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdFbmRzIFdpdGgnLCB2YWx1ZTogJ2VuZHNXaXRoJyB9LFxuICAgICAgICAgIHsgbGFiZWw6ICdJcyBFbXB0eScsIHZhbHVlOiAnZW1wdHknIH0sXG4gICAgICAgICAgeyBsYWJlbDogJ0lzIE5vdCBFbXB0eScsIHZhbHVlOiAnbm90RW1wdHknIH1cbiAgICAgICAgXTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9hY3RpdmVGaWx0ZXJzOiBBcnJheTx7IGZpZWxkOiBzdHJpbmc7IG9wZXJhdG9yOiBzdHJpbmc7IHZhbHVlOiBhbnk7IHZhbHVlVG8/OiBhbnk7IGlucHV0VHlwZTogYW55IH0+ID0gW107XG4gIHByaXZhdGUgX2FjdGl2ZUxvZ2ljOiAnQU5EJyB8ICdPUicgPSAnQU5EJztcblxuICBwcml2YXRlIHVwZGF0ZUZpbHRlckNoaXBzKGZpbHRlcnM6IEFycmF5PHsgZmllbGQ6IHN0cmluZzsgb3BlcmF0b3I6IHN0cmluZzsgdmFsdWU6IGFueTsgdmFsdWVUbz86IGFueTsgaW5wdXRUeXBlOiBhbnkgfT4pOiB2b2lkIHtcbiAgICB0aGlzLmFjdGl2ZUZpbHRlckNoaXBzID0gZmlsdGVycy5tYXAoZiA9PiB7XG4gICAgICBjb25zdCBjb2x1bW4gPSB0aGlzLmNvbHVtbkRlZnMuZmluZChjb2wgPT4gY29sLmZpZWxkID09PSBmLmZpZWxkKTtcbiAgICAgIGNvbnN0IGxhYmVsID0gY29sdW1uPy5oZWFkZXJOYW1lIHx8IGYuZmllbGQ7XG4gICAgICBsZXQgdmFsdWUgPSBmLnZhbHVlO1xuICAgICAgXG4gICAgICBpZiAoZi5pbnB1dFR5cGUgPT09ICdib29sZWFuJykge1xuICAgICAgICB2YWx1ZSA9IGYudmFsdWUgPT09IHRydWUgfHwgZi52YWx1ZSA9PT0gJ3RydWUnID8gJ1llcycgOiAnTm8nO1xuICAgICAgfSBlbHNlIGlmIChmLmlucHV0VHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICAgIHZhbHVlID0gbmV3IERhdGUoZi52YWx1ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gICAgICB9IGVsc2UgaWYgKGYub3BlcmF0b3IgPT09ICdiZXR3ZWVuJyAmJiBmLnZhbHVlVG8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YWx1ZSA9IGAke2YudmFsdWV9IC0gJHtmLnZhbHVlVG99YDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGFiZWwsXG4gICAgICAgIHZhbHVlOiBTdHJpbmcodmFsdWUpLFxuICAgICAgICBmaWVsZDogZi5maWVsZFxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUZpbHRlckNoaXAoZmllbGQ6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuX2FjdGl2ZUZpbHRlcnMgPSB0aGlzLl9hY3RpdmVGaWx0ZXJzLmZpbHRlcihmID0+IGYuZmllbGQgIT09IGZpZWxkKTtcbiAgICB0aGlzLmFjdGl2ZUZpbHRlcnNDb3VudCA9IHRoaXMuX2FjdGl2ZUZpbHRlcnMubGVuZ3RoO1xuICAgIHRoaXMuYWN0aXZlRmlsdGVyQ2hpcHMgPSB0aGlzLmFjdGl2ZUZpbHRlckNoaXBzLmZpbHRlcihjaGlwID0+IGNoaXAuZmllbGQgIT09IGZpZWxkKTtcbiAgICBcbiAgICBpZiAodGhpcy5fYWN0aXZlRmlsdGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuZmlsdGVyZWRSb3dEYXRhID0gdGhpcy5hcHBseVNlYXJjaFRvKFsuLi4odGhpcy5yb3dEYXRhIHx8IFtdKV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFwcGx5QWR2YW5jZWRGaWx0ZXJzKHRoaXMuX2FjdGl2ZUZpbHRlcnMsIHRoaXMuX2FjdGl2ZUxvZ2ljKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFwcGx5QWR2YW5jZWRGaWx0ZXJzKGZpbHRlcnM6IGFueVtdLCBsb2dpYzogJ0FORCcgfCAnT1InKSB7XG4gICAgdGhpcy5fYWN0aXZlRmlsdGVycyA9IGZpbHRlcnM7XG4gICAgdGhpcy5fYWN0aXZlTG9naWMgPSBsb2dpYztcblxuICAgIGlmICghZmlsdGVycyB8fCBmaWx0ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5maWx0ZXJlZFJvd0RhdGEgPSB0aGlzLmFwcGx5U2VhcmNoVG8oWy4uLih0aGlzLnJvd0RhdGEgfHwgW10pXSk7XG4gICAgICB0aGlzLmFjdGl2ZUZpbHRlckNoaXBzID0gW107XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZXZhbHVhdG9yID0gKHJvdzogYW55KSA9PiB7XG4gICAgICBjb25zdCByZXN1bHRzID0gZmlsdGVycy5tYXAoZiA9PiB0aGlzLmV2YWx1YXRlRmlsdGVyKHJvdywgZikpO1xuICAgICAgcmV0dXJuIGxvZ2ljID09PSAnQU5EJyA/IHJlc3VsdHMuZXZlcnkoQm9vbGVhbikgOiByZXN1bHRzLnNvbWUoQm9vbGVhbik7XG4gICAgfTtcblxuICAgIGNvbnN0IGJhc2UgPSAodGhpcy5yb3dEYXRhIHx8IFtdKS5maWx0ZXIoZXZhbHVhdG9yKTtcbiAgICB0aGlzLmZpbHRlcmVkUm93RGF0YSA9IHRoaXMuYXBwbHlTZWFyY2hUbyhiYXNlKTtcbiAgfVxuXG4gIHByaXZhdGUgZXZhbHVhdGVGaWx0ZXIocm93OiBhbnksIGY6IHsgZmllbGQ6IHN0cmluZzsgb3BlcmF0b3I6IHN0cmluZzsgdmFsdWU6IGFueTsgdmFsdWVUbz86IGFueTsgaW5wdXRUeXBlOiBhbnkgfSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHJhdyA9IHJvd1tmLmZpZWxkXTtcbiAgICBjb25zdCBvcCA9IChmLm9wZXJhdG9yIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IHR5cGUgPSBmLmlucHV0VHlwZTtcblxuICAgIC8vIEhhbmRsZSBlbXB0eS9ub3RFbXB0eSB3aXRob3V0IHRvdWNoaW5nIHZhbHVlc1xuICAgIGlmIChvcCA9PT0gJ2VtcHR5JykgcmV0dXJuIHJhdyA9PT0gdW5kZWZpbmVkIHx8IHJhdyA9PT0gbnVsbCB8fCBTdHJpbmcocmF3KS50cmltKCkgPT09ICcnO1xuICAgIGlmIChvcCA9PT0gJ25vdGVtcHR5JykgcmV0dXJuICEocmF3ID09PSB1bmRlZmluZWQgfHwgcmF3ID09PSBudWxsIHx8IFN0cmluZyhyYXcpLnRyaW0oKSA9PT0gJycpO1xuXG4gICAgaWYgKHR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICBjb25zdCBhID0gTnVtYmVyKHJhdyk7XG4gICAgICBjb25zdCBiID0gTnVtYmVyKGYudmFsdWUpO1xuICAgICAgY29uc3QgYyA9IGYudmFsdWVUbyAhPT0gdW5kZWZpbmVkID8gTnVtYmVyKGYudmFsdWVUbykgOiB1bmRlZmluZWQ7XG4gICAgICBpZiAoaXNOYU4oYSkgfHwgaXNOYU4oYikpIHJldHVybiBmYWxzZTtcbiAgICAgIHN3aXRjaCAob3ApIHtcbiAgICAgICAgY2FzZSAnZXEnOiByZXR1cm4gYSA9PT0gYjtcbiAgICAgICAgY2FzZSAnbmVxJzogcmV0dXJuIGEgIT09IGI7XG4gICAgICAgIGNhc2UgJ2d0JzogcmV0dXJuIGEgPiBiO1xuICAgICAgICBjYXNlICdndGUnOiByZXR1cm4gYSA+PSBiO1xuICAgICAgICBjYXNlICdsdCc6IHJldHVybiBhIDwgYjtcbiAgICAgICAgY2FzZSAnbHRlJzogcmV0dXJuIGEgPD0gYjtcbiAgICAgICAgY2FzZSAnYmV0d2Vlbic6IHJldHVybiBjICE9PSB1bmRlZmluZWQgJiYgIWlzTmFOKGMpID8gYSA+PSBNYXRoLm1pbihiLCBjKSAmJiBhIDw9IE1hdGgubWF4KGIsIGMpIDogZmFsc2U7XG4gICAgICAgIGRlZmF1bHQ6IHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICBjb25zdCBhID0gdGhpcy50b0RhdGUocmF3KTtcbiAgICAgIGNvbnN0IGIgPSB0aGlzLnRvRGF0ZShmLnZhbHVlKTtcbiAgICAgIGNvbnN0IGMgPSBmLnZhbHVlVG8gPyB0aGlzLnRvRGF0ZShmLnZhbHVlVG8pIDogbnVsbDtcbiAgICAgIGlmICghYSB8fCAhYikgcmV0dXJuIGZhbHNlO1xuICAgICAgc3dpdGNoIChvcCkge1xuICAgICAgICBjYXNlICdlcSc6IHJldHVybiB0aGlzLnNhbWVEYXkoYSwgYik7XG4gICAgICAgIGNhc2UgJ2x0JzogcmV0dXJuIGEuZ2V0VGltZSgpIDwgYi5nZXRUaW1lKCk7XG4gICAgICAgIGNhc2UgJ2d0JzogcmV0dXJuIGEuZ2V0VGltZSgpID4gYi5nZXRUaW1lKCk7XG4gICAgICAgIGNhc2UgJ2JldHdlZW4nOiByZXR1cm4gISFjICYmIGEuZ2V0VGltZSgpID49IE1hdGgubWluKGIuZ2V0VGltZSgpLCBjLmdldFRpbWUoKSkgJiYgYS5nZXRUaW1lKCkgPD0gTWF0aC5tYXgoYi5nZXRUaW1lKCksIGMuZ2V0VGltZSgpKTtcbiAgICAgICAgZGVmYXVsdDogcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlID09PSAnYm9vbGVhbicpIHtcbiAgICAgIGNvbnN0IGEgPSBCb29sZWFuKHJhdyk7XG4gICAgICBjb25zdCBiID0gZi52YWx1ZSA9PT0gdHJ1ZSB8fCBmLnZhbHVlID09PSAndHJ1ZSc7XG4gICAgICBzd2l0Y2ggKG9wKSB7XG4gICAgICAgIGNhc2UgJ2VxJzogcmV0dXJuIGEgPT09IGI7XG4gICAgICAgIGNhc2UgJ25lcSc6IHJldHVybiBhICE9PSBiO1xuICAgICAgICBkZWZhdWx0OiByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gc3RyaW5nL3NlbGVjdFxuICAgIGNvbnN0IGEgPSAocmF3ID8/ICcnKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgYiA9IChmLnZhbHVlID8/ICcnKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XG4gICAgc3dpdGNoIChvcCkge1xuICAgICAgY2FzZSAnZXEnOiByZXR1cm4gYSA9PT0gYjtcbiAgICAgIGNhc2UgJ25lcSc6IHJldHVybiBhICE9PSBiO1xuICAgICAgY2FzZSAnY29udGFpbnMnOiByZXR1cm4gYS5pbmNsdWRlcyhiKTtcbiAgICAgIGNhc2UgJ3N0YXJ0c3dpdGgnOiByZXR1cm4gYS5zdGFydHNXaXRoKGIpO1xuICAgICAgY2FzZSAnZW5kc3dpdGgnOiByZXR1cm4gYS5lbmRzV2l0aChiKTtcbiAgICAgIGRlZmF1bHQ6IHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHRvRGF0ZSh2YWx1ZTogYW55KTogRGF0ZSB8IG51bGwge1xuICAgIGlmICghdmFsdWUpIHJldHVybiBudWxsO1xuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHJldHVybiB2YWx1ZTtcbiAgICBjb25zdCBkID0gbmV3IERhdGUodmFsdWUpO1xuICAgIHJldHVybiBpc05hTihkLmdldFRpbWUoKSkgPyBudWxsIDogZDtcbiAgfVxuXG4gIHByaXZhdGUgc2FtZURheShhOiBEYXRlLCBiOiBEYXRlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGEuZ2V0RnVsbFllYXIoKSA9PT0gYi5nZXRGdWxsWWVhcigpICYmIGEuZ2V0TW9udGgoKSA9PT0gYi5nZXRNb250aCgpICYmIGEuZ2V0RGF0ZSgpID09PSBiLmdldERhdGUoKTtcbiAgfVxuXG4gIC8vIE5ldyBncmlkIG1ldGhvZHMgZm9yIGVuaGFuY2VkIGZ1bmN0aW9uYWxpdHlcbiAgb25SZWZyZXNoKCk6IHZvaWQge1xuICAgIC8vIEVtaXQgcmVmcmVzaCBldmVudCBvciByZWxvYWQgZGF0YVxuICAgIHRoaXMuZmlsdGVyZWRSb3dEYXRhID0gWy4uLnRoaXMucm93RGF0YV07XG4gICAgY29uc29sZS5sb2coJ0dyaWQgcmVmcmVzaGVkJyk7XG4gIH1cblxuICBvbkV4cG9ydCgpOiB2b2lkIHtcbiAgICAvLyBFeHBvcnQgZ3JpZCBkYXRhIHRvIENTVlxuICAgIGNvbnN0IGNzdkNvbnRlbnQgPSB0aGlzLmV4cG9ydFRvQ1NWKCk7XG4gICAgdGhpcy5kb3dubG9hZENTVihjc3ZDb250ZW50LCAnZ3JpZC1kYXRhLmNzdicpO1xuICB9XG5cbiAgcHJpdmF0ZSBleHBvcnRUb0NTVigpOiBzdHJpbmcge1xuICAgIGlmICghdGhpcy5maWx0ZXJlZFJvd0RhdGEgfHwgdGhpcy5maWx0ZXJlZFJvd0RhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLy8gR2V0IGNvbHVtbiBoZWFkZXJzXG4gICAgY29uc3QgaGVhZGVycyA9IHRoaXMucHJvY2Vzc2VkQ29sdW1uRGVmc1xuICAgICAgLmZpbHRlcihjb2wgPT4gY29sLmZpZWxkICYmIGNvbC5maWVsZCAhPT0gJ2FjdGlvbnMnKVxuICAgICAgLm1hcChjb2wgPT4gY29sLmhlYWRlck5hbWUgfHwgY29sLmZpZWxkKTtcblxuICAgIC8vIEdldCBkYXRhIHJvd3NcbiAgICBjb25zdCByb3dzID0gdGhpcy5maWx0ZXJlZFJvd0RhdGEubWFwKGl0ZW0gPT4gXG4gICAgICB0aGlzLnByb2Nlc3NlZENvbHVtbkRlZnNcbiAgICAgICAgLmZpbHRlcihjb2wgPT4gY29sLmZpZWxkICYmIGNvbC5maWVsZCAhPT0gJ2FjdGlvbnMnKVxuICAgICAgICAubWFwKGNvbCA9PiB7XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBpdGVtW2NvbC5maWVsZCFdO1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gYFwiJHt2YWx1ZS5yZXBsYWNlKC9cIi9nLCAnXCJcIicpfVwiYCA6IHZhbHVlO1xuICAgICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBDb21iaW5lIGhlYWRlcnMgYW5kIHJvd3NcbiAgICBjb25zdCBjc3ZBcnJheSA9IFtoZWFkZXJzLCAuLi5yb3dzXTtcbiAgICByZXR1cm4gY3N2QXJyYXkubWFwKHJvdyA9PiByb3cuam9pbignLCcpKS5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIHByaXZhdGUgZG93bmxvYWRDU1YoY29udGVudDogc3RyaW5nLCBmaWxlbmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOiAndGV4dC9jc3Y7Y2hhcnNldD11dGYtODsnIH0pO1xuICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgXG4gICAgaWYgKGxpbmsuZG93bmxvYWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgdXJsKTtcbiAgICAgIGxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVuYW1lKTtcbiAgICAgIGxpbmsuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAgIGxpbmsuY2xpY2soKTtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7XG4gICAgfVxuICB9XG5cbiAgLy8gVmlldyBtb2RlIHN3aXRjaGluZ1xuICBzd2l0Y2hUb0xpc3RWaWV3KCk6IHZvaWQge1xuICAgIHRoaXMudmlld01vZGUgPSAnbGlzdCc7XG4gIH1cblxuICBzd2l0Y2hUb0NhcmRWaWV3KCk6IHZvaWQge1xuICAgIHRoaXMudmlld01vZGUgPSAnY2FyZCc7XG4gIH1cblxuICB0b2dnbGVWaWV3TW9kZSgpOiB2b2lkIHtcbiAgICB0aGlzLnZpZXdNb2RlID0gdGhpcy52aWV3TW9kZSA9PT0gJ2xpc3QnID8gJ2NhcmQnIDogJ2xpc3QnO1xuICB9XG5cbiAgb25Sb3dDbGlja2VkKGV2ZW50OiBhbnkpIHtcbiAgICBpZiAoIWV2ZW50IHx8ICFldmVudC5kYXRhKSByZXR1cm47XG4gICAgXG4gICAgLy8gSWYgcm93U2VsZWN0aW9uIGlzIGVuYWJsZWQsIHByb2dyYW1tYXRpY2FsbHkgc2VsZWN0IHRoZSByb3dcbiAgICBpZiAodGhpcy5ncmlkT3B0aW9ucy5yb3dTZWxlY3Rpb24gJiYgdGhpcy5ncmlkQXBpICYmIGV2ZW50Lm5vZGUpIHtcbiAgICAgIGlmICh0aGlzLmdyaWRPcHRpb25zLnJvd1NlbGVjdGlvbiA9PT0gJ3NpbmdsZScpIHtcbiAgICAgICAgLy8gRGVzZWxlY3QgYWxsIHJvd3MgZmlyc3QgZm9yIHNpbmdsZSBzZWxlY3Rpb25cbiAgICAgICAgdGhpcy5ncmlkQXBpLmRlc2VsZWN0QWxsKCk7XG4gICAgICB9XG4gICAgICAvLyBUb2dnbGUgc2VsZWN0aW9uIG9uIHRoZSBjbGlja2VkIHJvd1xuICAgICAgZXZlbnQubm9kZS5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICB9XG4gICAgXG4gICAgdGhpcy5yb3dDbGlja2VkLmVtaXQoZXZlbnQuZGF0YSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5kYXRhRmV0Y2hTdWIpIHtcbiAgICAgIHRoaXMuZGF0YUZldGNoU3ViLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzaG91bGRGZXRjaEZyb21BcGkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICghdGhpcy5yb3dEYXRhIHx8IHRoaXMucm93RGF0YS5sZW5ndGggPT09IDApICYmICEhdGhpcy5hcGlDb25maWc/LmRhdGFDb25maWc7XG4gIH1cblxuICBwcml2YXRlIGZldGNoR3JpZERhdGFGcm9tQXBpKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5hcGlDb25maWc/LmRhdGFDb25maWcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBsaW1pdHMgPSB0aGlzLmdldFBhZ2luYXRpb25MaW1pdHMoKTtcbiAgICBjb25zdCBkYXRhUmVxdWVzdCQgPSB0aGlzLnNlbmRBcGlSZXF1ZXN0KHRoaXMuYXBpQ29uZmlnLmRhdGFDb25maWcsIGxpbWl0cylcbiAgICAgIC5waXBlKGNhdGNoRXJyb3IoKCkgPT4gb2Yoe30pKSk7XG4gICAgY29uc3QgY291bnRSZXF1ZXN0JCA9IHRoaXMuYXBpQ29uZmlnLmNvdW50Q29uZmlnXG4gICAgICA/IHRoaXMuc2VuZEFwaVJlcXVlc3QodGhpcy5hcGlDb25maWcuY291bnRDb25maWcsIGxpbWl0cykucGlwZShjYXRjaEVycm9yKCgpID0+IG9mKHt9KSkpXG4gICAgICA6IG9mKG51bGwpO1xuXG4gICAgaWYgKHRoaXMuZGF0YUZldGNoU3ViKSB7XG4gICAgICB0aGlzLmRhdGFGZXRjaFN1Yi51bnN1YnNjcmliZSgpO1xuICAgIH1cblxuICAgIHRoaXMuZGF0YUZldGNoU3ViID0gZm9ya0pvaW4oeyBkYXRhOiBkYXRhUmVxdWVzdCQsIGNvdW50OiBjb3VudFJlcXVlc3QkIH0pLnN1YnNjcmliZSgocmVzcG9uc2UpID0+IHtcbiAgICAgIGNvbnN0IHJvd3MgPSB0aGlzLmV4dHJhY3REYXRhQXJyYXkocmVzcG9uc2UuZGF0YSk7XG4gICAgICBjb25zdCBjb3VudCA9IHRoaXMuZXh0cmFjdENvdW50KHJlc3BvbnNlLmNvdW50KTtcbiAgICAgIHRoaXMuYXBwbHlGZXRjaGVkRGF0YShyb3dzLCBjb3VudCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHNlbmRBcGlSZXF1ZXN0KGNvbmZpZzogR3JpZEFwaVJlcXVlc3RDb25maWcsIGxpbWl0cz86IHsgbG93ZXI6IG51bWJlcjsgdXBwZXI6IG51bWJlciB9KSB7XG4gICAgY29uc3QgdXJsID0gdGhpcy5hcHBlbmRRdWVyeVBhcmFtcyh0aGlzLmJ1aWxkVXJsKGNvbmZpZy51cmwpLCBjb25maWcsIGxpbWl0cyk7XG4gICAgY29uc3QgbWV0aG9kID0gKGNvbmZpZy5yZXF1ZXN0VHlwZSB8fCAnR0VUJykudG9VcHBlckNhc2UoKTtcblxuICAgIGlmIChtZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgY29uc3QgcGF5bG9hZCA9IHRoaXMuYnVpbGRQYXlsb2FkKGNvbmZpZywgbGltaXRzKTtcbiAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh1cmwsIHBheWxvYWQpO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMuYnVpbGRIdHRwUGFyYW1zKGNvbmZpZywgbGltaXRzKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCh1cmwsIHsgcGFyYW1zIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBidWlsZFBheWxvYWQoY29uZmlnOiBHcmlkQXBpUmVxdWVzdENvbmZpZywgbGltaXRzPzogeyBsb3dlcjogbnVtYmVyOyB1cHBlcjogbnVtYmVyIH0pIHtcbiAgICBjb25zdCBwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgICAgLi4uKGNvbmZpZy5wYXJhbXMgfHwge30pXG4gICAgfTtcblxuICAgIGlmIChsaW1pdHMpIHtcbiAgICAgIGNvbnN0IGxvd2VyS2V5ID0gY29uZmlnLmxMaW1pdEtleSB8fCAnbGxpbWl0JztcbiAgICAgIGNvbnN0IHVwcGVyS2V5ID0gY29uZmlnLnVMaW1pdEtleSB8fCAndWxpbWl0JztcbiAgICAgIHBheWxvYWRbbG93ZXJLZXldID0gbGltaXRzLmxvd2VyO1xuICAgICAgcGF5bG9hZFt1cHBlcktleV0gPSBsaW1pdHMudXBwZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbmZpZy5zdXBwcmVzc051bGxWYWx1ZXMgPyB0aGlzLnN0cmlwTnVsbGlzaChwYXlsb2FkKSA6IHBheWxvYWQ7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkSHR0cFBhcmFtcyhjb25maWc6IEdyaWRBcGlSZXF1ZXN0Q29uZmlnLCBsaW1pdHM/OiB7IGxvd2VyOiBudW1iZXI7IHVwcGVyOiBudW1iZXIgfSkge1xuICAgIGNvbnN0IHBhcmFtczogUmVjb3JkPHN0cmluZywgYW55PiA9IHtcbiAgICAgIC4uLihjb25maWcucGFyYW1zIHx8IHt9KVxuICAgIH07XG5cbiAgICBpZiAobGltaXRzKSB7XG4gICAgICBjb25zdCBsb3dlcktleSA9IGNvbmZpZy5sTGltaXRLZXkgfHwgJ2xsaW1pdCc7XG4gICAgICBjb25zdCB1cHBlcktleSA9IGNvbmZpZy51TGltaXRLZXkgfHwgJ3VsaW1pdCc7XG4gICAgICBwYXJhbXNbbG93ZXJLZXldID0gbGltaXRzLmxvd2VyO1xuICAgICAgcGFyYW1zW3VwcGVyS2V5XSA9IGxpbWl0cy51cHBlcjtcbiAgICB9XG5cbiAgICBjb25zdCBjbGVhbmVkID0gY29uZmlnLnN1cHByZXNzTnVsbFZhbHVlcyA/IHRoaXMuc3RyaXBOdWxsaXNoKHBhcmFtcykgOiBwYXJhbXM7XG4gICAgbGV0IGh0dHBQYXJhbXMgPSBuZXcgSHR0cFBhcmFtcygpO1xuICAgIE9iamVjdC5lbnRyaWVzKGNsZWFuZWQpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgaHR0cFBhcmFtcyA9IGh0dHBQYXJhbXMuYXBwZW5kKGtleSwgU3RyaW5nKHZhbHVlKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGh0dHBQYXJhbXM7XG4gIH1cblxuICBwcml2YXRlIHN0cmlwTnVsbGlzaChvYmo6IFJlY29yZDxzdHJpbmcsIGFueT4pIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMob2JqKS5yZWR1Y2U8UmVjb3JkPHN0cmluZywgYW55Pj4oKGFjYywgW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBhY2Nba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG4gIH1cblxuICBwcml2YXRlIGFwcGVuZFF1ZXJ5UGFyYW1zKHVybDogc3RyaW5nLCBjb25maWc6IEdyaWRBcGlSZXF1ZXN0Q29uZmlnLCBsaW1pdHM/OiB7IGxvd2VyOiBudW1iZXI7IHVwcGVyOiBudW1iZXIgfSkge1xuICAgIGlmICghY29uZmlnLnF1ZXJ5UGFyYW1zVXJsKSB7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cblxuICAgIGNvbnN0IGxvd2VyID0gbGltaXRzPy5sb3dlciA/PyAnJztcbiAgICBjb25zdCB1cHBlciA9IGxpbWl0cz8udXBwZXIgPz8gJyc7XG4gICAgY29uc3QgcXVlcnkgPSBjb25maWcucXVlcnlQYXJhbXNVcmxcbiAgICAgIC5yZXBsYWNlKC9cXCRsbGltaXQvZ2ksIFN0cmluZyhsb3dlcikpXG4gICAgICAucmVwbGFjZSgvXFwkdWxpbWl0L2dpLCBTdHJpbmcodXBwZXIpKTtcblxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VwYXJhdG9yID0gdXJsLmluY2x1ZGVzKCc/JykgPyAnJicgOiAnPyc7XG4gICAgcmV0dXJuIGAke3VybH0ke3NlcGFyYXRvcn0ke3F1ZXJ5fWA7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkVXJsKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgYmFzZSA9IHRoaXMuYXBpQ29uZmlnU2VydmljZS5nZXRBcGlVcmwoKTtcbiAgICBpZiAoIWJhc2UpIHtcbiAgICAgIHJldHVybiBwYXRoO1xuICAgIH1cbiAgICByZXR1cm4gYCR7YmFzZS5yZXBsYWNlKC9cXC8kLywgJycpfS8ke3BhdGgucmVwbGFjZSgvXlxcLy8sICcnKX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0RGF0YUFycmF5KHJlc3BvbnNlOiBhbnkpOiBhbnlbXSB7XG4gICAgaWYgKCFyZXNwb25zZSkgcmV0dXJuIFtdO1xuICAgIGNvbnN0IGNhc3RlZCA9IHJlc3BvbnNlIGFzIEdyaWRBcGlEYXRhUmVzcG9uc2U8YW55PjtcbiAgICByZXR1cm4gY2FzdGVkLmRhdGEgfHwgY2FzdGVkLnJlc3VsdCB8fCBjYXN0ZWQucmVjb3JkcyB8fCBjYXN0ZWQuaXRlbXMgfHwgW107XG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RDb3VudChyZXNwb25zZTogYW55KTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXJlc3BvbnNlKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIGNvbnN0IGNhc3RlZCA9IHJlc3BvbnNlIGFzIEdyaWRBcGlDb3VudFJlc3BvbnNlO1xuICAgIHJldHVybiBjYXN0ZWQuY291bnQgPz8gY2FzdGVkLnRvdGFsQ291bnQgPz8gY2FzdGVkLnRvdGFsO1xuICB9XG5cbiAgcHJpdmF0ZSBhcHBseUZldGNoZWREYXRhKHJvd3M6IGFueVtdLCB0b3RhbENvdW50PzogbnVtYmVyKSB7XG4gICAgdGhpcy5yb3dEYXRhID0gQXJyYXkuaXNBcnJheShyb3dzKSA/IHJvd3MgOiBbXTtcbiAgICB0aGlzLmZpbHRlcmVkUm93RGF0YSA9IHRoaXMuYXBwbHlTZWFyY2hUbyhbLi4udGhpcy5yb3dEYXRhXSk7XG4gICAgdGhpcy50b3RhbFJvd3MgPSB0b3RhbENvdW50ID8/IHRoaXMucm93RGF0YS5sZW5ndGg7XG4gICAgdGhpcy5kaXNwbGF5ZWRSb3dzID0gdGhpcy5maWx0ZXJlZFJvd0RhdGEubGVuZ3RoO1xuICAgIHRoaXMucHJvY2Vzc0NvbHVtbkRlZnMoKTtcbiAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb25JbmZvKCk7XG4gIH1cblxuICBwcml2YXRlIGdldFBhZ2luYXRpb25MaW1pdHMoKSB7XG4gICAgY29uc3QgcGFnZVNpemUgPSB0aGlzLmdyaWRPcHRpb25zLnBhZ2luYXRpb25QYWdlU2l6ZSB8fCAyNTtcbiAgICBjb25zdCBsb3dlciA9IDA7XG4gICAgY29uc3QgdXBwZXIgPSBsb3dlciArIHBhZ2VTaXplO1xuICAgIHJldHVybiB7IGxvd2VyLCB1cHBlciB9O1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwiZ3JpZC1jb250YWluZXJcIj5cbiAgPCEtLSBDbGVhbiBHcmlkIFRvb2xiYXIgLS0+XG4gIDxkaXYgY2xhc3M9XCJncmlkLXRvb2xiYXJcIiAqbmdJZj1cInNob3dIZWFkZXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwidG9vbGJhci1sZWZ0XCI+XG4gICAgICA8c3BhbiBjbGFzcz1cInBhZ2luYXRpb24taW5mb1wiPkRpc3BsYXlpbmcge3sgZGlzcGxheWVkUm93cyB9fSBvZiB7eyB0b3RhbFJvd3MgfX08L3NwYW4+XG4gICAgICBcbiAgICAgIDwhLS0gRmlsdGVyIENoaXBzIC0tPlxuICAgICAgPGRpdiBjbGFzcz1cImZpbHRlci1jaGlwc1wiICpuZ0lmPVwiYWN0aXZlRmlsdGVyQ2hpcHMubGVuZ3RoID4gMFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmlsdGVyLWNoaXBcIiAqbmdGb3I9XCJsZXQgY2hpcCBvZiBhY3RpdmVGaWx0ZXJDaGlwc1wiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2hpcC1sYWJlbFwiPnt7IGNoaXAubGFiZWwgfX06PC9zcGFuPlxuICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2hpcC12YWx1ZVwiPnt7IGNoaXAudmFsdWUgfX08L3NwYW4+XG4gICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjaGlwLXJlbW92ZVwiIChjbGljayk9XCJyZW1vdmVGaWx0ZXJDaGlwKGNoaXAuZmllbGQpXCIgdGl0bGU9XCJSZW1vdmUgZmlsdGVyXCIgYXJpYS1sYWJlbD1cIlJlbW92ZSBmaWx0ZXJcIj7DlzwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIFxuICAgIDxkaXYgY2xhc3M9XCJ0b29sYmFyLWNlbnRlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cInNlYXJjaC1zZWN0aW9uXCI+XG4gICAgICAgIDxhcHAtaW5wdXRcbiAgICAgICAgICBbcGxhY2Vob2xkZXJdPVwic2VhcmNoUGxhY2Vob2xkZXJcIlxuICAgICAgICAgIFt2YWx1ZV09XCJzZWFyY2hUZXh0XCJcbiAgICAgICAgICBbcHJlZml4SWNvbk5hbWVdPVwiJ3NlYXJjaCdcIlxuICAgICAgICAgICh2YWx1ZUNoYW5nZSk9XCJvblNlYXJjaENoYW5nZSgkZXZlbnQpXCJcbiAgICAgICAgICBbc2VhcmNoXT1cInRydWVcIlxuICAgICAgICAgIGNsYXNzPVwic2VhcmNoLWlucHV0XCI+XG4gICAgICAgIDwvYXBwLWlucHV0PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgXG4gICAgPGRpdiBjbGFzcz1cInRvb2xiYXItcmlnaHRcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJhY3Rpb24taWNvbnNcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInJpZ2h0VG9vbHRlbXBsYXRlUmVmXCI+PC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPCEtLSBPbmx5IGtlZXAgRmlsdGVyIGljb24gZm9yIG5vdyAtLT5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGNsYXNzPVwiaWNvbi1idG4gZmlsdGVyLWJ0blwiXG4gICAgICAgICAgKGNsaWNrKT1cIm9uRmlsdGVyQ2xpY2soKVwiXG4gICAgICAgICAgdGl0bGU9XCJGaWx0ZXJcIlxuICAgICAgICAgIFtjbGFzcy5hY3RpdmVdPVwiYWN0aXZlRmlsdGVyc0NvdW50ID4gMFwiPlxuICAgICAgICAgIDxtYXQtaWNvbj50dW5lPC9tYXQtaWNvbj5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gIFxuICA8IS0tIEdyaWQgQ29udGVudCAtLT5cbiAgPGRpdiBjbGFzcz1cImdyaWQtY29udGVudFwiPlxuICAgIDxkaXYgY2xhc3M9XCJncmlkLXdyYXBwZXJcIj5cbiAgICAgIDwhLS0gTGlzdCBWaWV3IChBRy1HcmlkKSAtLT5cbiAgICAgIDxhZy1ncmlkLWFuZ3VsYXJcbiAgICAgICAgKm5nSWY9XCJpc0Jyb3dzZXIgJiYgdmlld01vZGUgPT09ICdsaXN0J1wiXG4gICAgICAgIFtyb3dEYXRhXT1cImZpbHRlcmVkUm93RGF0YVwiXG4gICAgICAgIGNsYXNzPVwiY2xlYW4tZ3JpZCBhZy10aGVtZS1jbGVhblwiXG4gICAgICAgIFtjb2x1bW5EZWZzXT1cInByb2Nlc3NlZENvbHVtbkRlZnNcIlxuICAgICAgICBbZ3JpZE9wdGlvbnNdPVwiZ3JpZE9wdGlvbnNcIlxuICAgICAgICBbZG9tTGF5b3V0XT1cImRvbUxheW91dFwiXG4gICAgICAgIFthbmltYXRlUm93c109XCJhbmltYXRlUm93c1wiXG4gICAgICAgIFtjbGFzc109XCJjbGFzc1wiXG4gICAgICAgIFtjbGFzcy5oYXMtcm93LXNlbGVjdGlvbl09XCJncmlkT3B0aW9ucy5yb3dTZWxlY3Rpb25cIlxuICAgICAgICBbc3R5bGUud2lkdGhdPVwid2lkdGhcIlxuICAgICAgICBbc3R5bGUuaGVpZ2h0XT1cIicxMDAlJ1wiXG4gICAgICAgIChncmlkUmVhZHkpPVwib25HcmlkUmVhZHkoJGV2ZW50KVwiXG4gICAgICAgIChtb2RlbFVwZGF0ZWQpPVwib25Nb2RlbFVwZGF0ZWQoJGV2ZW50KVwiXG4gICAgICAgIChyb3dDbGlja2VkKT1cIm9uUm93Q2xpY2tlZCgkZXZlbnQpXCI+XG4gICAgICA8L2FnLWdyaWQtYW5ndWxhcj5cblxuICAgICAgPCEtLSBDYXJkIFZpZXcgKEN1c3RvbSBUZW1wbGF0ZSkgLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1ncmlkXCIgKm5nSWY9XCJpc0Jyb3dzZXIgJiYgdmlld01vZGUgPT09ICdjYXJkJyAmJiBjYXJkVGVtcGxhdGVcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgaXRlbSBvZiBmaWx0ZXJlZFJvd0RhdGFcIj5cbiAgICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY2FyZFRlbXBsYXRlOyBjb250ZXh0OiB7ICRpbXBsaWNpdDogaXRlbSB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgICBcbiAgICAgIDwhLS0gTG9hZGluZyBTdGF0ZSAtLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJncmlkLWxvYWRpbmdcIiAqbmdJZj1cIiFpc0Jyb3dzZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImxvYWRpbmctc3Bpbm5lclwiPjwvZGl2PlxuICAgICAgICA8c3Bhbj5Mb2FkaW5nIGdyaWQuLi48L3NwYW4+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L2Rpdj5cbiJdfQ==