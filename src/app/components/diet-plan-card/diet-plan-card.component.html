<div class="diet-plan-card">
  <button type="button" class="card-top" (click)="onCardClick()" (keydown)="onKeyActivate($event)">
    <div class="card-header">
      <h3 class="card-title">{{ plan.name }}</h3>
      <span class="status-pill" [class.active]="isActive">{{ plan.status }}</span>
    </div>

    <p class="card-description" *ngIf="plan.description">{{ plan.description }}</p>

    <div class="divider"></div>

    <div class="stats-grid">
      <div class="stat">
        <mat-icon class="stat-icon">groups</mat-icon>
        <div class="stat-text">
          <div class="stat-label">Duration</div>
          <div class="stat-value">{{ plan.duration }} Days</div>
        </div>
      </div>

      <div class="stat">
        <mat-icon class="stat-icon">schedule</mat-icon>
        <div class="stat-text">
          <div class="stat-label">Total Diets</div>
          <div class="stat-value">{{ plan.dietsCount || 0 }} Diets</div>
        </div>
      </div>

      <div class="stat">
        <mat-icon class="stat-icon">my_location</mat-icon>
        <div class="stat-text">
          <div class="stat-label">Goal</div>
          <div class="stat-value">{{ plan.goal || '—' }}</div>
        </div>
      </div>

      <div class="stat">
        <mat-icon class="stat-icon">calendar_month</mat-icon>
        <div class="stat-text">
          <div class="stat-label">Progress</div>
          <div class="stat-value">{{ plan.progress ?? 0 }}%</div>
        </div>
      </div>
    </div>
  </button>

  <div class="meals-section">
    <div class="meals-header">
      <div class="meals-title">Meals Included</div>
    </div>

    <div class="meal-list" *ngIf="plan.mealsIncluded && plan.mealsIncluded.length > 0">
      <div class="meal-item" *ngFor="let meal of plan.mealsIncluded">
        <div class="meal-thumb">
          <img *ngIf="meal.imageUrl" [src]="meal.imageUrl" [alt]="meal.title" />
          <div class="thumb-placeholder" *ngIf="!meal.imageUrl">
            <mat-icon>restaurant</mat-icon>
          </div>
        </div>
        <div class="meal-content">
          <div class="meal-name">{{ meal.title }}</div>
          <div class="meal-subtitle" *ngIf="meal.subtitle">{{ meal.subtitle }}</div>
          <div class="meal-tags" *ngIf="meal.tags && meal.tags.length > 0">
            {{ meal.tags.join('  •  ') }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card-footer" *ngIf="showFooter">
    <div class="reviewed">
      <div class="reviewed-label">Reviewed By</div>
      <div class="reviewed-meta">
        {{ plan.reviewedByName || '—' }}
        <span class="dot" *ngIf="plan.reviewedAt">•</span>
        <span class="reviewed-date" *ngIf="plan.reviewedAt">{{ formatReviewedAt(plan.reviewedAt) }}</span>
      </div>
    </div>

    <div class="footer-actions" *ngIf="showActions">
      <button mat-icon-button (click)="onView($event)" matTooltip="View">
        <mat-icon>visibility</mat-icon>
      </button>
      <button mat-icon-button (click)="onEdit($event)" matTooltip="Edit">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button (click)="onDelete($event)" matTooltip="Delete">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>
</div>


