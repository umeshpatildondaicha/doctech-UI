<div class="exercise-list-widget">
  <!-- Filters Section -->
  @if (config.showFilters) {
    <div class="filters-section">
      <div class="filters-header">
        <h3>Filter Exercises</h3>
        <div class="results-count">
          Showing {{ getFilteredExercises().length }} of {{ exercises.length }} exercises
        </div>
      </div>
      <div class="filters-content">
        <div class="filter-group">
          <label class="filter-label">Category</label>
          <mat-form-field appearance="outline" class="filter-field">
            <mat-select [(ngModel)]="selectedCategory">
              @for (category of categories; track category) {
                <mat-option [value]="category.value">
                  {{ category.label }}
                </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
        <div class="filter-group">
          <label class="filter-label">Difficulty</label>
          <mat-form-field appearance="outline" class="filter-field">
            <mat-select [(ngModel)]="selectedDifficulty">
              @for (difficulty of difficulties; track difficulty) {
                <mat-option [value]="difficulty.value">
                  {{ difficulty.label }}
                </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
        <div class="filter-group search-group">
          <label class="filter-label">Search</label>
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Search exercises...</mat-label>
            <input matInput [(ngModel)]="searchQuery" placeholder="Search by name, description, or muscles">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </div>
        <div class="filter-actions">
          <app-button
            type="button"
            class="clear-filters-btn"
            [fontIcon]="'clear_all'"
            [text]="'Clear Filters'"
            [appearance]="'flat'"
            (btnClick)="clearFilters()">
          </app-button>
        </div>
      </div>
    </div>
  }

  <!-- Exercise Groups View -->
  @if (config.showGroupView && exerciseGroups && exerciseGroups.length > 0) {
    <div class="groups-section">
      <div class="groups-header">
        <h3>Exercise Groups</h3>
        <p class="groups-count">{{ getFilteredGroups().length }} groups available</p>
      </div>
      <div class="groups-grid">
        @for (group of getFilteredGroups(); track group) {
          <mat-card class="group-card">
            <div class="group-card-header">
              <div class="group-info">
                <h4 class="group-name">{{ group.name }}</h4>
                <p class="group-exercise-count">{{ group.exercises?.length || 0 }} exercises</p>
              </div>
              @if (config.allowSelection) {
                <app-button
                  type="button"
                  class="select-group-btn"   
                  text="'Add Group'"
                  (btnClick)="onSelectGroup(group)">
                </app-button>
              }
            </div>
          </mat-card>
        }
      </div>
    </div>
  }

  <!-- Exercise Cards View -->
  @if (viewMode === 'cards') {
    <div class="exercise-cards-view">
      @if (getFilteredExercises().length > 0) {
        <div class="cards-grid">
          @for (exercise of getFilteredExercises(); track exercise) {
            <app-exercise-card
              [exercise]="exercise"
              [showActions]="config.showActions ?? true"
              [clickable]="!(config.allowSelection ?? false)"
              [allowSelection]="config.allowSelection ?? false"
              [isSelected]="isExerciseSelected(exercise)"
              (cardClick)="onViewExercise(exercise)"
              (viewClick)="onViewExercise(exercise)"
              (editClick)="onEditExercise(exercise)"
              (deleteClick)="onDeleteExercise(exercise)"
              (selectClick)="onSelectExercise(exercise)">
            </app-exercise-card>
          }
        </div>
      } @else {
        <div class="no-results">
          <mat-card class="no-results-card">
            <div class="no-results-content">
              <mat-icon class="no-results-icon">search_off</mat-icon>
              <h3>No exercises found</h3>
              <p>Try adjusting your search criteria or filters</p>
              <button mat-stroked-button (click)="clearFilters()">
                Clear Filters
              </button>
            </div>
          </mat-card>
        </div>
      }
    </div>
  }

  <!-- Exercise List View -->
  @if (viewMode === 'list') {
    <div class="exercise-list-view">
      @if (getFilteredExercises().length > 0) {
        <div class="list-items">
          @for (exercise of getFilteredExercises(); track exercise) {
            <div
              class="list-item"
              [class.selected]="isExerciseSelected(exercise)">
              <div class="item-media">
                @if (exercise.imageUrl) {
                  <img [src]="exercise.imageUrl" [alt]="exercise.name">
                }
                @if (!exercise.imageUrl) {
                  <div class="media-placeholder">
                    <mat-icon>fitness_center</mat-icon>
                  </div>
                }
              </div>
              <div class="item-content">
                <h4 class="item-name">{{ exercise.name }}</h4>
                <p class="item-description">{{ exercise.description }}</p>
                <div class="item-meta">
                  <mat-chip class="category-chip">{{ exercise.category }}</mat-chip>
                  <span class="difficulty-text">{{ exercise.difficulty }}</span>
                  <span class="sets-info">{{ getSetsDisplay(exercise) }}</span>
                </div>
              </div>
              <div class="item-actions">
                @if (config.allowSelection) {
                  <button
                    mat-icon-button
                    [color]="isExerciseSelected(exercise) ? 'warn' : 'primary'"
                    (click)="onSelectExercise(exercise)"
                    [matTooltip]="isExerciseSelected(exercise) ? 'Remove' : 'Add'">
                    <mat-icon>{{ isExerciseSelected(exercise) ? 'remove_circle' : 'add_circle' }}</mat-icon>
                  </button>
                }
                @if (config.showActions && !config.allowSelection) {
                  <button
                    mat-icon-button
                    color="primary"
                    (click)="onViewExercise(exercise)"
                    matTooltip="View">
                    <mat-icon>visibility</mat-icon>
                  </button>
                }
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="no-results">
          <mat-card class="no-results-card">
            <div class="no-results-content">
              <mat-icon class="no-results-icon">search_off</mat-icon>
              <h3>No exercises found</h3>
              <p>Try adjusting your search criteria or filters</p>
              <button mat-stroked-button (click)="clearFilters()">
                Clear Filters
              </button>
            </div>
          </mat-card>
        </div>
      }
    </div>
  }

  <!-- No Results Template -->
</div>


