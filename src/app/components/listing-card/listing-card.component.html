<div
  class="listing-card"
  [class.clickable]="clickable"
  [class.compact]="variant === 'compact'"
  (click)="onCardClick()"
  (keydown)="onKeyActivate($event)"
  [attr.tabindex]="clickable ? 0 : -1"
  [attr.role]="clickable ? 'button' : null"
  >
  <div class="card-media">
    @if (imageUrl) {
      <img [src]="imageUrl" [alt]="alt || title" />
    }
    @if (!imageUrl) {
      <div class="media-placeholder">
        <mat-icon>{{ placeholderIcon }}</mat-icon>
        <span>{{ placeholderText }}</span>
      </div>
    }

    @if (topLeftBadge?.text) {
      <div
        class="card-badge badge-left"
        [ngClass]="topLeftBadge?.className"
        [ngStyle]="badgeStyle(topLeftBadge) || undefined"
        >
        {{ topLeftBadge?.text }}
      </div>
    }

    @if (topRightBadge?.text) {
      <div
        class="card-badge badge-right"
        [ngClass]="topRightBadge?.className"
        [ngStyle]="badgeStyle(topRightBadge) || undefined"
        >
        {{ topRightBadge?.text }}
      </div>
    }

    @if (showSelectionIndicator && selected) {
      <div class="selection-indicator">
        <mat-icon>{{ selectionIcon }}</mat-icon>
      </div>
    }
  </div>

  <div class="card-content">
    <h3 class="card-title">{{ title }}</h3>
    @if (description) {
      <p class="card-description">{{ description }}</p>
    }

    <!-- Optional projected content (for future variants) -->
    <ng-content></ng-content>

    @if (stats && stats.length > 0) {
      <div class="stats-grid">
        @for (stat of stats; track trackByStatLabel($index, stat)) {
          <div class="stat-item">
            @if (stat.icon) {
              <mat-icon class="stat-icon">{{ stat.icon }}</mat-icon>
            }
            <div class="stat-text">
              <div class="stat-label">{{ stat.label }}</div>
              <div class="stat-value">
                {{ stat.value }}@if (stat.unit) {
                <span class="stat-unit">&nbsp;{{ stat.unit }}</span>
              }
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>

@if (primaryAction || (iconActions && iconActions.length > 0)) {
  <div class="card-footer">
    @if (primaryAction && !primaryAction.hidden) {
      <app-button
  class="primary-footer-action"
  appearance="raised"
  [disabled]="primaryAction.disabled || false"
  [matTooltip]="primaryAction.tooltip || ''"
  [matTooltipDisabled]="!primaryAction.tooltip"
  (click)="onActionClick($event, primaryAction)">

  <mat-icon>{{ primaryAction.icon }}</mat-icon>
  <span>{{ primaryAction.label }}</span>
</app-button>

    }
    @if (iconActions && iconActions.length > 0) {
      <div class="icon-actions">
        @for (action of iconActions; track trackByActionId($index, action)) {
          <app-button
          appearance="icon"
          class="icon-action"
          [disabled]="action.disabled||false"
          [matTooltip]="action.tooltip || ''"
          [matTooltipDisabled]="!action.tooltip"
          (click)="onActionClick($event, action)">
          
          <mat-icon>{{ action.icon }}</mat-icon>
        </app-button>
        
        }
      </div>
    }
  </div>
}
</div>

