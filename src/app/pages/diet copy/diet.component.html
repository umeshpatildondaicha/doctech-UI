<div class="diet-dashboard">

  <!-- Tabs Section -->
  <mat-tab-group [selectedIndex]="selectedTabIndex" (selectedIndexChange)="onTabChange($event)" class="diet-tabs">
    <!-- Diets Tab -->
    <mat-tab label="Diets">
      <div class="tab-content">
        <!-- Overview -->
        <app-admin-stats-card [stats]="dietsOverviewCards" [showTrends]="false"></app-admin-stats-card>

        <!-- Entity Toolbar: Search + Counts + Actions -->
        <app-entity-toolbar
          title="Diets"
          [showCounts]="true"
          [currentCount]="filteredDiets.length"
          [totalCount]="dietList.length"
          [newLabel]="'New Diet'"
          (newClick)="onCreateDiet()"
          (refreshClick)="loadDietsFromApi()"
          (filterClick)="openDietFilters()"
          (search)="onSearchChange($event)">
        </app-entity-toolbar>

        <!-- Diet Cards Grid -->
        <div class="cards-grid">
          @for (diet of filteredDiets; track diet) {
          <app-diet-card [diet]="diet" [showActions]="true" [clickable]="true" (cardClick)="onViewDiet($event)"
            (viewClick)="onViewDiet($event)" (editClick)="onEditDiet($event)" (deleteClick)="onDeleteDiet($event)"
            (videoClick)="onVideoClick($event)" (pdfClick)="onPdfClick($event)"></app-diet-card>
          }
        </div>

        <!-- No Results -->
        @if (filteredDiets.length === 0) {
        <div class="no-results">
          <div class="no-results-card">
            <div class="no-results-content">
              <mat-icon class="no-results-icon">restaurant</mat-icon>
              <h3>No diets found</h3>
              <p>Try adjusting your search criteria or create a new diet.</p>
              <app-button class="add-btn" [fontIcon]="'add'" title="Add Diet" (btnClick)="onCreateDiet()"></app-button>
              <!-- <button mat-raised-button color="primary" (click)="onCreateDiet()">
                  <mat-icon>add</mat-icon>
                  Add Diet
                </button> -->
            </div>
          </div>
        </div>
        }
      </div>
    </mat-tab>

    <!-- Diet Plans Tab -->
    <mat-tab label="Diet Plans">
      <div class="tab-content">
        <!-- Overview -->
        <app-admin-stats-card [stats]="dietPlansOverviewCards" [showTrends]="false"></app-admin-stats-card>

        <!-- Diet Plans Entity Toolbar: Search + Counts + Actions -->
        <app-entity-toolbar
          title="Diet Plans"
          [showCounts]="true"
          [currentCount]="filteredDietPlans.length"
          [totalCount]="dietPlans.length"
          [newLabel]="'New Plan'"
          (newClick)="onCreateDietPlan()"
          (refreshClick)="loadDietPlans()"
          (filterClick)="openDietPlanFilters()"
          (search)="onPlanSearchChange($event)">
        </app-entity-toolbar>
        <div class="diet-plans-content">
          @if (filteredDietPlans.length > 0) {
          <div class="plans-grid">
            @for (plan of filteredDietPlans; track plan) {
            <app-diet-plan-card [plan]="plan" [showActions]="true" [showFooter]="true" (cardClick)="onViewPlan($event)"
              (viewClick)="onViewPlan($event)" (editClick)="onEditPlan($event)"
              (deleteClick)="onDeletePlan($event)"></app-diet-plan-card>
            }
          </div>
          } @else {
          <div class="no-results">
            <div class="no-results-card">
              <div class="no-results-content">
                <mat-icon class="no-results-icon">calendar_today</mat-icon>
                <h3>No diet plans found</h3>
                <p>Create your first weekly diet plan to get started.</p>
                <!-- <button mat-raised-button color="primary" (click)="onCreateDietPlan()">
                      <mat-icon>add</mat-icon>
                      Create Weekly Plan
                    </button> -->
                <app-button class="add-btn" [fontIcon]="'add'" title="Create Weekly Plan"
                  (btnClick)="onCreateDietPlan()"></app-button>
              </div>
            </div>
          </div>
          }

        </div>
      </div>