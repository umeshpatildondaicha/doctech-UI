<app-page>
  <div class="billing-dashboard" page-body>
    <app-entity-toolbar
      [title]="'Billing'"
      [showCounts]="false"
      [newLabel]="'Create Invoice'"
      [showRefresh]="true"
      [showFilter]="true"
      [searchPlaceholder]="'Search by patient name, patient number...'"
      [searchSuggestions]="billingSearchHints"
      (search)="onBillingSearch($event)"
      (newClick)="openPatientProfile()"
      (refreshClick)="refresh()"
      (filterClick)="onBillingFilterClick()">
    </app-entity-toolbar>

    @if (isDemoData) {
      <div class="demo-pill">
        Demo data (backend not connected)
      </div>
    }

    <!-- Summary Cards -->
    <app-admin-stats-card [stats]="statCards"></app-admin-stats-card>

    <div class="grid-wrapper">
      <app-grid
        class="billing-grid"
        [rowData]="patientRows"
        [columnDefs]="patientColumnDefs"
        [gridOptions]="patientGridOptions"
        [showAddButton]="false"
        [searchPlaceholder]="'Search patients...'"
        [height]="'100%'"
        [width]="'100%'"
        (rowClicked)="onPatientRowClick($event)">
      </app-grid>
    </div>

    @if (!loading && patientRows.length === 0) {
      <app-card class="empty-state" [dense]="true">
        <div class="empty-state-body">
          <app-icon fontIcon="people" [size]="22" class="empty-ico"></app-icon>
          <div class="empty-text">
            <div class="empty-title">No billing records found</div>
            <div class="empty-sub">Create an invoice for a patient to see them here.</div>
          </div>
          <span class="spacer"></span>
          <app-button
            type="button"
            [appearance]="'raised'"
            [text]="'Create Invoice'"
            (btnClick)="openPatientProfile()">
          </app-button>
        </div>
      </app-card>
    }
  </div>
</app-page>
