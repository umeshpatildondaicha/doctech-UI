<app-page>
  <div class="dashboard-page" page-body>
    <!-- Page Title (typography hierarchy: large, bold, primary) -->
    <h1 class="page-title">Overview</h1>

    <!-- KPI Cards -->
    <section class="dashboard-cards" aria-label="Key metrics">
      <button type="button" class="stat-card" (click)="openDetails('billing')">
        <div class="stat-icon stat-icon--primary">
          <app-icon [fontIcon]="'meeting_room'" [size]="20"></app-icon>
        </div>
        <div class="stat-content">
          <span class="stat-label">Room Availability</span>
          <span class="stat-value">{{ stats.roomAvailability }}<span class="stat-value-muted">/{{ stats.totalRooms }}</span></span>
        </div>
      </button>

      <button type="button" class="stat-card" (click)="navigateToAppointments()">
        <div class="stat-icon stat-icon--accent">
          <app-icon [fontIcon]="'event'" [size]="20"></app-icon>
        </div>
        <div class="stat-content">
          <span class="stat-label">Appointments List</span>
          <span class="stat-value">{{ stats.bookAppointment }}</span>
        </div>
      </button>

      <button type="button" class="stat-card" (click)="openDetails('patients')">
        <div class="stat-icon stat-icon--success">
          <app-icon [fontIcon]="'people'" [size]="20"></app-icon>
        </div>
        <div class="stat-content">
          <span class="stat-label">Total Patients</span>
          <span class="stat-value">{{ stats.totalPatients }}</span>
        </div>
      </button>

      <button type="button" class="stat-card" (click)="openDetails('patients')">
        <div class="stat-icon stat-icon--neutral">
          <app-icon [fontIcon]="'trending_up'" [size]="20"></app-icon>
        </div>
        <div class="stat-content">
          <span class="stat-label">Overall Visitors</span>
          <span class="stat-value">{{ stats.overallVisitors | number }} <span class="stat-badge stat-badge--success">+15%</span></span>
        </div>
      </button>
    </section>

    <!-- Main Content -->
    <div class="dashboard-main">
      <div class="main-left">
        <!-- Appointment Requests -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Appointment Requests</h2>
              <span class="card-meta">{{ pendingRequestCount }} Appointment pending</span>
            </div>
          </div>
          <app-divider></app-divider>
          <div class="requests-grid-container">
            <app-grid
              [gridOptions]="requestGridOptions"
              [rowData]="requestRowData"
              [columnDefs]="requestColumns"
              [showHeader]="false"
              class="requests-grid-component">
            </app-grid>
          </div>
        </section>

        <!-- Patient Visits Chart -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Patient Visits</h2>
              <span class="card-meta">This year vs last year</span>
            </div>
          </div>
          <app-divider></app-divider>
          <div class="chart-container">
            @if (isBrowser) {
              <highcharts-chart
                [Highcharts]="Highcharts"
                [options]="patientVisitChartOptions"
                style="width: 100%; display: block;">
              </highcharts-chart>
            } @else {
              <div class="chart-placeholder">Loading chart...</div>
            }
          </div>
        </section>

        <!-- Monthly Revenue Chart -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Monthly Revenue</h2>
              <span class="card-meta">Last 6 months</span>
            </div>
          </div>
          <app-divider></app-divider>
          <div class="chart-container">
            @if (isBrowser) {
              <highcharts-chart
                [Highcharts]="Highcharts"
                [options]="revenueChartOptions"
                style="width: 100%; display: block;">
              </highcharts-chart>
            } @else {
              <div class="chart-placeholder">Loading chart...</div>
            }
          </div>
        </section>
      </div>

      <div class="main-right">
        <!-- Recent Activity -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Recent Activity</h2>
              <span class="card-meta">Latest updates</span>
            </div>
          </div>
          <app-divider></app-divider>
          <ul class="activity-list">
            @for (item of recentActivity; track item.id) {
              <li class="activity-item">
                <span class="activity-icon" [class]="'activity-icon--' + item.type">
                  <app-icon [fontIcon]="item.icon" [size]="16"></app-icon>
                </span>
                <div class="activity-body">
                  <span class="activity-text">{{ item.text }}</span>
                  <span class="activity-time">{{ item.time }}</span>
                </div>
              </li>
            }
          </ul>
        </section>

        <!-- Patient Demographics -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Patient Demographics</h2>
              <span class="card-meta">Age groups</span>
            </div>
          </div>
          <app-divider></app-divider>
          <div class="chart-container">
            @if (isBrowser) {
              <highcharts-chart
                [Highcharts]="Highcharts"
                [options]="patientDemographicsChartOptions"
                style="width: 100%; display: block;">
              </highcharts-chart>
            } @else {
              <div class="chart-placeholder">Loading chart...</div>
            }
          </div>
        </section>

        <!-- Appointment Status -->
        <section class="card card--elevated">
          <div class="card-head">
            <div>
              <h2 class="card-title">Appointment Status</h2>
              <span class="card-meta">Overview</span>
            </div>
          </div>
          <app-divider></app-divider>
          <div class="chart-container">
            @if (isBrowser) {
              <highcharts-chart
                [Highcharts]="Highcharts"
                [options]="appointmentStatusChartOptions"
                style="width: 100%; display: block;">
              </highcharts-chart>
            } @else {
              <div class="chart-placeholder">Loading chart...</div>
            }
          </div>
        </section>
      </div>
    </div>
  </div>
</app-page>
